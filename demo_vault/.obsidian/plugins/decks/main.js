/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var Aa=Object.create;var fr=Object.defineProperty;var Ia=Object.getOwnPropertyDescriptor;var za=Object.getOwnPropertyNames;var Pa=Object.getPrototypeOf,Ba=Object.prototype.hasOwnProperty;var ja=(i,e,n)=>e in i?fr(i,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):i[e]=n;var h=(i,e)=>fr(i,"name",{value:e,configurable:!0});var Ha=(i,e)=>()=>(i&&(e=i(i=0)),e);var Ua=(i,e)=>()=>(e||i((e={exports:{}}).exports,e),e.exports),Ai=(i,e)=>{for(var n in e)fr(i,n,{get:e[n],enumerable:!0})},Ii=(i,e,n,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of za(e))!Ba.call(i,o)&&o!==n&&fr(i,o,{get:()=>e[o],enumerable:!(s=Ia(e,o))||s.enumerable});return i};var Wa=(i,e,n)=>(n=i!=null?Aa(Pa(i)):{},Ii(e||!i||!i.__esModule?fr(n,"default",{value:i,enumerable:!0}):n,i)),$a=i=>Ii(fr({},"__esModule",{value:!0}),i);var En=(i,e,n)=>(ja(i,typeof e!="symbol"?e+"":e,n),n);var zi=Ua((ts,Gn)=>{var Zr=void 0,es=h(function(i){return Zr||(Zr=new Promise(function(e,n){var Vt,ln,yn;var s=typeof i!="undefined"?i:{},o=s.onAbort;s.onAbort=function(t){n(new Error(t)),o&&o(t)},s.postRun=s.postRun||[],s.postRun.push(function(){e(s)}),Gn=void 0;var a;a||(a=typeof s!="undefined"?s:{});var u=typeof window=="object",g=typeof WorkerGlobalScope!="undefined",v=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string"&&process.type!="renderer";a.onRuntimeInitialized=function(){function t(y,q){switch(typeof q){case"boolean":St(y,q?1:0);break;case"number":Sn(y,q);break;case"string":Jr(y,q,-1,-1);break;case"object":if(q===null)We(y);else if(q.length!=null){var ne=jn(q,on);ur(y,ne,q.length,-1),Hn(ne)}else Xn(y,"Wrong API use : tried to return a value of an unknown type ("+q+").",-1);break;default:We(y)}}h(t,"a");function r(y,q){for(var ne=[],le=0;le<y;le+=1){var de=qe(q+4*le,"i32"),Se=Ye(de);if(Se===1||Se===2)de=Qe(de);else if(Se===3)de=Kr(de);else if(Se===4){Se=de,de=Or(Se),Se=xn(Se);for(var et=new Uint8Array(de),Oe=0;Oe<de;Oe+=1)et[Oe]=L[Se+Oe];de=et}else de=null;ne.push(de)}return ne}h(r,"b");function c(y,q){this.Qa=y,this.db=q,this.Oa=1,this.lb=[]}h(c,"c");function f(y,q){if(this.db=q,q=Le(y)+1,this.eb=wn(q),this.eb===null)throw Error("Unable to allocate memory for the SQL string");ze(y,T,this.eb,q),this.kb=this.eb,this.Za=this.pb=null}h(f,"d");function b(y){if(this.filename="dbfile_"+(4294967295*Math.random()>>>0),y!=null){var q=this.filename,ne="/",le=q;if(ne&&(ne=typeof ne=="string"?ne:Jn(ne),le=q?Ft(ne+"/"+q):ne),q=ft(!0,!0),le=Ht(le,q),y){if(typeof y=="string"){ne=Array(y.length);for(var de=0,Se=y.length;de<Se;++de)ne[de]=y.charCodeAt(de);y=ne}sn(le,q|146),ne=Nt(le,577),Ot(ne,y,0,y.length,0),rr(ne),sn(le,q)}}this.handleError(oe(this.filename,k)),this.db=qe(k,"i32"),gt(this.db),this.fb={},this.Sa={}}h(b,"e");var k=At(4),F=a.cwrap,oe=F("sqlite3_open","number",["string","number"]),he=F("sqlite3_close_v2","number",["number"]),ge=F("sqlite3_exec","number",["number","string","number","number","number"]),xe=F("sqlite3_changes","number",["number"]),Pe=F("sqlite3_prepare_v2","number",["number","string","number","number","number"]),Gt=F("sqlite3_sql","string",["number"]),Fr=F("sqlite3_normalized_sql","string",["number"]),Wn=F("sqlite3_prepare_v2","number",["number","number","number","number","number"]),Tr=F("sqlite3_bind_text","number",["number","number","number","number","number"]),It=F("sqlite3_bind_blob","number",["number","number","number","number","number"]),or=F("sqlite3_bind_double","number",["number","number","number"]),Vr=F("sqlite3_bind_int","number",["number","number","number"]),Rr=F("sqlite3_bind_parameter_index","number",["number","string"]),Yt=F("sqlite3_step","number",["number"]),lr=F("sqlite3_errmsg","string",["number"]),Gr=F("sqlite3_column_count","number",["number"]),cr=F("sqlite3_data_count","number",["number"]),Lr=F("sqlite3_column_double","number",["number","number"]),xt=F("sqlite3_column_text","string",["number","number"]),dr=F("sqlite3_column_blob","number",["number","number"]),Yr=F("sqlite3_column_bytes","number",["number","number"]),qr=F("sqlite3_column_type","number",["number","number"]),Qr=F("sqlite3_column_name","string",["number","number"]),Qt=F("sqlite3_reset","number",["number"]),Nr=F("sqlite3_clear_bindings","number",["number"]),$n=F("sqlite3_finalize","number",["number"]),kn=F("sqlite3_create_function_v2","number","number string number number number number number number number".split(" ")),Ye=F("sqlite3_value_type","number",["number"]),Or=F("sqlite3_value_bytes","number",["number"]),Kr=F("sqlite3_value_text","string",["number"]),xn=F("sqlite3_value_blob","number",["number"]),Qe=F("sqlite3_value_double","number",["number"]),Sn=F("sqlite3_result_double","",["number","number"]),We=F("sqlite3_result_null","",["number"]),Jr=F("sqlite3_result_text","",["number","string","number","number"]),ur=F("sqlite3_result_blob","",["number","number","number","number"]),St=F("sqlite3_result_int","",["number","number"]),Xn=F("sqlite3_result_error","",["number","string","number"]),Vn=F("sqlite3_aggregate_context","number",["number","number"]),gt=F("RegisterExtensionFunctions","number",["number"]),Mr=F("sqlite3_update_hook","number",["number","number","number"]);c.prototype.bind=function(y){if(!this.Qa)throw"Statement closed";return this.reset(),Array.isArray(y)?this.Cb(y):y!=null&&typeof y=="object"?this.Db(y):!0},c.prototype.step=function(){if(!this.Qa)throw"Statement closed";this.Oa=1;var y=Yt(this.Qa);switch(y){case 100:return!0;case 101:return!1;default:throw this.db.handleError(y)}},c.prototype.wb=function(y){return y==null&&(y=this.Oa,this.Oa+=1),Lr(this.Qa,y)},c.prototype.Gb=function(y){if(y==null&&(y=this.Oa,this.Oa+=1),y=xt(this.Qa,y),typeof BigInt!="function")throw Error("BigInt is not supported");return BigInt(y)},c.prototype.Hb=function(y){return y==null&&(y=this.Oa,this.Oa+=1),xt(this.Qa,y)},c.prototype.getBlob=function(y){y==null&&(y=this.Oa,this.Oa+=1);var q=Yr(this.Qa,y);y=dr(this.Qa,y);for(var ne=new Uint8Array(q),le=0;le<q;le+=1)ne[le]=L[y+le];return ne},c.prototype.get=function(y,q){q=q||{},y!=null&&this.bind(y)&&this.step(),y=[];for(var ne=cr(this.Qa),le=0;le<ne;le+=1)switch(qr(this.Qa,le)){case 1:var de=q.useBigInt?this.Gb(le):this.wb(le);y.push(de);break;case 2:y.push(this.wb(le));break;case 3:y.push(this.Hb(le));break;case 4:y.push(this.getBlob(le));break;default:y.push(null)}return y},c.prototype.getColumnNames=function(){for(var y=[],q=Gr(this.Qa),ne=0;ne<q;ne+=1)y.push(Qr(this.Qa,ne));return y},c.prototype.getAsObject=function(y,q){y=this.get(y,q),q=this.getColumnNames();for(var ne={},le=0;le<q.length;le+=1)ne[q[le]]=y[le];return ne},c.prototype.getSQL=function(){return Gt(this.Qa)},c.prototype.getNormalizedSQL=function(){return Fr(this.Qa)},c.prototype.run=function(y){return y!=null&&this.bind(y),this.step(),this.reset()},c.prototype.sb=function(y,q){q==null&&(q=this.Oa,this.Oa+=1),y=tn(y);var ne=jn(y,on);this.lb.push(ne),this.db.handleError(Tr(this.Qa,q,ne,y.length-1,0))},c.prototype.Bb=function(y,q){q==null&&(q=this.Oa,this.Oa+=1);var ne=jn(y,on);this.lb.push(ne),this.db.handleError(It(this.Qa,q,ne,y.length,0))},c.prototype.rb=function(y,q){q==null&&(q=this.Oa,this.Oa+=1),this.db.handleError((y===(y|0)?Vr:or)(this.Qa,q,y))},c.prototype.Eb=function(y){y==null&&(y=this.Oa,this.Oa+=1),It(this.Qa,y,0,0,0)},c.prototype.tb=function(y,q){switch(q==null&&(q=this.Oa,this.Oa+=1),typeof y){case"string":this.sb(y,q);return;case"number":this.rb(y,q);return;case"bigint":this.sb(y.toString(),q);return;case"boolean":this.rb(y+0,q);return;case"object":if(y===null){this.Eb(q);return}if(y.length!=null){this.Bb(y,q);return}}throw"Wrong API use : tried to bind a value of an unknown type ("+y+")."},c.prototype.Db=function(y){var q=this;return Object.keys(y).forEach(function(ne){var le=Rr(q.Qa,ne);le!==0&&q.tb(y[ne],le)}),!0},c.prototype.Cb=function(y){for(var q=0;q<y.length;q+=1)this.tb(y[q],q+1);return!0},c.prototype.reset=function(){return this.freemem(),Nr(this.Qa)===0&&Qt(this.Qa)===0},c.prototype.freemem=function(){for(var y;(y=this.lb.pop())!==void 0;)Hn(y)},c.prototype.free=function(){this.freemem();var y=$n(this.Qa)===0;return delete this.db.fb[this.Qa],this.Qa=0,y},f.prototype.next=function(){if(this.eb===null)return{done:!0};if(this.Za!==null&&(this.Za.free(),this.Za=null),!this.db.db)throw this.mb(),Error("Database closed");var y=dt(),q=At(4);Fe(k),Fe(q);try{this.db.handleError(Wn(this.db.db,this.kb,-1,k,q)),this.kb=qe(q,"i32");var ne=qe(k,"i32");return ne===0?(this.mb(),{done:!0}):(this.Za=new c(ne,this.db),this.db.fb[ne]=this.Za,{value:this.Za,done:!1})}catch(le){throw this.pb=pe(this.kb),this.mb(),le}finally{$t(y)}},f.prototype.mb=function(){Hn(this.eb),this.eb=null},f.prototype.getRemainingSQL=function(){return this.pb!==null?this.pb:pe(this.kb)},typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(f.prototype[Symbol.iterator]=function(){return this}),b.prototype.run=function(y,q){if(!this.db)throw"Database closed";if(q){y=this.prepare(y,q);try{y.step()}finally{y.free()}}else this.handleError(ge(this.db,y,0,0,k));return this},b.prototype.exec=function(y,q,ne){if(!this.db)throw"Database closed";var le=dt(),de=null;try{var Se=bn(y),et=At(4);for(y=[];qe(Se,"i8")!==0;){Fe(k),Fe(et),this.handleError(Wn(this.db,Se,-1,k,et));var Oe=qe(k,"i32");if(Se=qe(et,"i32"),Oe!==0){var tt=null;for(de=new c(Oe,this),q!=null&&de.bind(q);de.step();)tt===null&&(tt={columns:de.getColumnNames(),values:[]},y.push(tt)),tt.values.push(de.get(null,ne));de.free()}}return y}catch(it){throw de&&de.free(),it}finally{$t(le)}},b.prototype.each=function(y,q,ne,le,de){typeof q=="function"&&(le=ne,ne=q,q=void 0),y=this.prepare(y,q);try{for(;y.step();)ne(y.getAsObject(null,de))}finally{y.free()}if(typeof le=="function")return le()},b.prototype.prepare=function(y,q){if(Fe(k),this.handleError(Pe(this.db,y,-1,k,0)),y=qe(k,"i32"),y===0)throw"Nothing to prepare";var ne=new c(y,this);return q!=null&&ne.bind(q),this.fb[y]=ne},b.prototype.iterateStatements=function(y){return new f(y,this)},b.prototype.export=function(){Object.values(this.fb).forEach(function(q){q.free()}),Object.values(this.Sa).forEach(vt),this.Sa={},this.handleError(he(this.db));var y=sr(this.filename);return this.handleError(oe(this.filename,k)),this.db=qe(k,"i32"),gt(this.db),y},b.prototype.close=function(){this.db!==null&&(Object.values(this.fb).forEach(function(y){y.free()}),Object.values(this.Sa).forEach(vt),this.Sa={},this.Ya&&(vt(this.Ya),this.Ya=void 0),this.handleError(he(this.db)),In("/"+this.filename),this.db=null)},b.prototype.handleError=function(y){if(y===0)return null;throw y=lr(this.db),Error(y)},b.prototype.getRowsModified=function(){return xe(this.db)},b.prototype.create_function=function(y,q){Object.prototype.hasOwnProperty.call(this.Sa,y)&&(vt(this.Sa[y]),delete this.Sa[y]);var ne=Wt(function(le,de,Se){de=r(de,Se);try{var et=q.apply(null,de)}catch(Oe){Xn(le,Oe,-1);return}t(le,et)},"viii");return this.Sa[y]=ne,this.handleError(kn(this.db,y,q.length,1,0,ne,0,0,0)),this},b.prototype.create_aggregate=function(y,q){var ne=q.init||function(){return null},le=q.finalize||function(tt){return tt},de=q.step;if(!de)throw"An aggregate function must have a step function in "+y;var Se={};Object.hasOwnProperty.call(this.Sa,y)&&(vt(this.Sa[y]),delete this.Sa[y]),q=y+"__finalize",Object.hasOwnProperty.call(this.Sa,q)&&(vt(this.Sa[q]),delete this.Sa[q]);var et=Wt(function(tt,it,zt){var $e=Vn(tt,1);Object.hasOwnProperty.call(Se,$e)||(Se[$e]=ne()),it=r(it,zt),it=[Se[$e]].concat(it);try{Se[$e]=de.apply(null,it)}catch(gs){delete Se[$e],Xn(tt,gs,-1)}},"viii"),Oe=Wt(function(tt){var it=Vn(tt,1);try{var zt=le(Se[it])}catch($e){delete Se[it],Xn(tt,$e,-1);return}t(tt,zt),delete Se[it]},"vi");return this.Sa[y]=et,this.Sa[q]=Oe,this.handleError(kn(this.db,y,de.length-1,1,0,0,et,Oe,0)),this},b.prototype.updateHook=function(y){this.Ya&&(Mr(this.db,0,0),vt(this.Ya),this.Ya=void 0),y&&(this.Ya=Wt(function(q,ne,le,de,Se){switch(ne){case 18:q="insert";break;case 23:q="update";break;case 9:q="delete";break;default:throw"unknown operationCode in updateHook callback: "+ne}if(le=le?ye(T,le):"",de=de?ye(T,de):"",Se>Number.MAX_SAFE_INTEGER)throw"rowId too big to fit inside a Number";y(q,le,de,Number(Se))},"viiiij"),Mr(this.db,this.Ya,0))},a.Database=b};var m={...a},x="./this.program",S=h((t,r)=>{throw r},"Da"),E="",C,_;if(v){var O=require("fs");require("path"),E=__dirname+"/",_=h(t=>(t=ie(t)?new URL(t):t,O.readFileSync(t)),"Fa"),C=h(async t=>(t=ie(t)?new URL(t):t,O.readFileSync(t,void 0)),"Ea"),!a.thisProgram&&1<process.argv.length&&(x=process.argv[1].replace(/\\/g,"/")),process.argv.slice(2),typeof Gn!="undefined"&&(Gn.exports=a),S=h((t,r)=>{throw process.exitCode=t,r},"Da")}else(u||g)&&(g?E=self.location.href:typeof document!="undefined"&&document.currentScript&&(E=document.currentScript.src),E=E.startsWith("blob:")?"":E.slice(0,E.replace(/[?#].*/,"").lastIndexOf("/")+1),g&&(_=h(t=>{var r=new XMLHttpRequest;return r.open("GET",t,!1),r.responseType="arraybuffer",r.send(null),new Uint8Array(r.response)},"Fa")),C=h(async t=>{if(ie(t))return new Promise((c,f)=>{var b=new XMLHttpRequest;b.open("GET",t,!0),b.responseType="arraybuffer",b.onload=()=>{b.status==200||b.status==0&&b.response?c(b.response):f(b.status)},b.onerror=f,b.send(null)});var r=await fetch(t,{credentials:"same-origin"});if(r.ok)return r.arrayBuffer();throw Error(r.status+" : "+r.url)},"Ea"));var D=a.print||console.log.bind(console),M=a.printErr||console.error.bind(console);Object.assign(a,m),m=null,a.thisProgram&&(x=a.thisProgram);var N=a.wasmBinary,I,z=!1,W,L,T,P,A,H,J,ee,Z,ie=h(t=>t.startsWith("file://"),"Ga");function V(){var t=I.buffer;a.HEAP8=L=new Int8Array(t),a.HEAP16=P=new Int16Array(t),a.HEAPU8=T=new Uint8Array(t),a.HEAPU16=new Uint16Array(t),a.HEAP32=A=new Int32Array(t),a.HEAPU32=H=new Uint32Array(t),a.HEAPF32=J=new Float32Array(t),a.HEAPF64=Z=new Float64Array(t),a.HEAP64=ee=new BigInt64Array(t),a.HEAPU64=new BigUint64Array(t)}h(V,"Qa");var G=0,Q=null;function B(t){var r;throw(r=a.onAbort)==null||r.call(a,t),t="Aborted("+t+")",M(t),z=!0,new WebAssembly.RuntimeError(t+". Build with -sASSERTIONS for more info.")}h(B,"Ta");var te;async function ce(t){if(!N)try{var r=await C(t);return new Uint8Array(r)}catch(c){}if(t==te&&N)t=new Uint8Array(N);else if(_)t=_(t);else throw"both async and sync fetching of the wasm failed";return t}h(ce,"Va");async function Me(t,r){try{var c=await ce(t);return await WebAssembly.instantiate(c,r)}catch(f){M(`failed to asynchronously prepare wasm: ${f}`),B(f)}}h(Me,"Wa");async function ve(t){var r=te;if(!N&&typeof WebAssembly.instantiateStreaming=="function"&&!ie(r)&&!v)try{var c=fetch(r,{credentials:"same-origin"});return await WebAssembly.instantiateStreaming(c,t)}catch(f){M(`wasm streaming compile failed: ${f}`),M("falling back to ArrayBuffer instantiation")}return Me(r,t)}h(ve,"Xa");let _n=class _n{constructor(r){En(this,"name","ExitStatus");this.message=`Program terminated with exit(${r})`,this.status=r}};h(_n,"Ya");let Y=_n;var be=h(t=>{for(;0<t.length;)t.shift()(a)},"Za"),K=[],fe=[],at=h(()=>{var t=a.preRun.shift();fe.unshift(t)},"bb");function qe(t,r="i8"){switch(r.endsWith("*")&&(r="*"),r){case"i1":return L[t];case"i8":return L[t];case"i16":return P[t>>1];case"i32":return A[t>>2];case"i64":return ee[t>>3];case"float":return J[t>>2];case"double":return Z[t>>3];case"*":return H[t>>2];default:B(`invalid type for getValue: ${r}`)}}h(qe,"m");var Ne=a.noExitRuntime||!0;function Fe(t){var r="i32";switch(r.endsWith("*")&&(r="*"),r){case"i1":L[t]=0;break;case"i8":L[t]=0;break;case"i16":P[t>>1]=0;break;case"i32":A[t>>2]=0;break;case"i64":ee[t>>3]=BigInt(0);break;case"float":J[t>>2]=0;break;case"double":Z[t>>3]=0;break;case"*":H[t>>2]=0;break;default:B(`invalid type for setValue: ${r}`)}}h(Fe,"ta");var ot=typeof TextDecoder!="undefined"?new TextDecoder:void 0,ye=h((t,r=0,c=NaN)=>{var f=r+c;for(c=r;t[c]&&!(c>=f);)++c;if(16<c-r&&t.buffer&&ot)return ot.decode(t.subarray(r,c));for(f="";r<c;){var b=t[r++];if(b&128){var k=t[r++]&63;if((b&224)==192)f+=String.fromCharCode((b&31)<<6|k);else{var F=t[r++]&63;b=(b&240)==224?(b&15)<<12|k<<6|F:(b&7)<<18|k<<12|F<<6|t[r++]&63,65536>b?f+=String.fromCharCode(b):(b-=65536,f+=String.fromCharCode(55296|b>>10,56320|b&1023))}}else f+=String.fromCharCode(b)}return f},"B"),pe=h((t,r)=>t?ye(T,t,r):"","ua"),De=h((t,r)=>{for(var c=0,f=t.length-1;0<=f;f--){var b=t[f];b==="."?t.splice(f,1):b===".."?(t.splice(f,1),c++):c&&(t.splice(f,1),c--)}if(r)for(;c;c--)t.unshift("..");return t},"eb"),Ft=h(t=>{var r=t.charAt(0)==="/",c=t.slice(-1)==="/";return(t=De(t.split("/").filter(f=>!!f),!r).join("/"))||r||(t="."),t&&c&&(t+="/"),(r?"/":"")+t},"ka"),Tt=h(t=>{var r=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/.exec(t).slice(1);return t=r[0],r=r[1],!t&&!r?".":(r&&(r=r.slice(0,-1)),t+r)},"fb"),Rt=h(t=>t&&t.match(/([^\/]+|\/)\/*$/)[1],"gb"),ut=h(()=>{if(v){var t=require("crypto");return r=>t.randomFillSync(r)}return r=>crypto.getRandomValues(r)},"hb"),mt=h(t=>{(mt=ut())(t)},"ib"),Ln=h((...t)=>{for(var r="",c=!1,f=t.length-1;-1<=f&&!c;f--){if(c=0<=f?t[f]:"/",typeof c!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!c)return"";r=c+"/"+r,c=c.charAt(0)==="/"}return r=De(r.split("/").filter(b=>!!b),!c).join("/"),(c?"/":"")+r||"."},"jb"),nt=[],Le=h(t=>{for(var r=0,c=0;c<t.length;++c){var f=t.charCodeAt(c);127>=f?r++:2047>=f?r+=2:55296<=f&&57343>=f?(r+=4,++c):r+=3}return r},"ha"),ze=h((t,r,c,f)=>{if(!(0<f))return 0;var b=c;f=c+f-1;for(var k=0;k<t.length;++k){var F=t.charCodeAt(k);if(55296<=F&&57343>=F){var oe=t.charCodeAt(++k);F=65536+((F&1023)<<10)|oe&1023}if(127>=F){if(c>=f)break;r[c++]=F}else{if(2047>=F){if(c+1>=f)break;r[c++]=192|F>>6}else{if(65535>=F){if(c+2>=f)break;r[c++]=224|F>>12}else{if(c+3>=f)break;r[c++]=240|F>>18,r[c++]=128|F>>12&63}r[c++]=128|F>>6&63}r[c++]=128|F&63}}return r[c]=0,c-b},"u"),tn=h((t,r)=>{var c=Array(Le(t)+1);return t=ze(t,c,0,c.length),r&&(c.length=t),c},"ra"),bt=[];function wt(t,r){bt[t]={input:[],output:[],cb:r},nr(t,dn)}h(wt,"nb");var dn={open(t){var r=bt[t.node.rdev];if(!r)throw new j(43);t.tty=r,t.seekable=!1},close(t){t.tty.cb.fsync(t.tty)},fsync(t){t.tty.cb.fsync(t.tty)},read(t,r,c,f){if(!t.tty||!t.tty.cb.xb)throw new j(60);for(var b=0,k=0;k<f;k++){try{var F=t.tty.cb.xb(t.tty)}catch(oe){throw new j(29)}if(F===void 0&&b===0)throw new j(6);if(F==null)break;b++,r[c+k]=F}return b&&(t.node.atime=Date.now()),b},write(t,r,c,f){if(!t.tty||!t.tty.cb.qb)throw new j(60);try{for(var b=0;b<f;b++)t.tty.cb.qb(t.tty,r[c+b])}catch(k){throw new j(29)}return f&&(t.node.mtime=t.node.ctime=Date.now()),b}},rt={xb(){e:{if(!nt.length){var t=null;if(v){var r=Buffer.alloc(256),c=0,f=process.stdin.fd;try{c=O.readSync(f,r,0,256)}catch(b){if(b.toString().includes("EOF"))c=0;else throw b}0<c&&(t=r.slice(0,c).toString("utf-8"))}else typeof window!="undefined"&&typeof window.prompt=="function"&&(t=window.prompt("Input: "),t!==null&&(t+=`
`));if(!t){t=null;break e}nt=tn(t,!0)}t=nt.shift()}return t},qb(t,r){r===null||r===10?(D(ye(t.output)),t.output=[]):r!=0&&t.output.push(r)},fsync(t){var r;0<((r=t.output)==null?void 0:r.length)&&(D(ye(t.output)),t.output=[])},Tb(){return{Ob:25856,Qb:5,Nb:191,Pb:35387,Mb:[3,28,127,21,4,0,1,0,17,19,26,0,18,15,23,22,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}},Ub(){return 0},Vb(){return[24,80]}},Ze={qb(t,r){r===null||r===10?(M(ye(t.output)),t.output=[]):r!=0&&t.output.push(r)},fsync(t){var r;0<((r=t.output)==null?void 0:r.length)&&(M(ye(t.output)),t.output=[])}},ue={Wa:null,Xa(){return ue.createNode(null,"/",16895,0)},createNode(t,r,c,f){if((c&61440)===24576||(c&61440)===4096)throw new j(63);return ue.Wa||(ue.Wa={dir:{node:{Ta:ue.La.Ta,Ua:ue.La.Ua,lookup:ue.La.lookup,hb:ue.La.hb,rename:ue.La.rename,unlink:ue.La.unlink,rmdir:ue.La.rmdir,readdir:ue.La.readdir,symlink:ue.La.symlink},stream:{Va:ue.Ma.Va}},file:{node:{Ta:ue.La.Ta,Ua:ue.La.Ua},stream:{Va:ue.Ma.Va,read:ue.Ma.read,write:ue.Ma.write,ib:ue.Ma.ib,jb:ue.Ma.jb}},link:{node:{Ta:ue.La.Ta,Ua:ue.La.Ua,readlink:ue.La.readlink},stream:{}},ub:{node:{Ta:ue.La.Ta,Ua:ue.La.Ua},stream:tr}}),c=qn(t,r,c,f),je(c.mode)?(c.La=ue.Wa.dir.node,c.Ma=ue.Wa.dir.stream,c.Na={}):(c.mode&61440)===32768?(c.La=ue.Wa.file.node,c.Ma=ue.Wa.file.stream,c.Ra=0,c.Na=null):(c.mode&61440)===40960?(c.La=ue.Wa.link.node,c.Ma=ue.Wa.link.stream):(c.mode&61440)===8192&&(c.La=ue.Wa.ub.node,c.Ma=ue.Wa.ub.stream),c.atime=c.mtime=c.ctime=Date.now(),t&&(t.Na[r]=c,t.atime=t.mtime=t.ctime=c.atime),c},Sb(t){return t.Na?t.Na.subarray?t.Na.subarray(0,t.Ra):new Uint8Array(t.Na):new Uint8Array(0)},La:{Ta(t){var r={};return r.dev=(t.mode&61440)===8192?t.id:1,r.ino=t.id,r.mode=t.mode,r.nlink=1,r.uid=0,r.gid=0,r.rdev=t.rdev,je(t.mode)?r.size=4096:(t.mode&61440)===32768?r.size=t.Ra:(t.mode&61440)===40960?r.size=t.link.length:r.size=0,r.atime=new Date(t.atime),r.mtime=new Date(t.mtime),r.ctime=new Date(t.ctime),r.blksize=4096,r.blocks=Math.ceil(r.size/r.blksize),r},Ua(t,r){for(var c of["mode","atime","mtime","ctime"])r[c]!=null&&(t[c]=r[c]);r.size!==void 0&&(r=r.size,t.Ra!=r&&(r==0?(t.Na=null,t.Ra=0):(c=t.Na,t.Na=new Uint8Array(r),c&&t.Na.set(c.subarray(0,Math.min(r,t.Ra))),t.Ra=r)))},lookup(){throw ue.vb},hb(t,r,c,f){return ue.createNode(t,r,c,f)},rename(t,r,c){try{var f=ht(r,c)}catch(k){}if(f){if(je(t.mode))for(var b in f.Na)throw new j(55);_t(f)}delete t.parent.Na[t.name],r.Na[c]=t,t.name=c,r.ctime=r.mtime=t.parent.ctime=t.parent.mtime=Date.now()},unlink(t,r){delete t.Na[r],t.ctime=t.mtime=Date.now()},rmdir(t,r){var c=ht(t,r),f;for(f in c.Na)throw new j(55);delete t.Na[r],t.ctime=t.mtime=Date.now()},readdir(t){return[".","..",...Object.keys(t.Na)]},symlink(t,r,c){return t=ue.createNode(t,r,41471,0),t.link=c,t},readlink(t){if((t.mode&61440)!==40960)throw new j(28);return t.link}},Ma:{read(t,r,c,f,b){var k=t.node.Na;if(b>=t.node.Ra)return 0;if(t=Math.min(t.node.Ra-b,f),8<t&&k.subarray)r.set(k.subarray(b,b+t),c);else for(f=0;f<t;f++)r[c+f]=k[b+f];return t},write(t,r,c,f,b,k){if(r.buffer===L.buffer&&(k=!1),!f)return 0;if(t=t.node,t.mtime=t.ctime=Date.now(),r.subarray&&(!t.Na||t.Na.subarray)){if(k)return t.Na=r.subarray(c,c+f),t.Ra=f;if(t.Ra===0&&b===0)return t.Na=r.slice(c,c+f),t.Ra=f;if(b+f<=t.Ra)return t.Na.set(r.subarray(c,c+f),b),f}k=b+f;var F=t.Na?t.Na.length:0;if(F>=k||(k=Math.max(k,F*(1048576>F?2:1.125)>>>0),F!=0&&(k=Math.max(k,256)),F=t.Na,t.Na=new Uint8Array(k),0<t.Ra&&t.Na.set(F.subarray(0,t.Ra),0)),t.Na.subarray&&r.subarray)t.Na.set(r.subarray(c,c+f),b);else for(k=0;k<f;k++)t.Na[b+k]=r[c+k];return t.Ra=Math.max(t.Ra,b+f),f},Va(t,r,c){if(c===1?r+=t.position:c===2&&(t.node.mode&61440)===32768&&(r+=t.node.Ra),0>r)throw new j(28);return r},ib(t,r,c,f,b){if((t.node.mode&61440)!==32768)throw new j(43);if(t=t.node.Na,b&2||!t||t.buffer!==L.buffer){b=!0,f=65536*Math.ceil(r/65536);var k=Un(65536,f);if(k&&T.fill(0,k,k+f),f=k,!f)throw new j(48);t&&((0<c||c+r<t.length)&&(t.subarray?t=t.subarray(c,c+r):t=Array.prototype.slice.call(t,c,c+r)),L.set(t,f))}else b=!1,f=t.byteOffset;return{Kb:f,Ab:b}},jb(t,r,c,f){return ue.Ma.write(t,r,0,f,c,!1),0}}},ft=h((t,r)=>{var c=0;return t&&(c|=365),r&&(c|=146),c},"la"),Te=null,lt={},Ve=[],Bt=1,Ge=null,un=!1,ct=!0,jt={},j=(Vt=class{constructor(r){En(this,"name","ErrnoError");this.Pa=r}},h(Vt,"N"),Vt),fn=(ln=class{constructor(){En(this,"gb",{});En(this,"node",null)}get flags(){return this.gb.flags}set flags(r){this.gb.flags=r}get position(){return this.gb.position}set position(r){this.gb.position=r}},h(ln,"Lb"),ln),we=(yn=class{constructor(r,c,f,b){En(this,"La",{});En(this,"Ma",{});En(this,"ab",null);r||(r=this),this.parent=r,this.Xa=r.Xa,this.id=Bt++,this.name=c,this.mode=f,this.rdev=b,this.atime=this.mtime=this.ctime=Date.now()}get read(){return(this.mode&365)===365}set read(r){r?this.mode|=365:this.mode&=-366}get write(){return(this.mode&146)===146}set write(r){r?this.mode|=146:this.mode&=-147}},h(yn,"Mb"),yn);function _e(t,r={}){var oe;if(!t)throw new j(44);(oe=r.nb)!=null||(r.nb=!0),t.charAt(0)==="/"||(t="//"+t);var c=0;e:for(;40>c;c++){t=t.split("/").filter(he=>!!he);for(var f=Te,b="/",k=0;k<t.length;k++){var F=k===t.length-1;if(F&&r.parent)break;if(t[k]!==".")if(t[k]==="..")b=Tt(b),f=f.parent;else{b=Ft(b+"/"+t[k]);try{f=ht(f,t[k])}catch(he){if((he==null?void 0:he.Pa)===44&&F&&r.Jb)return{path:b};throw he}if(!f.ab||F&&!r.nb||(f=f.ab.root),(f.mode&61440)===40960&&(!F||r.$a)){if(!f.La.readlink)throw new j(52);f=f.La.readlink(f),f.charAt(0)==="/"||(f=Tt(b)+"/"+f),t=f+"/"+t.slice(k+1).join("/");continue e}}}return{path:b,node:f}}throw new j(32)}h(_e,"S");function Jn(t){for(var r;;){if(t===t.parent)return t=t.Xa.zb,r?t[t.length-1]!=="/"?`${t}/${r}`:t+r:t;r=r?`${t.name}/${r}`:t.name,t=t.parent}}h(Jn,"ja");function Ae(t,r){for(var c=0,f=0;f<r.length;f++)c=(c<<5)-c+r.charCodeAt(f)|0;return(t+c>>>0)%Ge.length}h(Ae,"Nb");function _t(t){var r=Ae(t.parent.id,t.name);if(Ge[r]===t)Ge[r]=t.bb;else for(r=Ge[r];r;){if(r.bb===t){r.bb=t.bb;break}r=r.bb}}h(_t,"Cb");function ht(t,r){var c=je(t.mode)?(c=nn(t,"x"))?c:t.La.lookup?0:2:54;if(c)throw new j(c);for(c=Ge[Ae(t.id,r)];c;c=c.bb){var f=c.name;if(c.parent.id===t.id&&f===r)return c}return t.La.lookup(t,r)}h(ht,"Q");function qn(t,r,c,f){return t=new we(t,r,c,f),r=Ae(t.parent.id,t.name),t.bb=Ge[r],Ge[r]=t}h(qn,"Bb");function je(t){return(t&61440)===16384}h(je,"P");function wr(t){var r=["r","w","rw"][t&3];return t&512&&(r+="w"),r}h(wr,"Pb");function nn(t,r){if(ct)return 0;if(!r.includes("r")||t.mode&292){if(r.includes("w")&&!(t.mode&146)||r.includes("x")&&!(t.mode&73))return 2}else return 2;return 0}h(nn,"Ob");function Nn(t,r){if(!je(t.mode))return 54;try{return ht(t,r),20}catch(c){}return nn(t,"wx")}h(Nn,"Qb");function _r(t,r,c){try{var f=ht(t,r)}catch(b){return b.Pa}if(t=nn(t,"wx"))return t;if(c){if(!je(f.mode))return 54;if(f===f.parent||Jn(f)==="/")return 10}else if(je(f.mode))return 31;return 0}h(_r,"Rb");function rn(t){if(!t)throw new j(63);return t}h(rn,"Sb");function He(t){if(t=Ve[t],!t)throw new j(8);return t}h(He,"T");function Lt(t,r=-1){if(t=Object.assign(new fn,t),r==-1)e:{for(r=0;4096>=r;r++)if(!Ve[r])break e;throw new j(33)}return t.fd=r,Ve[r]=t}h(Lt,"Tb");function Zn(t,r=-1){var c,f;return t=Lt(t,r),(f=(c=t.Ma)==null?void 0:c.Rb)==null||f.call(c,t),t}h(Zn,"Ub");function er(t,r,c){var f=t==null?void 0:t.Ma.Ua;t=f?t:r,f!=null||(f=r.La.Ua),rn(f),f(t,c)}h(er,"Vb");var tr={open(t){var r,c;t.Ma=lt[t.node.rdev].Ma,(c=(r=t.Ma).open)==null||c.call(r,t)},Va(){throw new j(70)}};function nr(t,r){lt[t]={Ma:r}}h(nr,"wb");function On(t,r){var c=r==="/";if(c&&Te)throw new j(10);if(!c&&r){var f=_e(r,{nb:!1});if(r=f.path,f=f.node,f.ab)throw new j(10);if(!je(f.mode))throw new j(54)}r={type:t,Wb:{},zb:r,Ib:[]},t=t.Xa(r),t.Xa=r,r.root=t,c?Te=t:f&&(f.ab=r,f.Xa&&f.Xa.Ib.push(r))}h(On,"Wb");function Mn(t,r,c){var f=_e(t,{parent:!0}).node;if(t=Rt(t),!t)throw new j(28);if(t==="."||t==="..")throw new j(20);var b=Nn(f,t);if(b)throw new j(b);if(!f.La.hb)throw new j(63);return f.La.hb(f,t,r,c)}h(Mn,"Xb");function Ht(t,r=438){return Mn(t,r&4095|32768,0)}h(Ht,"ma");function st(t,r=511){return Mn(t,r&1023|16384,0)}h(st,"U");function An(t,r,c){typeof c=="undefined"&&(c=r,r=438),Mn(t,r|8192,c)}h(An,"Yb");function hn(t,r){if(!Ln(t))throw new j(44);var c=_e(r,{parent:!0}).node;if(!c)throw new j(44);r=Rt(r);var f=Nn(c,r);if(f)throw new j(f);if(!c.La.symlink)throw new j(63);c.La.symlink(c,r,t)}h(hn,"Zb");function yr(t){var r=_e(t,{parent:!0}).node;t=Rt(t);var c=ht(r,t),f=_r(r,t,!0);if(f)throw new j(f);if(!r.La.rmdir)throw new j(63);if(c.ab)throw new j(10);r.La.rmdir(r,t),_t(c)}h(yr,"$b");function In(t){var r=_e(t,{parent:!0}).node;if(!r)throw new j(44);t=Rt(t);var c=ht(r,t),f=_r(r,t,!1);if(f)throw new j(f);if(!r.La.unlink)throw new j(63);if(c.ab)throw new j(10);r.La.unlink(r,t),_t(c)}h(In,"za");function pn(t,r){return t=_e(t,{$a:!r}).node,rn(t.La.Ta)(t)}h(pn,"ac");function qt(t,r,c,f){er(t,r,{mode:c&4095|r.mode&-4096,ctime:Date.now(),Fb:f})}h(qt,"bc");function sn(t,r){t=typeof t=="string"?_e(t,{$a:!0}).node:t,qt(null,t,r)}h(sn,"na");function kr(t,r,c){if(je(r.mode))throw new j(31);if((r.mode&61440)!==32768)throw new j(28);var f=nn(r,"w");if(f)throw new j(f);er(t,r,{size:c,timestamp:Date.now()})}h(kr,"cc");function Nt(t,r,c=438){if(t==="")throw new j(44);if(typeof r=="string"){var f={r:0,"r+":2,w:577,"w+":578,a:1089,"a+":1090}[r];if(typeof f=="undefined")throw Error(`Unknown file open mode: ${r}`);r=f}if(c=r&64?c&4095|32768:0,typeof t=="object")f=t;else{var b=t.endsWith("/");t=_e(t,{$a:!(r&131072),Jb:!0}),f=t.node,t=t.path}var k=!1;if(r&64)if(f){if(r&128)throw new j(20)}else{if(b)throw new j(31);f=Mn(t,c|511,0),k=!0}if(!f)throw new j(44);if((f.mode&61440)===8192&&(r&=-513),r&65536&&!je(f.mode))throw new j(54);if(!k&&(b=f?(f.mode&61440)===40960?32:je(f.mode)&&(wr(r)!=="r"||r&576)?31:nn(f,wr(r)):44))throw new j(b);return r&512&&!k&&(b=f,b=typeof b=="string"?_e(b,{$a:!0}).node:b,kr(null,b,0)),r&=-131713,b=Lt({node:f,path:Jn(f),flags:r,seekable:!0,position:0,Ma:f.Ma,Lb:[],error:!1}),b.Ma.open&&b.Ma.open(b),k&&sn(f,c&511),!a.logReadFiles||r&1||t in jt||(jt[t]=1),b}h(Nt,"oa");function rr(t){if(t.fd===null)throw new j(8);t.ob&&(t.ob=null);try{t.Ma.close&&t.Ma.close(t)}catch(r){throw r}finally{Ve[t.fd]=null}t.fd=null}h(rr,"qa");function zn(t,r,c){if(t.fd===null)throw new j(8);if(!t.seekable||!t.Ma.Va)throw new j(70);if(c!=0&&c!=1&&c!=2)throw new j(28);t.position=t.Ma.Va(t,r,c),t.Lb=[]}h(zn,"mc");function xr(t,r,c,f,b){if(0>f||0>b)throw new j(28);if(t.fd===null)throw new j(8);if((t.flags&2097155)===1)throw new j(8);if(je(t.node.mode))throw new j(31);if(!t.Ma.read)throw new j(28);var k=typeof b!="undefined";if(!k)b=t.position;else if(!t.seekable)throw new j(70);return r=t.Ma.read(t,r,c,f,b),k||(t.position+=r),r}h(xr,"Ec");function Ot(t,r,c,f,b){if(0>f||0>b)throw new j(28);if(t.fd===null)throw new j(8);if(!(t.flags&2097155))throw new j(8);if(je(t.node.mode))throw new j(31);if(!t.Ma.write)throw new j(28);t.seekable&&t.flags&1024&&zn(t,0,2);var k=typeof b!="undefined";if(!k)b=t.position;else if(!t.seekable)throw new j(70);return r=t.Ma.write(t,r,c,f,b,void 0),k||(t.position+=r),r}h(Ot,"pa");function sr(t){var r="binary";if(r!=="utf8"&&r!=="binary")throw Error(`Invalid encoding type "${r}"`);var c,f=Nt(t,f||0);t=pn(t).size;var b=new Uint8Array(t);return xr(f,b,0,t,0),r==="utf8"?c=ye(b):r==="binary"&&(c=b),rr(f),c}h(sr,"ya");function Mt(t,r,c){var k;t=Ft("/dev/"+t);var f=ft(!!r,!!c);(k=Mt.yb)!=null||(Mt.yb=64);var b=Mt.yb++<<8|0;nr(b,{open(F){F.seekable=!1},close(){var F;(F=c==null?void 0:c.buffer)!=null&&F.length&&c(10)},read(F,oe,he,ge){for(var xe=0,Pe=0;Pe<ge;Pe++){try{var Gt=r()}catch(Fr){throw new j(29)}if(Gt===void 0&&xe===0)throw new j(6);if(Gt==null)break;xe++,oe[he+Pe]=Gt}return xe&&(F.node.atime=Date.now()),xe},write(F,oe,he,ge){for(var xe=0;xe<ge;xe++)try{c(oe[he+xe])}catch(Pe){throw new j(29)}return ge&&(F.node.mtime=F.node.ctime=Date.now()),xe}}),An(t,f,b)}h(Mt,"V");var Ce={};function Ut(t,r,c){if(r.charAt(0)==="/")return r;if(t=t===-100?"/":He(t).path,r.length==0){if(!c)throw new j(44);return t}return t+"/"+r}h(Ut,"Gc");function an(t,r){A[t>>2]=r.dev,A[t+4>>2]=r.mode,H[t+8>>2]=r.nlink,A[t+12>>2]=r.uid,A[t+16>>2]=r.gid,A[t+20>>2]=r.rdev,ee[t+24>>3]=BigInt(r.size),A[t+32>>2]=4096,A[t+36>>2]=r.blocks;var c=r.atime.getTime(),f=r.mtime.getTime(),b=r.ctime.getTime();return ee[t+40>>3]=BigInt(Math.floor(c/1e3)),H[t+48>>2]=c%1e3*1e6,ee[t+56>>3]=BigInt(Math.floor(f/1e3)),H[t+64>>2]=f%1e3*1e6,ee[t+72>>3]=BigInt(Math.floor(b/1e3)),H[t+80>>2]=b%1e3*1e6,ee[t+88>>3]=BigInt(r.ino),0}h(an,"Hc");var Pn=void 0,pt=h(()=>{var t=A[+Pn>>2];return Pn+=4,t},"Jc"),vn=0,ir=[0,31,60,91,121,152,182,213,244,274,305,335],Sr=[0,31,59,90,120,151,181,212,243,273,304,334],gn={},Bn=h(t=>{var r;W=t,Ne||0<vn||((r=a.onExit)==null||r.call(a,t),z=!0),S(t,new Y(t))},"Oc"),$r=h(t=>{if(!z)try{if(t(),!(Ne||0<vn))try{W=t=W,Bn(t)}catch(r){r instanceof Y||r=="unwind"||S(1,r)}}catch(r){r instanceof Y||r=="unwind"||S(1,r)}},"Pc"),mn={},Er=h(()=>{if(!yt){var t={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:x||"./this.program"},r;for(r in mn)mn[r]===void 0?delete t[r]:t[r]=mn[r];var c=[];for(r in t)c.push(`${r}=${t[r]}`);yt=c}return yt},"Sc"),yt,bn=h(t=>{var r=Le(t)+1,c=At(r);return ze(t,T,c,r),c},"xa"),Xr=h((t,r,c,f)=>{var b={string:ge=>{var xe=0;return ge!=null&&ge!==0&&(xe=bn(ge)),xe},array:ge=>{var xe=At(ge.length);return L.set(ge,xe),xe}};t=a["_"+t];var k=[],F=0;if(f)for(var oe=0;oe<f.length;oe++){var he=b[c[oe]];he?(F===0&&(F=dt()),k[oe]=he(f[oe])):k[oe]=f[oe]}return c=t(...k),c=function(ge){return F!==0&&$t(F),r==="string"?ge?ye(T,ge):"":r==="boolean"?!!ge:ge}(c)},"Tc"),on=0,jn=h((t,r)=>(r=r==1?At(t.length):wn(t.length),t.subarray||t.slice||(t=new Uint8Array(t)),T.set(t,r),r),"da"),kt,ar=[],Ue,vt=h(t=>{kt.delete(Ue.get(t)),Ue.set(t,null),ar.push(t)},"A"),Wt=h((t,r)=>{if(!kt){kt=new WeakMap;var c=Ue.length;if(kt)for(var f=0;f<0+c;f++){var b=Ue.get(f);b&&kt.set(b,f)}}if(c=kt.get(t)||0)return c;if(ar.length)c=ar.pop();else{try{Ue.grow(1)}catch(he){throw he instanceof RangeError?"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH.":he}c=Ue.length-1}try{Ue.set(c,t)}catch(he){if(!(he instanceof TypeError))throw he;if(typeof WebAssembly.Function=="function"){var k=WebAssembly.Function;f={i:"i32",j:"i64",f:"f32",d:"f64",e:"externref",p:"i32"},b={parameters:[],results:r[0]=="v"?[]:[f[r[0]]]};for(var F=1;F<r.length;++F)b.parameters.push(f[r[F]]);r=new k(b,t)}else{f=[1],b=r.slice(0,1),r=r.slice(1),F={i:127,p:127,j:126,f:125,d:124,e:111},f.push(96);var oe=r.length;128>oe?f.push(oe):f.push(oe%128|128,oe>>7);for(k of r)f.push(F[k]);b=="v"?f.push(0):f.push(1,F[b]),r=[0,97,115,109,1,0,0,0,1],k=f.length,128>k?r.push(k):r.push(k%128|128,k>>7),r.push(...f),r.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0),r=new WebAssembly.Module(new Uint8Array(r)),r=new WebAssembly.Instance(r,{e:{f:t}}).exports.f}Ue.set(c,r)}return kt.set(t,c),c},"Aa");Ge=Array(4096),On(ue,"/"),st("/tmp"),st("/home"),st("/home/web_user"),function(){st("/dev"),nr(259,{read:()=>0,write:(f,b,k,F)=>F,Va:()=>0}),An("/dev/null",259),wt(1280,rt),wt(1536,Ze),An("/dev/tty",1280),An("/dev/tty1",1536);var t=new Uint8Array(1024),r=0,c=h(()=>(r===0&&(mt(t),r=t.byteLength),t[--r]),"c");Mt("random",c),Mt("urandom",c),st("/dev/shm"),st("/dev/shm/tmp")}(),function(){st("/proc");var t=st("/proc/self");st("/proc/self/fd"),On({Xa(){var r=qn(t,"fd",16895,73);return r.Ma={Va:ue.Ma.Va},r.La={lookup(c,f){c=+f;var b=He(c);return c={parent:null,Xa:{zb:"fake"},La:{readlink:()=>b.path},id:c+1},c.parent=c},readdir(){return Array.from(Ve.entries()).filter(([,c])=>c).map(([c])=>c.toString())}},r}},"/proc/self/fd")}(),ue.vb=new j(44),ue.vb.stack="<generic error, no stack>";var Cr={a:(t,r,c,f)=>B(`Assertion failed: ${t?ye(T,t):""}, at: `+[r?r?ye(T,r):"":"unknown filename",c,f?f?ye(T,f):"":"unknown function"]),i:function(t,r){try{return t=t?ye(T,t):"",sn(t,r),0}catch(c){if(typeof Ce=="undefined"||c.name!=="ErrnoError")throw c;return-c.Pa}},L:function(t,r,c){try{if(r=r?ye(T,r):"",r=Ut(t,r),c&-8)return-28;var f=_e(r,{$a:!0}).node;return f?(t="",c&4&&(t+="r"),c&2&&(t+="w"),c&1&&(t+="x"),t&&nn(f,t)?-2:0):-44}catch(b){if(typeof Ce=="undefined"||b.name!=="ErrnoError")throw b;return-b.Pa}},j:function(t,r){try{var c=He(t);return qt(c,c.node,r,!1),0}catch(f){if(typeof Ce=="undefined"||f.name!=="ErrnoError")throw f;return-f.Pa}},h:function(t){try{var r=He(t);return er(r,r.node,{timestamp:Date.now(),Fb:!1}),0}catch(c){if(typeof Ce=="undefined"||c.name!=="ErrnoError")throw c;return-c.Pa}},b:function(t,r,c){Pn=c;try{var f=He(t);switch(r){case 0:var b=pt();if(0>b)break;for(;Ve[b];)b++;return Zn(f,b).fd;case 1:case 2:return 0;case 3:return f.flags;case 4:return b=pt(),f.flags|=b,0;case 12:return b=pt(),P[b+0>>1]=2,0;case 13:case 14:return 0}return-28}catch(k){if(typeof Ce=="undefined"||k.name!=="ErrnoError")throw k;return-k.Pa}},g:function(t,r){try{var c=He(t),f=c.node,b=c.Ma.Ta;t=b?c:f,b!=null||(b=f.La.Ta),rn(b);var k=b(t);return an(r,k)}catch(F){if(typeof Ce=="undefined"||F.name!=="ErrnoError")throw F;return-F.Pa}},H:function(t,r){r=-9007199254740992>r||9007199254740992<r?NaN:Number(r);try{if(isNaN(r))return 61;var c=He(t);if(0>r||!(c.flags&2097155))throw new j(28);return kr(c,c.node,r),0}catch(f){if(typeof Ce=="undefined"||f.name!=="ErrnoError")throw f;return-f.Pa}},G:function(t,r){try{if(r===0)return-28;var c=Le("/")+1;return r<c?-68:(ze("/",T,t,r),c)}catch(f){if(typeof Ce=="undefined"||f.name!=="ErrnoError")throw f;return-f.Pa}},K:function(t,r){try{return t=t?ye(T,t):"",an(r,pn(t,!0))}catch(c){if(typeof Ce=="undefined"||c.name!=="ErrnoError")throw c;return-c.Pa}},C:function(t,r,c){try{return r=r?ye(T,r):"",r=Ut(t,r),st(r,c),0}catch(f){if(typeof Ce=="undefined"||f.name!=="ErrnoError")throw f;return-f.Pa}},J:function(t,r,c,f){try{r=r?ye(T,r):"";var b=f&256;return r=Ut(t,r,f&4096),an(c,b?pn(r,!0):pn(r))}catch(k){if(typeof Ce=="undefined"||k.name!=="ErrnoError")throw k;return-k.Pa}},x:function(t,r,c,f){Pn=f;try{r=r?ye(T,r):"",r=Ut(t,r);var b=f?pt():0;return Nt(r,c,b).fd}catch(k){if(typeof Ce=="undefined"||k.name!=="ErrnoError")throw k;return-k.Pa}},v:function(t,r,c,f){try{if(r=r?ye(T,r):"",r=Ut(t,r),0>=f)return-28;var b=_e(r).node;if(!b)throw new j(44);if(!b.La.readlink)throw new j(28);var k=b.La.readlink(b),F=Math.min(f,Le(k)),oe=L[c+F];return ze(k,T,c,f+1),L[c+F]=oe,F}catch(he){if(typeof Ce=="undefined"||he.name!=="ErrnoError")throw he;return-he.Pa}},u:function(t){try{return t=t?ye(T,t):"",yr(t),0}catch(r){if(typeof Ce=="undefined"||r.name!=="ErrnoError")throw r;return-r.Pa}},f:function(t,r){try{return t=t?ye(T,t):"",an(r,pn(t))}catch(c){if(typeof Ce=="undefined"||c.name!=="ErrnoError")throw c;return-c.Pa}},r:function(t,r,c){try{return r=r?ye(T,r):"",r=Ut(t,r),c===0?In(r):c===512?yr(r):B("Invalid flags passed to unlinkat"),0}catch(f){if(typeof Ce=="undefined"||f.name!=="ErrnoError")throw f;return-f.Pa}},q:function(t,r,c){try{r=r?ye(T,r):"",r=Ut(t,r,!0);var f=Date.now(),b,k;if(c){var F=H[c>>2]+4294967296*A[c+4>>2],oe=A[c+8>>2];oe==1073741823?b=f:oe==1073741822?b=null:b=1e3*F+oe/1e6,c+=16,F=H[c>>2]+4294967296*A[c+4>>2],oe=A[c+8>>2],oe==1073741823?k=f:oe==1073741822?k=null:k=1e3*F+oe/1e6}else k=b=f;if((k!=null?k:b)!==null){t=b;var he=_e(r,{$a:!0}).node;rn(he.La.Ua)(he,{atime:t,mtime:k})}return 0}catch(ge){if(typeof Ce=="undefined"||ge.name!=="ErrnoError")throw ge;return-ge.Pa}},m:()=>B(""),l:()=>{Ne=!1,vn=0},A:function(t,r){t=-9007199254740992>t||9007199254740992<t?NaN:Number(t),t=new Date(1e3*t),A[r>>2]=t.getSeconds(),A[r+4>>2]=t.getMinutes(),A[r+8>>2]=t.getHours(),A[r+12>>2]=t.getDate(),A[r+16>>2]=t.getMonth(),A[r+20>>2]=t.getFullYear()-1900,A[r+24>>2]=t.getDay();var c=t.getFullYear();A[r+28>>2]=(c%4!==0||c%100===0&&c%400!==0?Sr:ir)[t.getMonth()]+t.getDate()-1|0,A[r+36>>2]=-(60*t.getTimezoneOffset()),c=new Date(t.getFullYear(),6,1).getTimezoneOffset();var f=new Date(t.getFullYear(),0,1).getTimezoneOffset();A[r+32>>2]=(c!=f&&t.getTimezoneOffset()==Math.min(f,c))|0},y:function(t,r,c,f,b,k,F){b=-9007199254740992>b||9007199254740992<b?NaN:Number(b);try{if(isNaN(b))return 61;var oe=He(f);if(r&2&&!(c&2)&&(oe.flags&2097155)!==2)throw new j(2);if((oe.flags&2097155)===1)throw new j(2);if(!oe.Ma.ib)throw new j(43);if(!t)throw new j(28);var he=oe.Ma.ib(oe,t,b,r,c),ge=he.Kb;return A[k>>2]=he.Ab,H[F>>2]=ge,0}catch(xe){if(typeof Ce=="undefined"||xe.name!=="ErrnoError")throw xe;return-xe.Pa}},z:function(t,r,c,f,b,k){k=-9007199254740992>k||9007199254740992<k?NaN:Number(k);try{var F=He(b);if(c&2){if(c=k,(F.node.mode&61440)!==32768)throw new j(43);if(!(f&2)){var oe=T.slice(t,t+r);F.Ma.jb&&F.Ma.jb(F,oe,c,r,f)}}}catch(he){if(typeof Ce=="undefined"||he.name!=="ErrnoError")throw he;return-he.Pa}},n:(t,r)=>{if(gn[t]&&(clearTimeout(gn[t].id),delete gn[t]),!r)return 0;var c=setTimeout(()=>{delete gn[t],$r(()=>Dr(t,performance.now()))},r);return gn[t]={id:c,Xb:r},0},B:(t,r,c,f)=>{var b=new Date().getFullYear(),k=new Date(b,0,1).getTimezoneOffset();b=new Date(b,6,1).getTimezoneOffset(),H[t>>2]=60*Math.max(k,b),A[r>>2]=+(k!=b),r=h(F=>{var oe=Math.abs(F);return`UTC${0<=F?"-":"+"}${String(Math.floor(oe/60)).padStart(2,"0")}${String(oe%60).padStart(2,"0")}`},"b"),t=r(k),r=r(b),b<k?(ze(t,T,c,17),ze(r,T,f,17)):(ze(t,T,f,17),ze(r,T,c,17))},d:()=>Date.now(),s:()=>2147483648,c:()=>performance.now(),o:t=>{var r=T.length;if(t>>>=0,2147483648<t)return!1;for(var c=1;4>=c;c*=2){var f=r*(1+.2/c);f=Math.min(f,t+100663296);e:{f=(Math.min(2147483648,65536*Math.ceil(Math.max(t,f)/65536))-I.buffer.byteLength+65535)/65536|0;try{I.grow(f),V();var b=1;break e}catch(k){}b=void 0}if(b)return!0}return!1},E:(t,r)=>{var c=0;return Er().forEach((f,b)=>{var k=r+c;for(b=H[t+4*b>>2]=k,k=0;k<f.length;++k)L[b++]=f.charCodeAt(k);L[b]=0,c+=f.length+1}),0},F:(t,r)=>{var c=Er();H[t>>2]=c.length;var f=0;return c.forEach(b=>f+=b.length+1),H[r>>2]=f,0},e:function(t){try{var r=He(t);return rr(r),0}catch(c){if(typeof Ce=="undefined"||c.name!=="ErrnoError")throw c;return c.Pa}},p:function(t,r){try{var c=He(t);return L[r]=c.tty?2:je(c.mode)?3:(c.mode&61440)===40960?7:4,P[r+2>>1]=0,ee[r+8>>3]=BigInt(0),ee[r+16>>3]=BigInt(0),0}catch(f){if(typeof Ce=="undefined"||f.name!=="ErrnoError")throw f;return f.Pa}},w:function(t,r,c,f){try{e:{var b=He(t);t=r;for(var k,F=r=0;F<c;F++){var oe=H[t>>2],he=H[t+4>>2];t+=8;var ge=xr(b,L,oe,he,k);if(0>ge){var xe=-1;break e}if(r+=ge,ge<he)break;typeof k!="undefined"&&(k+=ge)}xe=r}return H[f>>2]=xe,0}catch(Pe){if(typeof Ce=="undefined"||Pe.name!=="ErrnoError")throw Pe;return Pe.Pa}},D:function(t,r,c,f){r=-9007199254740992>r||9007199254740992<r?NaN:Number(r);try{if(isNaN(r))return 61;var b=He(t);return zn(b,r,c),ee[f>>3]=BigInt(b.position),b.ob&&r===0&&c===0&&(b.ob=null),0}catch(k){if(typeof Ce=="undefined"||k.name!=="ErrnoError")throw k;return k.Pa}},I:function(t){var c;try{var r=He(t);return(c=r.Ma)!=null&&c.fsync?r.Ma.fsync(r):0}catch(f){if(typeof Ce=="undefined"||f.name!=="ErrnoError")throw f;return f.Pa}},t:function(t,r,c,f){try{e:{var b=He(t);t=r;for(var k,F=r=0;F<c;F++){var oe=H[t>>2],he=H[t+4>>2];t+=8;var ge=Ot(b,L,oe,he,k);if(0>ge){var xe=-1;break e}if(r+=ge,ge<he)break;typeof k!="undefined"&&(k+=ge)}xe=r}return H[f>>2]=xe,0}catch(Pe){if(typeof Ce=="undefined"||Pe.name!=="ErrnoError")throw Pe;return Pe.Pa}},k:Bn},ae;(async function(){var c;function t(f){var b;return ae=f.exports,I=ae.M,V(),Ue=ae.O,G--,(b=a.monitorRunDependencies)==null||b.call(a,G),G==0&&Q&&(f=Q,Q=null,f()),ae}h(t,"a"),G++,(c=a.monitorRunDependencies)==null||c.call(a,G);var r={a:Cr};return a.instantiateWasm?new Promise(f=>{a.instantiateWasm(r,(b,k)=>{t(b,k),f(b.exports)})}):(te!=null||(te=a.locateFile?a.locateFile("sql-wasm.wasm",E):E+"sql-wasm.wasm"),t((await ve(r)).instance))})(),a._sqlite3_free=t=>(a._sqlite3_free=ae.P)(t),a._sqlite3_value_text=t=>(a._sqlite3_value_text=ae.Q)(t),a._sqlite3_prepare_v2=(t,r,c,f,b)=>(a._sqlite3_prepare_v2=ae.R)(t,r,c,f,b),a._sqlite3_step=t=>(a._sqlite3_step=ae.S)(t),a._sqlite3_reset=t=>(a._sqlite3_reset=ae.T)(t),a._sqlite3_exec=(t,r,c,f,b)=>(a._sqlite3_exec=ae.U)(t,r,c,f,b),a._sqlite3_finalize=t=>(a._sqlite3_finalize=ae.V)(t),a._sqlite3_column_name=(t,r)=>(a._sqlite3_column_name=ae.W)(t,r),a._sqlite3_column_text=(t,r)=>(a._sqlite3_column_text=ae.X)(t,r),a._sqlite3_column_type=(t,r)=>(a._sqlite3_column_type=ae.Y)(t,r),a._sqlite3_errmsg=t=>(a._sqlite3_errmsg=ae.Z)(t),a._sqlite3_clear_bindings=t=>(a._sqlite3_clear_bindings=ae._)(t),a._sqlite3_value_blob=t=>(a._sqlite3_value_blob=ae.$)(t),a._sqlite3_value_bytes=t=>(a._sqlite3_value_bytes=ae.aa)(t),a._sqlite3_value_double=t=>(a._sqlite3_value_double=ae.ba)(t),a._sqlite3_value_int=t=>(a._sqlite3_value_int=ae.ca)(t),a._sqlite3_value_type=t=>(a._sqlite3_value_type=ae.da)(t),a._sqlite3_result_blob=(t,r,c,f)=>(a._sqlite3_result_blob=ae.ea)(t,r,c,f),a._sqlite3_result_double=(t,r)=>(a._sqlite3_result_double=ae.fa)(t,r),a._sqlite3_result_error=(t,r,c)=>(a._sqlite3_result_error=ae.ga)(t,r,c),a._sqlite3_result_int=(t,r)=>(a._sqlite3_result_int=ae.ha)(t,r),a._sqlite3_result_int64=(t,r)=>(a._sqlite3_result_int64=ae.ia)(t,r),a._sqlite3_result_null=t=>(a._sqlite3_result_null=ae.ja)(t),a._sqlite3_result_text=(t,r,c,f)=>(a._sqlite3_result_text=ae.ka)(t,r,c,f),a._sqlite3_aggregate_context=(t,r)=>(a._sqlite3_aggregate_context=ae.la)(t,r),a._sqlite3_column_count=t=>(a._sqlite3_column_count=ae.ma)(t),a._sqlite3_data_count=t=>(a._sqlite3_data_count=ae.na)(t),a._sqlite3_column_blob=(t,r)=>(a._sqlite3_column_blob=ae.oa)(t,r),a._sqlite3_column_bytes=(t,r)=>(a._sqlite3_column_bytes=ae.pa)(t,r),a._sqlite3_column_double=(t,r)=>(a._sqlite3_column_double=ae.qa)(t,r),a._sqlite3_bind_blob=(t,r,c,f,b)=>(a._sqlite3_bind_blob=ae.ra)(t,r,c,f,b),a._sqlite3_bind_double=(t,r,c)=>(a._sqlite3_bind_double=ae.sa)(t,r,c),a._sqlite3_bind_int=(t,r,c)=>(a._sqlite3_bind_int=ae.ta)(t,r,c),a._sqlite3_bind_text=(t,r,c,f,b)=>(a._sqlite3_bind_text=ae.ua)(t,r,c,f,b),a._sqlite3_bind_parameter_index=(t,r)=>(a._sqlite3_bind_parameter_index=ae.va)(t,r),a._sqlite3_sql=t=>(a._sqlite3_sql=ae.wa)(t),a._sqlite3_normalized_sql=t=>(a._sqlite3_normalized_sql=ae.xa)(t),a._sqlite3_changes=t=>(a._sqlite3_changes=ae.ya)(t),a._sqlite3_close_v2=t=>(a._sqlite3_close_v2=ae.za)(t),a._sqlite3_create_function_v2=(t,r,c,f,b,k,F,oe,he)=>(a._sqlite3_create_function_v2=ae.Aa)(t,r,c,f,b,k,F,oe,he),a._sqlite3_update_hook=(t,r,c)=>(a._sqlite3_update_hook=ae.Ba)(t,r,c),a._sqlite3_open=(t,r)=>(a._sqlite3_open=ae.Ca)(t,r);var wn=a._malloc=t=>(wn=a._malloc=ae.Da)(t),Hn=a._free=t=>(Hn=a._free=ae.Ea)(t);a._RegisterExtensionFunctions=t=>(a._RegisterExtensionFunctions=ae.Fa)(t);var Un=h((t,r)=>(Un=ae.Ga)(t,r),"Db"),Dr=h((t,r)=>(Dr=ae.Ha)(t,r),"Wc"),$t=h(t=>($t=ae.Ia)(t),"wa"),At=h(t=>(At=ae.Ja)(t),"z"),dt=h(()=>(dt=ae.Ka)(),"sa");a.stackSave=()=>dt(),a.stackRestore=t=>$t(t),a.stackAlloc=t=>At(t),a.cwrap=(t,r,c,f)=>{var b=!c||c.every(k=>k==="number"||k==="boolean");return r!=="string"&&b&&!f?a["_"+t]:(...k)=>Xr(t,r,c,k)},a.addFunction=Wt,a.removeFunction=vt,a.UTF8ToString=pe,a.ALLOC_NORMAL=on,a.allocate=jn,a.allocateUTF8OnStack=bn;function Xt(){function t(){var b;if(a.calledRun=!0,!z){if(!a.noFSInit&&!un){var r,c;un=!0,f!=null||(f=a.stdin),r!=null||(r=a.stdout),c!=null||(c=a.stderr),f?Mt("stdin",f):hn("/dev/tty","/dev/stdin"),r?Mt("stdout",null,r):hn("/dev/tty","/dev/stdout"),c?Mt("stderr",null,c):hn("/dev/tty1","/dev/stderr"),Nt("/dev/stdin",0),Nt("/dev/stdout",1),Nt("/dev/stderr",1)}if(ae.N(),ct=!1,(b=a.onRuntimeInitialized)==null||b.call(a),a.postRun)for(typeof a.postRun=="function"&&(a.postRun=[a.postRun]);a.postRun.length;){var f=a.postRun.shift();K.unshift(f)}be(K)}}if(h(t,"a"),0<G)Q=Xt;else{if(a.preRun)for(typeof a.preRun=="function"&&(a.preRun=[a.preRun]);a.preRun.length;)at();be(fe),0<G?Q=Xt:a.setStatus?(a.setStatus("Running..."),setTimeout(()=>{setTimeout(()=>a.setStatus(""),1),t()},1)):t()}}if(h(Xt,"Yc"),a.preInit)for(typeof a.preInit=="function"&&(a.preInit=[a.preInit]);0<a.preInit.length;)a.preInit.pop()();return Xt(),s}),Zr)},"initSqlJs");typeof ts=="object"&&typeof Gn=="object"?(Gn.exports=es,Gn.exports.default=es):typeof define=="function"&&define.amd?define([],function(){return es}):typeof ts=="object"&&(ts.Module=es)});var Bi={};Ai(Bi,{DEFAULT_SETTINGS:()=>ss});var ss,ys=Ha(()=>{ss={fsrs:{requestRetention:.9,maximumInterval:36500,easyBonus:1.3,hardInterval:1.2,weights:[.4072,1.1829,3.1262,15.4722,7.2102,.5316,1.0651,.0234,1.616,.1544,1.0824,1.9813,.0953,.2975,2.2042,.2407,2.9466]},database:{autoBackup:!0,backupInterval:7},review:{showProgress:!0,enableKeyboardShortcuts:!0,sessionGoal:20,enableSessionLimit:!1},parsing:{headerLevel:2},ui:{enableBackgroundRefresh:!0,backgroundRefreshInterval:5},debug:{enableLogging:!1}}});var Xo={};Ai(Xo,{default:()=>vs});module.exports=$a(Xo);var Je=require("obsidian");var Pi=Wa(zi());var Ir={newCardsLimit:20,reviewCardsLimit:100,enableNewCardsLimit:!1,enableReviewCardsLimit:!1,reviewOrder:"due-date"};var ms=class ms{constructor(e){this.db=null;this.SQL=null;this.dbPath=e}async initialize(){try{this.SQL=await(0,Pi.default)({locateFile:n=>`https://sql.js.org/dist/${n}`});let e=await this.loadDatabaseFile();e?(this.db=new this.SQL.Database(new Uint8Array(e)),await this.migrateSchemaIfNeeded()):(this.db=new this.SQL.Database,await this.createTables())}catch(e){throw console.error("Failed to initialize database:",e),e}}async loadDatabaseFile(){try{let e=window.app.vault.adapter;return await e.exists(this.dbPath)?await e.readBinary(this.dbPath):null}catch(e){return console.log("Database file doesn't exist yet, will create new one"),null}}async save(){if(!this.db)throw new Error("Database not initialized");try{let e=this.db.export(),n=window.app.vault.adapter,s=this.dbPath.substring(0,this.dbPath.lastIndexOf("/"));await n.exists(s)||await n.mkdir(s),await n.writeBinary(this.dbPath,Buffer.from(e))}catch(e){throw console.error("Failed to save database:",e),e}}async createTables(){if(!this.db)throw new Error("Database not initialized");this.db.run(`
      -- Decks table
      CREATE TABLE IF NOT EXISTS decks (
        id TEXT PRIMARY KEY,
        name TEXT NOT NULL,
        filepath TEXT NOT NULL UNIQUE,
        tag TEXT NOT NULL,
        last_reviewed TEXT,
        config TEXT NOT NULL DEFAULT '{"newCardsLimit":20,"reviewCardsLimit":100,"enableNewCardsLimit":false,"enableReviewCardsLimit":false,"reviewOrder":"due-date"}',
        created TEXT NOT NULL,
        modified TEXT NOT NULL
      );

      -- Flashcards table
      CREATE TABLE IF NOT EXISTS flashcards (
        id TEXT PRIMARY KEY,
        deck_id TEXT NOT NULL,
        front TEXT NOT NULL,
        back TEXT NOT NULL,
        type TEXT NOT NULL CHECK (type IN ('header-paragraph', 'table')),
        source_file TEXT NOT NULL,
        line_number INTEGER NOT NULL,
        content_hash TEXT NOT NULL,
        state TEXT NOT NULL DEFAULT 'new' CHECK (state IN ('new', 'learning', 'review')),
        due_date TEXT NOT NULL,
        interval INTEGER NOT NULL DEFAULT 0,
        repetitions INTEGER NOT NULL DEFAULT 0,
        ease_factor REAL NOT NULL DEFAULT 2.5,
        stability REAL NOT NULL DEFAULT 2.5,
        lapses INTEGER NOT NULL DEFAULT 0,
        last_reviewed TEXT,
        created TEXT NOT NULL,
        modified TEXT NOT NULL,
        FOREIGN KEY (deck_id) REFERENCES decks(id) ON DELETE CASCADE
      );

      -- Review logs table
      CREATE TABLE IF NOT EXISTS review_logs (
        id TEXT PRIMARY KEY,
        flashcard_id TEXT NOT NULL,
        reviewed_at TEXT NOT NULL,
        difficulty TEXT NOT NULL CHECK (difficulty IN ('again', 'hard', 'good', 'easy')),
        old_interval INTEGER NOT NULL,
        new_interval INTEGER NOT NULL,
        old_ease_factor REAL NOT NULL,
        new_ease_factor REAL NOT NULL,
        time_elapsed INTEGER NOT NULL DEFAULT 0,
        FOREIGN KEY (flashcard_id) REFERENCES flashcards(id)
      );

      -- Indexes for performance
      CREATE INDEX IF NOT EXISTS idx_flashcards_deck_id ON flashcards(deck_id);
      CREATE INDEX IF NOT EXISTS idx_flashcards_due_date ON flashcards(due_date);
      CREATE INDEX IF NOT EXISTS idx_review_logs_flashcard_id ON review_logs(flashcard_id);
      CREATE INDEX IF NOT EXISTS idx_review_logs_reviewed_at ON review_logs(reviewed_at);
    `)}parseDeckRow(e){return{id:e[0],name:e[1],filepath:e[2],tag:e[3],lastReviewed:e[4],config:e[5]?JSON.parse(e[5]):Ir,created:e[6],modified:e[7]}}async createDeck(e){if(!this.db)throw new Error("Database not initialized");let n=new Date().toISOString(),s={...e,created:n,modified:n};try{let o=this.db.prepare(`
        INSERT INTO decks (id, name, filepath, tag, last_reviewed, config, created, modified)
        VALUES (?, ?, ?, ?, ?, ?, ?, ?)
      `);return o.run([s.id,s.name,s.filepath,s.tag,s.lastReviewed,JSON.stringify(s.config),s.created,s.modified]),o.free(),await this.save(),s}catch(o){throw o}}async getDeckByTag(e){if(!this.db)throw new Error("Database not initialized");let n=this.db.prepare("SELECT * FROM decks WHERE tag = ?");if(n.bind([e]),n.step()){let s=n.get();return n.free(),this.parseDeckRow(s)}return n.free(),null}async getDeckByFilepath(e){if(!this.db)throw new Error("Database not initialized");let n=this.db.prepare("SELECT * FROM decks WHERE filepath = ?");if(n.bind([e]),n.step()){let s=n.get();return n.free(),this.parseDeckRow(s)}return n.free(),null}async getDeckById(e){if(!this.db)throw new Error("Database not initialized");let n=this.db.prepare("SELECT * FROM decks WHERE id = ?");if(n.bind([e]),n.step()){let s=n.get();return n.free(),this.parseDeckRow(s)}return n.free(),null}async updateDeck(e,n){if(!this.db)throw new Error("Database not initialized");let s=new Date().toISOString(),o=Object.keys(n).map(g=>`${g==="lastReviewed"?"last_reviewed":g} = ?`).join(", "),a=this.db.prepare(`
      UPDATE decks
      SET ${o}, modified = ?
      WHERE id = ?
    `),u=Object.values(n).map((g,v)=>Object.keys(n)[v]==="config"?JSON.stringify(g):g);u.push(s,e),a.run(u),a.free(),await this.save()}async getAllDecks(){if(!this.db)throw new Error("Database not initialized");let e=this.db.prepare("SELECT * FROM decks ORDER BY name"),n=[];for(;e.step();){let s=e.get();n.push(this.parseDeckRow(s))}return e.free(),n}async updateDeckLastReviewed(e){if(!this.db)throw new Error("Database not initialized");let n=this.db.prepare(`
      UPDATE decks
      SET last_reviewed = ?, modified = ?
      WHERE id = ?
    `);n.run([new Date().toISOString(),new Date().toISOString(),e]),n.free(),await this.save()}async deleteDeckByFilepath(e){if(!this.db)throw new Error("Database not initialized");let n=await this.getDeckByFilepath(e);if(!n)return;let s=this.db.prepare("DELETE FROM flashcards WHERE deck_id = ?");s.run([n.id]),s.free();let o=this.db.prepare("DELETE FROM decks WHERE filepath = ?");o.run([e]),o.free(),await this.save()}async deleteDeck(e){if(!this.db)throw new Error("Database not initialized");let n=this.db.prepare("DELETE FROM flashcards WHERE deck_id = ?");n.run([e]),n.free();let s=this.db.prepare("DELETE FROM decks WHERE id = ?");s.run([e]),s.free(),await this.save()}async createFlashcard(e){if(!this.db)throw new Error("Database not initialized");let n=new Date().toISOString(),s={...e,created:n,modified:n},o=this.db.prepare(`
      INSERT OR REPLACE INTO flashcards (
        id, deck_id, front, back, type, source_file, line_number, content_hash,
        state, due_date, interval, repetitions, ease_factor, stability, lapses, last_reviewed, created, modified
      ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
    `);return o.run([s.id,s.deckId,s.front,s.back,s.type,s.sourceFile,s.lineNumber,s.contentHash,s.state,s.dueDate,s.interval,s.repetitions,s.easeFactor,s.stability,s.lapses,s.lastReviewed,s.created,s.modified]),o.free(),await this.save(),s}async updateFlashcard(e,n){if(!this.db)throw new Error("Database not initialized");let s=new Date().toISOString(),o=Object.keys(n).map(g=>`${g==="contentHash"?"content_hash":g==="sourceFile"?"source_file":g==="lineNumber"?"line_number":g==="dueDate"?"due_date":g==="easeFactor"?"ease_factor":g==="lastReviewed"?"last_reviewed":g.replace(/([A-Z])/g,"_$1").toLowerCase()} = ?`).join(", "),a=this.db.prepare(`
      UPDATE flashcards
      SET ${o}, modified = ?
      WHERE id = ?
    `),u=Object.values(n);u.push(s,e),a.run(u),a.free(),await this.save()}async deleteFlashcard(e){if(!this.db)throw new Error("Database not initialized");let n=this.db.prepare("DELETE FROM flashcards WHERE id = ?");n.run([e]),n.free(),await this.save()}async getFlashcardsByDeck(e){if(!this.db)throw new Error("Database not initialized");let n=this.db.prepare("SELECT * FROM flashcards WHERE deck_id = ?");n.bind([e]);let s=[];for(;n.step();){let o=n.get();s.push(this.rowToFlashcard(o))}return n.free(),s}async getDueFlashcards(e){if(!this.db)throw new Error("Database not initialized");let n=new Date().toISOString(),s=this.db.prepare(`
      SELECT * FROM flashcards
      WHERE deck_id = ? AND due_date <= ?
      ORDER BY due_date
    `);s.bind([e,n]);let o=[];for(;s.step();){let a=s.get();o.push(this.rowToFlashcard(a))}return s.free(),o}async getDailyReviewCounts(e){if(!this.db)throw new Error("Database not initialized");let n=new Date().toISOString().split("T")[0],s=`${n}T00:00:00.000Z`,o=`${n}T23:59:59.999Z`,a=this.db.prepare(`
      SELECT COUNT(*) as count FROM review_logs rl
      JOIN flashcards f ON rl.flashcard_id = f.id
      WHERE f.deck_id = ?
        AND rl.reviewed_at >= ?
        AND rl.reviewed_at <= ?
        AND (rl.old_interval = 0 OR f.repetitions = 1)
    `);a.bind([e,s,o]);let u=a.step()?a.get():[0],g=Number(u[0])||0;a.free();let v=this.db.prepare(`
      SELECT COUNT(*) as count FROM review_logs rl
      JOIN flashcards f ON rl.flashcard_id = f.id
      WHERE f.deck_id = ?
        AND rl.reviewed_at >= ?
        AND rl.reviewed_at <= ?
        AND rl.old_interval > 0
    `);v.bind([e,s,o]);let m=v.step()?v.get():[0],x=Number(m[0])||0;return v.free(),{newCount:g,reviewCount:x}}async getReviewableFlashcards(e){if(!this.db)throw new Error("Database not initialized");let n=new Date().toISOString(),s=await this.getDeckById(e);if(!s)throw new Error(`Deck not found: ${e}`);let o=s.config,a=[],u=await this.getDailyReviewCounts(e),g=this.db.prepare(`
      SELECT * FROM flashcards
      WHERE deck_id = ? AND due_date <= ? AND state = 'learning'
      ORDER BY due_date
    `);for(g.bind([e,n]);g.step();){let _=g.get();a.push(this.rowToFlashcard(_))}g.free();let v=Number(o.newCardsLimit)||0,m=Number(u.newCount)||0,x=o.enableNewCardsLimit&&v>0?Math.max(0,v-m):o.enableNewCardsLimit&&v===0?0:Number.MAX_SAFE_INTEGER;if(x>0){let _=this.db.prepare(`
        SELECT * FROM flashcards
        WHERE deck_id = ? AND due_date <= ? AND state = 'new'
        ORDER BY due_date
        ${o.enableNewCardsLimit?`LIMIT ${x}`:""}
      `);for(_.bind([e,n]);_.step();){let O=_.get();a.push(this.rowToFlashcard(O))}_.free()}let S=Number(o.reviewCardsLimit)||0,E=Number(u.reviewCount)||0,C=o.enableReviewCardsLimit&&S>0?Math.max(0,S-E):o.enableReviewCardsLimit&&S===0?0:Number.MAX_SAFE_INTEGER;if(C>0){let _=this.db.prepare(`
        SELECT * FROM flashcards
        WHERE deck_id = ? AND due_date <= ? AND state = 'review'
        ORDER BY due_date
        ${o.enableReviewCardsLimit?`LIMIT ${C}`:""}
      `);for(_.bind([e,n]);_.step();){let O=_.get();a.push(this.rowToFlashcard(O))}_.free()}return a.sort((_,O)=>{let D={learning:1,review:2,new:3},M=D[_.state],N=D[O.state];return M!==N?M-N:_.state==="learning"?new Date(_.dueDate).getTime()-new Date(O.dueDate).getTime():_.state==="review"?o.reviewOrder==="random"?Math.random()-.5:new Date(_.dueDate).getTime()-new Date(O.dueDate).getTime():new Date(_.dueDate).getTime()-new Date(O.dueDate).getTime()}),a}async deleteFlashcardsByFile(e){if(!this.db)throw new Error("Database not initialized");let n=this.db.prepare("DELETE FROM flashcards WHERE source_file = ?");n.run([e]),n.free(),await this.save()}async createReviewLog(e){if(!this.db)throw new Error("Database not initialized");let n=`review_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,s=this.db.prepare(`
      INSERT INTO review_logs (
        id, flashcard_id, reviewed_at, difficulty,
        old_interval, new_interval, old_ease_factor, new_ease_factor, time_elapsed
      ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)
    `);s.run([n,e.flashcardId,e.reviewedAt,e.difficulty,e.oldInterval,e.newInterval,e.oldEaseFactor,e.newEaseFactor,e.timeElapsed]),s.free(),await this.save()}async getDeckStats(e){if(!this.db)throw new Error("Database not initialized");let n=new Date().toISOString(),s=await this.getDeckById(e);if(!s)throw new Error(`Deck not found: ${e}`);let o=s.config,a=await this.getDailyReviewCounts(e),u=this.db.prepare(`
      SELECT COUNT(*) FROM flashcards
      WHERE deck_id = ? AND state = 'new' AND due_date <= ?
    `);u.bind([e,n]),u.step();let g=u.get()[0]||0;u.free();let v=g,m=Number(o.newCardsLimit)||0,x=Number(a.newCount)||0;if(o.enableNewCardsLimit&&m>0){let z=Math.max(0,m-x);v=Math.min(g,z)}else o.enableNewCardsLimit&&m===0&&(v=0);let S=this.db.prepare(`
      SELECT COUNT(*) FROM flashcards
      WHERE deck_id = ? AND state = 'learning' AND due_date <= ?
    `);S.bind([e,n]),S.step();let E=S.get()[0]||0;S.free();let C=this.db.prepare(`
      SELECT COUNT(*) FROM flashcards
      WHERE deck_id = ? AND state = 'review' AND due_date <= ?
    `);C.bind([e,n]),C.step();let _=C.get()[0]||0;C.free();let O=_,D=Number(o.reviewCardsLimit)||0,M=Number(a.reviewCount)||0;if(o.enableReviewCardsLimit&&D>0){let z=Math.max(0,D-M);O=Math.min(_,z)}else o.enableReviewCardsLimit&&D===0&&(O=0);let N=this.db.prepare(`
      SELECT COUNT(*) FROM flashcards WHERE deck_id = ?
    `);N.bind([e]),N.step();let I=N.get()[0]||0;return N.free(),{deckId:e,newCount:v,learningCount:E,dueCount:O,totalCount:I}}async getAllDeckStats(){if(!this.db)throw new Error("Database not initialized");let e=await this.getAllDecks(),n=[];for(let s of e){let o=await this.getDeckStats(s.id);n.push(o)}return n}async getReviewCountsByDate(e=365){if(!this.db)throw new Error("Database not initialized");let n=new Date,s=new Date;s.setDate(n.getDate()-e);let o=this.db.prepare(`
      SELECT DATE(reviewed_at) as review_date, COUNT(*) as count
      FROM review_logs
      WHERE reviewed_at >= ? AND reviewed_at <= ?
      GROUP BY DATE(reviewed_at)
      ORDER BY review_date
    `);o.bind([s.toISOString(),n.toISOString()]);let a=new Map;for(;o.step();){let u=o.get(),g=u[0],v=u[1];a.set(g,v)}return o.free(),a}async migrateSchemaIfNeeded(){if(this.db)try{let e=this.db.prepare(`
        SELECT name FROM sqlite_master
        WHERE type='table' AND name IN ('decks', 'flashcards', 'review_logs')
      `),n=[];for(;e.step();){let u=e.get();n.push(u[0])}if(e.free(),n.length===0){console.log("No existing tables found. Creating initial schema..."),await this.createTables(),await this.save();return}let s=!0,o=!0,a=!0;if(n.includes("decks")){let u=this.db.prepare("PRAGMA table_info(decks)"),g=[];for(;u.step();)g.push(u.get());u.free(),s=g.some(v=>v[1]==="filepath"),o=g.some(v=>v[1]==="config")}else s=!1,o=!1;if(n.includes("review_logs"))try{let u=this.db.prepare("PRAGMA table_info(review_logs)"),g=[];for(;u.step();)g.push(u.get());u.free(),a=g.some(v=>v[1]==="time_elapsed")}catch(u){a=!1}else a=!1;if(!s||!o||!a){console.log("Migrating database schema to support filepath, config, and time_elapsed columns...");try{!n.includes("decks")||!n.includes("flashcards")||!n.includes("review_logs")?(console.log("Missing tables detected. Creating missing tables..."),await this.createTables()):(s||(console.log("Adding filepath column to decks table..."),this.db.exec("ALTER TABLE decks ADD COLUMN filepath TEXT")),o||(console.log("Adding config column to decks table..."),this.db.exec("ALTER TABLE decks ADD COLUMN config TEXT DEFAULT '{}'")),a||(console.log("Adding time_elapsed column to review_logs table..."),this.db.exec("ALTER TABLE review_logs ADD COLUMN time_elapsed INTEGER NOT NULL DEFAULT 0"))),console.log("Database schema migration completed. All user data preserved."),await this.save()}catch(u){console.error("Error during column migration:",u),console.log("Falling back to table recreation..."),this.db.exec(`
            DROP TABLE IF EXISTS review_logs;
            DROP TABLE IF EXISTS flashcards;
            DROP TABLE IF EXISTS decks;
          `),await this.createTables(),console.log("Database recreated. Data will be rebuilt from vault files."),await this.save()}}}catch(e){console.error("Error during schema migration:",e)}}rowToFlashcard(e){return{id:e[0],deckId:e[1],front:e[2],back:e[3],type:e[4],sourceFile:e[5],lineNumber:e[6],contentHash:e[7],state:e[8],dueDate:e[9],interval:e[10],repetitions:e[11],easeFactor:e[12],stability:e[13],lapses:e[14],lastReviewed:e[15],created:e[16],modified:e[17]}}async getOverallStatistics(e="all",n="12months"){if(!this.db)throw new Error("Database not initialized");try{let s=new Date;n==="12months"?s.setFullYear(s.getFullYear()-1):s.setFullYear(s.getFullYear()-10);let o="",a=[];if(e.startsWith("deck:")){let L=e.substring(5);o="AND f.deck_id = ?",a.push(L)}else if(e.startsWith("tag:")){let L=e.substring(4);o="AND d.tag = ?",a.push(L)}let u=this.db.prepare(`
      SELECT
        DATE(reviewed_at) as date,
        COUNT(*) as reviews,
        COUNT(CASE WHEN difficulty != 'again' THEN 1 END) as correct,
        COUNT(CASE WHEN f.state = 'new' THEN 1 END) as new_cards,
        COUNT(CASE WHEN f.state = 'learning' THEN 1 END) as learning_cards,
        COUNT(CASE WHEN f.state = 'review' THEN 1 END) as review_cards
      FROM review_logs rl
      JOIN flashcards f ON rl.flashcard_id = f.id
      ${o?"JOIN decks d ON f.deck_id = d.id":""}
      WHERE DATE(reviewed_at) >= DATE(?)
      ${o}
      GROUP BY DATE(reviewed_at)
      ORDER BY date DESC
    `);u.bind([s.toISOString().split("T")[0],...a]);let g=[];for(;u.step();){let L=u.get(),T=L[1],P=L[2];g.push({date:L[0],reviews:T,timeSpent:T*30,newCards:L[3],learningCards:L[4],reviewCards:L[5],correctRate:T>0?P/T*100:0})}u.free();let v=this.db.prepare(`
      SELECT
        f.state,
        COUNT(*) as count
      FROM flashcards f
      ${o?"JOIN decks d ON f.deck_id = d.id":""}
      WHERE 1=1
      ${o}
      GROUP BY f.state
    `),m={new:0,learning:0,mature:0};for(o&&v.bind(a);v.step();){let L=v.get(),T=L[0],P=L[1];T==="new"?m.new=P:T==="learning"?m.learning=P:T==="review"&&(m.mature=P)}v.free();let x=this.db.prepare(`
      SELECT
        rl.difficulty,
        COUNT(*) as count
      FROM review_logs rl
      JOIN flashcards f ON rl.flashcard_id = f.id
      ${o?"JOIN decks d ON f.deck_id = d.id":""}
      WHERE DATE(rl.reviewed_at) >= DATE(?)
      ${o}
      GROUP BY rl.difficulty
    `),S={again:0,hard:0,good:0,easy:0};for(x.bind([s.toISOString().split("T")[0],...a]);x.step();){let L=x.get(),T=L[0],P=L[1];S[T]=P}x.free();let E=Object.values(S).reduce((L,T)=>L+T,0),C=E-S.again,_=E>0?C/E*100:0,O=this.db.prepare(`
      SELECT
        CASE
          WHEN f.interval < 1440 THEN CAST(f.interval / 60 AS INTEGER) || 'h'
          WHEN f.interval < 43200 THEN CAST(f.interval / 1440 AS INTEGER) || 'd'
          ELSE CAST(f.interval / 43200 AS INTEGER) || 'm'
        END as interval_group,
        COUNT(*) as count
      FROM flashcards f
      ${o?"JOIN decks d ON f.deck_id = d.id":""}
      WHERE f.state != 'new'
      ${o}
      GROUP BY interval_group
      ORDER BY f.interval
    `);o&&O.bind(a);let D=[];for(;O.step();){let L=O.get();D.push({interval:L[0],count:L[1]})}O.free();let M=[],N=new Date;for(let L=0;L<90;L++){let T=new Date(N);T.setDate(N.getDate()+L);let P=T.toISOString().split("T")[0],A=this.db.prepare(`
        SELECT COUNT(*) as due_count
        FROM flashcards f
        ${o?"JOIN decks d ON f.deck_id = d.id":""}
        WHERE DATE(f.due_date) = DATE(?)
        ${o}
      `);A.bind([P,...a]);let H=0;A.step()&&(H=A.get()[0]),A.free(),M.push({date:P,dueCount:H})}let I=this.db.prepare(`
      SELECT
        AVG(rl.time_elapsed / 1000.0) as avg_pace,
        SUM(rl.time_elapsed / 1000.0) as total_time
      FROM review_logs rl
      JOIN flashcards f ON rl.flashcard_id = f.id
      ${o?"JOIN decks d ON f.deck_id = d.id":""}
      WHERE rl.reviewed_at >= ?
      ${o}
    `);o?I.bind([s.toISOString(),...a]):I.bind([s.toISOString()]);let z=0,W=0;if(I.step()){let L=I.get();z=L[0]||0,W=L[1]||0}return I.free(),{dailyStats:g,cardStats:m,answerButtons:S,retentionRate:_,intervals:D,forecast:M,averagePace:z,totalReviewTime:W}}catch(s){return console.error("Error in getOverallStatistics:",s),{dailyStats:[],cardStats:{new:0,learning:0,mature:0},answerButtons:{again:0,hard:0,good:0,easy:0},retentionRate:0,intervals:[],forecast:[],averagePace:0,totalReviewTime:0}}}async close(){this.db&&(this.db.close(),this.db=null)}};h(ms,"DatabaseService");var ns=ms;var bs=require("obsidian");var ws=class ws{constructor(e,n,s,o){this.vault=e,this.metadataCache=n,this.db=s,this.plugin=o}debugLog(e,...n){var s;(s=this.plugin)!=null&&s.debugLog&&this.plugin.debugLog(e,...n)}async scanVaultForDecks(){let e=new Map,n=this.vault.getMarkdownFiles();this.debugLog(`Scanning ${n.length} markdown files for flashcard tags`);for(let s of n){let o=this.metadataCache.getFileCache(s);if(!o){this.debugLog(`No metadata for file: ${s.path}`);continue}this.debugLog(`Checking file: ${s.path}`);let a=[];if(o.tags){let g=o.tags.map(v=>v.tag);a.push(...g),this.debugLog(`File ${s.path} has inline tags:`,g)}if(o.frontmatter&&o.frontmatter.tags){let v=(Array.isArray(o.frontmatter.tags)?o.frontmatter.tags:[o.frontmatter.tags]).map(m=>m.startsWith("#")?m:`#${m}`);a.push(...v),this.debugLog(`File ${s.path} has frontmatter tags:`,v)}if(a.length===0)continue;let u=a.filter(g=>g.startsWith("#flashcards"));this.debugLog(`All tags for ${s.path}:`,a),this.debugLog(`Flashcard tags for ${s.path}:`,u);for(let g of u)e.has(g)||e.set(g,[]),e.get(g).push(s)}return this.debugLog(`Found ${e.size} decks:`,Array.from(e.keys())),e}async syncDecks(){try{this.debugLog("Starting deck sync...");let e=await this.scanVaultForDecks();this.debugLog("Decks found in vault:",e);let n=await this.db.getAllDecks();this.debugLog("Existing decks in database:",n);let s=new Map;for(let v of n)s.set(v.filepath,v);let o=0,a=0;for(let[v,m]of e)for(let x of m){a++;let S=x.path,E=x.basename,C=s.get(S);if(this.debugLog(`Checking file: ${S}`),this.debugLog("Existing deck found:",C?`YES (ID: ${C.id})`:"NO"),C)C.tag!==v?(this.debugLog(`Updating deck "${E}" tag from ${C.tag} to ${v}`),await this.db.updateDeck(C.id,{tag:v})):this.debugLog(`Deck "${E}" already exists with correct tag, no update needed`);else{let _={id:this.generateDeckId(S),name:E,filepath:S,tag:v,lastReviewed:null,config:Ir};this.debugLog(`Creating new deck: "${E}" with ID: ${_.id}, tag: ${v}, filepath: ${S}`),await this.db.createDeck(_),o++}}let u=new Set;for(let[v,m]of e)for(let x of m)u.add(x.path);let g=0;for(let v of n)u.has(v.filepath)||(this.debugLog(`Deleting orphaned deck: "${v.name}" (${v.filepath})`),await this.db.deleteDeckByFilepath(v.filepath),g++);this.debugLog(`Deck sync completed. Processed ${a} files, created ${o} new decks, deleted ${g} orphaned decks.`)}catch(e){throw console.error("Error during deck sync:",e),e}}async parseFlashcardsFromFile(e){var v,m,x;let s=(await this.vault.read(e)).split(`
`),o=[],a=this.parseTableFlashcards(s);o.push(...a);let u=((x=(m=(v=this.plugin)==null?void 0:v.settings)==null?void 0:m.parsing)==null?void 0:x.headerLevel)||2,g=this.parseHeaderParagraphFlashcards(s,u);return o.push(...g),o}parseTableFlashcards(e){let n=[],s=!1,o=0,a=!1;for(let u=0;u<e.length;u++){let g=e[u].trim();if(g.startsWith("|")&&g.endsWith("|")){if(s||(s=!0,o=u,a=!1),!a){a=!0;continue}if(g.match(/^\|[\s-]+\|[\s-]+\|$/))continue;let v=g.split("|").map(m=>m.trim()).filter(m=>m.length>0);v.length>=2&&n.push({front:v[0],back:v[1],type:"table",lineNumber:u+1})}else s=!1}return n}parseHeaderParagraphFlashcards(e,n=2){let s=[],o=null,a=[],u=!1,g=!1;for(let v=0;v<e.length;v++){let m=e[v];if(v===0&&m==="---"){u=!0;continue}if(u&&m==="---"){u=!1;continue}if(u)continue;let x=new RegExp(`^#{${n}}\\s+`);if(m.match(x)){if(m.match(/^#\s+/)&&m.toLowerCase().includes("flashcard")){g=!0,o=null,a=[];continue}if(o&&a.length>0){let S={front:o.text.replace(new RegExp(`^#{${n}}\\s+`),""),back:a.join(`
`).trim(),type:"header-paragraph",lineNumber:o.lineNumber};s.push(S)}o={text:m,lineNumber:v+1},a=[],g=!1}else if(g)m.trim()===""&&(g=!1);else if(m.match(/^#{1,6}\s+/)){if(o&&a.length>0){let S={front:o.text.replace(new RegExp(`^#{${n}}\\s+`),""),back:a.join(`
`).trim(),type:"header-paragraph",lineNumber:o.lineNumber};s.push(S)}o=null,a=[]}else if(o){if(m.trim()===""&&a.length===0)continue;a.push(m)}}if(o&&a.length>0){let v={front:o.text.replace(new RegExp(`^#{${n}}\\s+`),""),back:a.join(`
`).trim(),type:"header-paragraph",lineNumber:o.lineNumber};s.push(v)}return s}async syncFlashcardsForDeck(e){this.debugLog(`Syncing flashcards for deck: ${e}`);let n=await this.db.getDeckByFilepath(e);if(!n){this.debugLog(`No deck found for filepath: ${e}`);return}this.debugLog(`Found deck ID: ${n.id}, name: ${n.name}, filepath: ${n.filepath}`);let s=this.vault.getAbstractFileByPath(e);if(!s||!(s instanceof bs.TFile))return;let o=await this.db.getFlashcardsByDeck(n.id);this.debugLog(`Found ${o.length} existing flashcards for deck ${n.name}`);let a=new Map;o.forEach(v=>{a.set(v.id,v),this.debugLog(`Existing card ID: ${v.id}, Front: "${v.front}"`)});let u=new Set,g=await this.parseFlashcardsFromFile(s);this.debugLog(`Parsed ${g.length} flashcards from ${e}`);for(let v of g){let m=this.generateFlashcardId(v.front,n.id),x=this.generateContentHash(v.back),S=a.get(m);if(this.debugLog(`Processing flashcard: "${v.front.substring(0,50)}..."`),this.debugLog(`Generated ID: ${m} (from front: "${v.front.substring(0,30)}..." + deck: ${n.id})`),this.debugLog(`Content hash: ${x}`),this.debugLog("Existing card found:",S?"YES":"NO"),S&&this.debugLog(`Existing card - ID: ${S.id}, Front: "${S.front.substring(0,30)}...", Hash: ${S.contentHash}`),u.add(m),S)S.contentHash!==x?(this.debugLog(`Content changed, updating flashcard: ${v.front.substring(0,30)}...`),await this.db.updateFlashcard(S.id,{front:v.front,back:v.back,type:v.type,contentHash:x})):this.debugLog(`No content change, skipping update: ${v.front.substring(0,30)}...`);else{let E={id:m,deckId:n.id,front:v.front,back:v.back,type:v.type,sourceFile:s.path,lineNumber:v.lineNumber,contentHash:x,state:"new",dueDate:new Date().toISOString(),interval:0,repetitions:0,easeFactor:5,stability:2.5,lapses:0,lastReviewed:null};this.debugLog(`Creating new flashcard: ${E.front}`),await this.db.createFlashcard(E)}}for(let[v,m]of a)u.has(v)||(this.debugLog(`Deleting flashcard: ${m.front}`),await this.db.deleteFlashcard(m.id));this.debugLog(`Flashcard sync completed for ${e}`)}async syncFlashcardsForDeckByName(e){await this.syncFlashcardsForDeck(e)}async createDeckForFile(e,n){let s=this.vault.getAbstractFileByPath(e);if(!s||!(s instanceof bs.TFile))return;let o=s.basename;if(!await this.db.getDeckByFilepath(e)){let u={id:this.generateDeckId(e),name:o,filepath:e,tag:n,lastReviewed:null,config:Ir};this.debugLog(`Creating new deck: "${o}" with ID: ${u.id}, tag: ${n}, filepath: ${e}`),await this.db.createDeck(u)}}generateContentHash(e){let n=0;for(let s=0;s<e.length;s++){let o=e.charCodeAt(s);n=(n<<5)-n+o,n=n&n}return Math.abs(n).toString(16)}extractDeckNameFromFiles(e){return e.length===0?"General":e[0].basename}extractDeckName(e){let n=e.replace("#flashcards","");return n.startsWith("/")&&(n=n.substring(1)),n?n.split("/").map(o=>o.charAt(0).toUpperCase()+o.slice(1)).join(" - "):"General"}generateDeckId(e){if(e){let n=0;for(let s=0;s<e.length;s++){let o=e.charCodeAt(s);n=(n<<5)-n+o,n=n&n}return`deck_${Math.abs(n).toString(36)}`}return`deck_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}generateFlashcardId(e,n){let s=`${n}:${e}`,o=0;for(let a=0;a<s.length;a++){let u=s.charCodeAt(a);o=(o<<5)-o+u,o=o&o}return`card_${Math.abs(o).toString(36)}`}};h(ws,"DeckManager");var rs=ws;var _s=class _s{constructor(e){this.params={w:[.4072,1.1829,3.1262,15.4722,7.2102,.5316,1.0651,.0234,1.616,.1544,1.0824,1.9813,.0953,.2975,2.2042,.2407,2.9466],requestRetention:.9,maximumInterval:60,easyBonus:1.3,hardInterval:1.2,...e}}updateParameters(e){this.params={...this.params,...e}}getSchedulingInfo(e){let n=this.flashcardToFSRS(e),s=new Date;return{again:this.calculateScheduleForRating(n,1,s),hard:this.calculateScheduleForRating(n,2,s),good:this.calculateScheduleForRating(n,3,s),easy:this.calculateScheduleForRating(n,4,s)}}updateCard(e,n){let s=this.difficultyToRating(n),o=this.flashcardToFSRS(e),a=new Date,u=this.calculateScheduleForRating(o,s,a);return{...e,state:u.state,dueDate:u.dueDate,interval:u.interval,easeFactor:u.difficulty,repetitions:u.repetitions,modified:a.toISOString()}}calculateScheduleForRating(e,n,s){let o;if(e.state==="New"){o=this.initDS(e),o.elapsedDays=0,o.scheduledDays=0,o.reps=1,o.lapses=n===1?1:0,o.state="Learning";let g=this.getNewCardInterval(n);return this.createSchedulingCard(s,g,o,"learning")}else if(e.state==="Learning"||e.state==="Relearning"){if(o={...e},o.reps+=1,n===1)return o.lapses+=1,o.state="Learning",this.createSchedulingCard(s,1,o,"learning");if(n===2){o.state="Learning";let g=Math.max(6,Math.round(e.scheduledDays*1440*1.2));return this.createSchedulingCard(s,g,o,"learning")}else if(n===3)if(e.scheduledDays*1440<1440){o.state="Learning";let g=Math.min(1440,Math.round(e.scheduledDays*1440*2.5)),v=g>=1440?"review":"learning";return this.createSchedulingCard(s,g,o,v)}else o.state="Review",o.stability=this.initStability(3),o.difficulty=this.initDifficulty(3);else o.state="Review",o.stability=this.initStability(4),o.difficulty=this.initDifficulty(4)}else{if(o={...e},o.elapsedDays=this.getElapsedDays(e.lastReview,s),o.reps+=1,n===1)return o.lapses+=1,o.state="Learning",this.createSchedulingCard(s,1,o,"learning");let g=this.forgettingCurve(o.elapsedDays,o.stability);o.difficulty=this.nextDifficulty(o.difficulty,n),o.stability=this.nextStability(o.difficulty,o.stability,g,n),o.state="Review"}let a=this.nextInterval(o.stability);o.scheduledDays=a,o.lastReview=s;let u=Math.round(a*1440);return this.createSchedulingCard(s,u,o,this.fsrsStateToFlashcardState(o.state))}getNewCardInterval(e){switch(e){case 1:return 1;case 2:return 6;case 3:return 10;case 4:return 4*1440;default:return 10}}createSchedulingCard(e,n,s,o){return{dueDate:new Date(e.getTime()+n*60*1e3).toISOString(),interval:n,easeFactor:Number(s.difficulty.toFixed(2)),repetitions:s.reps,stability:Number(s.stability.toFixed(2)),difficulty:Number(s.difficulty.toFixed(2)),state:o}}initDS(e){return{...e,stability:0,difficulty:0,elapsedDays:0,scheduledDays:0,reps:0,lapses:0,state:"New",lastReview:new Date}}initStability(e){return Math.max(this.params.w[e-1],.1)}initDifficulty(e){return Math.min(Math.max(this.params.w[4]-this.params.w[5]*(e-3),1),10)}forgettingCurve(e,n){return Math.pow(1+e/(9*n),-1)}nextDifficulty(e,n){let s=e-this.params.w[6]*(n-3);return Math.min(Math.max(this.meanReversion(this.params.w[4],s),1),10)}meanReversion(e,n){return this.params.w[7]*e+(1-this.params.w[7])*n}nextStability(e,n,s,o){let a=o===2?this.params.w[15]:1,u=o===4?this.params.w[16]:1;return n*(1+Math.exp(this.params.w[8])*(11-e)*Math.pow(n,-this.params.w[9])*(Math.exp((1-s)*this.params.w[10])-1)*a*u)}nextInterval(e){let n=e*(Math.log(this.params.requestRetention)/Math.log(.9));return Math.min(Math.max(Math.round(n),1),this.params.maximumInterval)}getElapsedDays(e,n){return Math.max(0,(n.getTime()-e.getTime())/(1e3*60*60*24))}flashcardToFSRS(e){let n=e.modified?new Date(e.modified):new Date,s=this.getElapsedDays(n,new Date);return{stability:e.easeFactor||2.5,difficulty:e.easeFactor||5,elapsedDays:s,scheduledDays:e.interval/1440,reps:e.repetitions,lapses:0,state:this.flashcardStateToFSRSState(e.state),lastReview:n}}flashcardStateToFSRSState(e){switch(e){case"new":return"New";case"learning":return"Learning";case"review":return"Review";default:return"New"}}fsrsStateToFlashcardState(e){switch(e){case"New":return"new";case"Learning":case"Relearning":return"learning";case"Review":return"review";default:return"new"}}difficultyToRating(e){switch(e){case"again":return 1;case"hard":return 2;case"good":return 3;case"easy":return 4;default:return 3}}static getIntervalDisplay(e){if(e<60)return`${Math.round(e)}m`;if(e<1440)return`${Math.round(e/60)}h`;{let n=Math.round(e/1440);return n<30?`${n}d`:n<365?`${Math.round(n/30)}mo`:`${(n/365).toFixed(1)}y`}}};h(_s,"FSRS");var Cn=_s;ys();var Be=require("obsidian");var ks=class ks extends Be.PluginSettingTab{constructor(e,n){super(e,n),this.plugin=n}display(){let{containerEl:e}=this;e.empty(),e.createEl("h2",{text:"Decks Plugin Settings"}),this.addFSRSSettings(e),this.addDatabaseSettings(e),this.addReviewSettings(e),this.addParsingSettings(e),this.addUISettings(e),this.addDebugSettings(e)}addFSRSSettings(e){e.createEl("h3",{text:"FSRS Algorithm"}),e.createEl("p",{text:"Configure the Free Spaced Repetition Scheduler algorithm parameters.",cls:"setting-item-description"}),new Be.Setting(e).setName("Target Retention").setDesc("Desired retention rate for flashcards (0.8 = 80%)").addSlider(n=>n.setLimits(.7,.98,.01).setValue(this.plugin.settings.fsrs.requestRetention).setDynamicTooltip().onChange(async s=>{this.plugin.settings.fsrs.requestRetention=s,await this.plugin.saveSettings()})),new Be.Setting(e).setName("Maximum Interval").setDesc("Maximum number of days between reviews").addText(n=>n.setPlaceholder("36500").setValue(this.plugin.settings.fsrs.maximumInterval.toString()).onChange(async s=>{let o=parseInt(s);!isNaN(o)&&o>0&&(this.plugin.settings.fsrs.maximumInterval=o,await this.plugin.saveSettings())})),new Be.Setting(e).setName("Easy Bonus").setDesc("Multiplier for easy cards (higher = longer intervals)").addSlider(n=>n.setLimits(1.1,2,.1).setValue(this.plugin.settings.fsrs.easyBonus).setDynamicTooltip().onChange(async s=>{this.plugin.settings.fsrs.easyBonus=s,await this.plugin.saveSettings()})),new Be.Setting(e).setName("Hard Interval").setDesc("Multiplier for hard cards in learning phase").addSlider(n=>n.setLimits(1,2,.1).setValue(this.plugin.settings.fsrs.hardInterval).setDynamicTooltip().onChange(async s=>{this.plugin.settings.fsrs.hardInterval=s,await this.plugin.saveSettings()})),new Be.Setting(e).setName("Reset to Defaults").setDesc("Reset FSRS parameters to default values").addButton(n=>n.setButtonText("Reset").setWarning().onClick(async()=>{let s=(await Promise.resolve().then(()=>(ys(),Bi))).DEFAULT_SETTINGS;this.plugin.settings.fsrs={...s.fsrs},await this.plugin.saveSettings(),this.display()}))}addDatabaseSettings(e){e.createEl("h3",{text:"Database"}),new Be.Setting(e).setName("Database Path").setDesc("Custom path for the database file (leave empty for default)").addText(n=>n.setPlaceholder(".obsidian/plugins/decks/flashcards.db").setValue(this.plugin.settings.database.customPath||"").onChange(async s=>{this.plugin.settings.database.customPath=s.trim()||void 0,await this.plugin.saveSettings()})),new Be.Setting(e).setName("Auto Backup").setDesc("Automatically backup the database").addToggle(n=>n.setValue(this.plugin.settings.database.autoBackup).onChange(async s=>{this.plugin.settings.database.autoBackup=s,await this.plugin.saveSettings()})),new Be.Setting(e).setName("Backup Interval").setDesc("Number of days between automatic backups").addText(n=>n.setPlaceholder("7").setValue(this.plugin.settings.database.backupInterval.toString()).onChange(async s=>{let o=parseInt(s);!isNaN(o)&&o>0&&(this.plugin.settings.database.backupInterval=o,await this.plugin.saveSettings())}))}addReviewSettings(e){e.createEl("h3",{text:"Review Sessions"}),new Be.Setting(e).setName("Show Progress").setDesc("Display progress bar during review sessions").addToggle(n=>n.setValue(this.plugin.settings.review.showProgress).onChange(async s=>{this.plugin.settings.review.showProgress=s,await this.plugin.saveSettings()})),new Be.Setting(e).setName("Keyboard Shortcuts").setDesc("Enable keyboard shortcuts in review modal (1-4 for difficulty)").addToggle(n=>n.setValue(this.plugin.settings.review.enableKeyboardShortcuts).onChange(async s=>{this.plugin.settings.review.enableKeyboardShortcuts=s,await this.plugin.saveSettings()})),new Be.Setting(e).setName("Session Limit").setDesc("Limit the number of cards per review session").addToggle(n=>n.setValue(this.plugin.settings.review.enableSessionLimit).onChange(async s=>{this.plugin.settings.review.enableSessionLimit=s,await this.plugin.saveSettings()})),new Be.Setting(e).setName("Session Goal").setDesc("Target number of cards per review session").addText(n=>n.setPlaceholder("20").setValue(this.plugin.settings.review.sessionGoal.toString()).onChange(async s=>{let o=parseInt(s);!isNaN(o)&&o>0&&(this.plugin.settings.review.sessionGoal=o,await this.plugin.saveSettings())}))}addParsingSettings(e){e.createEl("h3",{text:"Parsing Settings"}),e.createEl("p",{text:"Configure how flashcards are parsed from your notes.",cls:"setting-item-description"}),new Be.Setting(e).setName("Header Level for Flashcards").setDesc("Which header level to use for header-paragraph flashcards (H1 = 1, H2 = 2, etc.)").addDropdown(n=>n.addOption("1","H1 (#)").addOption("2","H2 (##)").addOption("3","H3 (###)").addOption("4","H4 (####)").addOption("5","H5 (#####)").addOption("6","H6 (######)").setValue(this.plugin.settings.parsing.headerLevel.toString()).onChange(async s=>{this.plugin.settings.parsing.headerLevel=parseInt(s),await this.plugin.saveSettings()}))}addUISettings(e){e.createEl("h3",{text:"User Interface"});let n=new Be.Setting(e).setName("Background Refresh Interval").setDesc("How often to refresh deck stats in the side panel (in seconds)").addText(s=>s.setPlaceholder("5").setValue(this.plugin.settings.ui.backgroundRefreshInterval.toString()).onChange(async o=>{let a=parseInt(o);!isNaN(a)&&a>=1&&a<=60&&(this.plugin.settings.ui.backgroundRefreshInterval=a,await this.plugin.saveSettings(),this.plugin.view&&this.plugin.view.restartBackgroundRefresh())}));new Be.Setting(e).setName("Enable Background Refresh").setDesc("Automatically refresh deck stats in the side panel").addToggle(s=>s.setValue(this.plugin.settings.ui.enableBackgroundRefresh).onChange(async o=>{this.plugin.settings.ui.enableBackgroundRefresh=o,await this.plugin.saveSettings(),n.setDisabled(!o),this.plugin.view&&(o?this.plugin.view.startBackgroundRefresh():this.plugin.view.stopBackgroundRefresh())})),n.setDisabled(!this.plugin.settings.ui.enableBackgroundRefresh)}addDebugSettings(e){e.createEl("h3",{text:"Debug"}),e.createEl("p",{text:"Debug settings for troubleshooting and development.",cls:"setting-item-description"}),new Be.Setting(e).setName("Enable Debug Logging").setDesc("Show detailed logging in the console for sync operations and flashcard processing").addToggle(n=>{var s;return n.setValue(((s=this.plugin.settings.debug)==null?void 0:s.enableLogging)||!1).onChange(async o=>{this.plugin.settings.debug||(this.plugin.settings.debug={enableLogging:!1}),this.plugin.settings.debug.enableLogging=o,await this.plugin.saveSettings()})})}};h(ks,"DecksSettingTab");var is=ks;function ke(){}h(ke,"noop");function Cs(i){return i()}h(Cs,"run");function ji(){return Object.create(null)}h(ji,"blank_object");function Ke(i){i.forEach(Cs)}h(Ke,"run_all");function gr(i){return typeof i=="function"}h(gr,"is_function");function Kt(i,e){return i!=i?e==e:i!==e||i&&typeof i=="object"||typeof i=="function"}h(Kt,"safe_not_equal");function Ui(i){return Object.keys(i).length===0}h(Ui,"is_empty");var Wi=typeof window!="undefined"?window:typeof globalThis!="undefined"?globalThis:global,os=class os{constructor(e){this.options=e,this._listeners="WeakMap"in Wi?new WeakMap:void 0}observe(e,n){return this._listeners.set(e,n),this._getObserver().observe(e,this.options),()=>{this._listeners.delete(e),this._observer.unobserve(e)}}_getObserver(){var e;return(e=this._observer)!==null&&e!==void 0?e:this._observer=new ResizeObserver(n=>{var s;for(let o of n)os.entries.set(o.target,o),(s=this._listeners.get(o.target))===null||s===void 0||s(o)})}};h(os,"ResizeObserverSingleton");var Ss=os;Ss.entries="WeakMap"in Wi?new WeakMap:void 0;var $i=!1;function Xa(){$i=!0}h(Xa,"start_hydrating");function Va(){$i=!1}h(Va,"end_hydrating");function l(i,e){i.appendChild(e)}h(l,"append");function Jt(i,e,n){let s=Ga(i);if(!s.getElementById(e)){let o=p("style");o.id=e,o.textContent=n,Ya(s,o)}}h(Jt,"append_styles");function Ga(i){if(!i)return document;let e=i.getRootNode?i.getRootNode():i.ownerDocument;return e&&e.host?e:i.ownerDocument}h(Ga,"get_root_for_style");function Ya(i,e){return l(i.head||i,e),e.sheet}h(Ya,"append_stylesheet");function X(i,e,n){i.insertBefore(e,n||null)}h(X,"insert");function $(i){i.parentNode&&i.parentNode.removeChild(i)}h($,"detach");function Ct(i,e){for(let n=0;n<i.length;n+=1)i[n]&&i[n].d(e)}h(Ct,"destroy_each");function p(i){return document.createElement(i)}h(p,"element");function Fn(i){return document.createElementNS("http://www.w3.org/2000/svg",i)}h(Fn,"svg_element");function U(i){return document.createTextNode(i)}h(U,"text");function w(){return U(" ")}h(w,"space");function Xi(){return U("")}h(Xi,"empty");function me(i,e,n,s){return i.addEventListener(e,n,s),()=>i.removeEventListener(e,n,s)}h(me,"listen");function d(i,e,n){n==null?i.removeAttribute(e):i.getAttribute(e)!==n&&i.setAttribute(e,n)}h(d,"attr");function jr(i){return i===""?null:+i}h(jr,"to_number");function Qa(i){return Array.from(i.childNodes)}h(Qa,"children");function re(i,e){e=""+e,i.data!==e&&(i.data=e)}h(re,"set_data");function Tn(i,e){i.value=e==null?"":e}h(Tn,"set_input_value");function Ie(i,e,n,s){n==null?i.style.removeProperty(e):i.style.setProperty(e,n,s?"important":"")}h(Ie,"set_style");function Rn(i,e,n){for(let s=0;s<i.options.length;s+=1){let o=i.options[s];if(o.__value===e){o.selected=!0;return}}(!n||e!==void 0)&&(i.selectedIndex=-1)}h(Rn,"select_option");function Hr(i){let e=i.querySelector(":checked");return e&&e.__value}h(Hr,"select_value");function Ee(i,e,n){i.classList[n?"add":"remove"](e)}h(Ee,"toggle_class");function Ka(i,e,{bubbles:n=!1,cancelable:s=!1}={}){let o=document.createEvent("CustomEvent");return o.initCustomEvent(i,n,s,e),o}h(Ka,"custom_event");var Pr;function zr(i){Pr=i}h(zr,"set_current_component");function Vi(){if(!Pr)throw new Error("Function called outside component initialization");return Pr}h(Vi,"get_current_component");function cn(i){Vi().$$.on_mount.push(i)}h(cn,"onMount");function Qn(){let i=Vi();return(e,n,{cancelable:s=!1}={})=>{let o=i.$$.callbacks[e];if(o){let a=Ka(e,n,{cancelable:s});return o.slice().forEach(u=>{u.call(i,a)}),!a.defaultPrevented}return!0}}h(Qn,"createEventDispatcher");var pr=[];var Pt=[],vr=[],Hi=[],Gi=Promise.resolve(),Es=!1;function Yi(){Es||(Es=!0,Gi.then(Qi))}h(Yi,"schedule_update");function ls(){return Yi(),Gi}h(ls,"tick");function Dn(i){vr.push(i)}h(Dn,"add_render_callback");var xs=new Set,hr=0;function Qi(){if(hr!==0)return;let i=Pr;do{try{for(;hr<pr.length;){let e=pr[hr];hr++,zr(e),Ja(e.$$)}}catch(e){throw pr.length=0,hr=0,e}for(zr(null),pr.length=0,hr=0;Pt.length;)Pt.pop()();for(let e=0;e<vr.length;e+=1){let n=vr[e];xs.has(n)||(xs.add(n),n())}vr.length=0}while(pr.length);for(;Hi.length;)Hi.pop()();Es=!1,xs.clear(),zr(i)}h(Qi,"flush");function Ja(i){if(i.fragment!==null){i.update(),Ke(i.before_update);let e=i.dirty;i.dirty=[-1],i.fragment&&i.fragment.p(i.ctx,e),i.after_update.forEach(Dn)}}h(Ja,"update");function Za(i){let e=[],n=[];vr.forEach(s=>i.indexOf(s)===-1?e.push(s):n.push(s)),n.forEach(s=>s()),vr=e}h(Za,"flush_render_callbacks");var as=new Set,Yn;function Ki(){Yn={r:0,c:[],p:Yn}}h(Ki,"group_outros");function Ji(){Yn.r||Ke(Yn.c),Yn=Yn.p}h(Ji,"check_outros");function Kn(i,e){i&&i.i&&(as.delete(i),i.i(e))}h(Kn,"transition_in");function mr(i,e,n,s){if(i&&i.o){if(as.has(i))return;as.add(i),Yn.c.push(()=>{as.delete(i),s&&(n&&i.d(1),s())}),i.o(e)}else s&&s()}h(mr,"transition_out");var eo=["allowfullscreen","allowpaymentrequest","async","autofocus","autoplay","checked","controls","default","defer","disabled","formnovalidate","hidden","inert","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected"],wl=new Set([...eo]);function cs(i){i&&i.c()}h(cs,"create_component");function Ur(i,e,n,s){let{fragment:o,after_update:a}=i.$$;o&&o.m(e,n),s||Dn(()=>{let u=i.$$.on_mount.map(Cs).filter(gr);i.$$.on_destroy?i.$$.on_destroy.push(...u):Ke(u),i.$$.on_mount=[]}),a.forEach(Dn)}h(Ur,"mount_component");function br(i,e){let n=i.$$;n.fragment!==null&&(Za(n.after_update),Ke(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}h(br,"destroy_component");function to(i,e){i.$$.dirty[0]===-1&&(pr.push(i),Yi(),i.$$.dirty.fill(0)),i.$$.dirty[e/31|0]|=1<<e%31}h(to,"make_dirty");function Zt(i,e,n,s,o,a,u,g=[-1]){let v=Pr;zr(i);let m=i.$$={fragment:null,ctx:[],props:a,update:ke,not_equal:o,bound:ji(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(v?v.$$.context:[])),callbacks:ji(),dirty:g,skip_bound:!1,root:e.target||v.$$.root};u&&u(m.root);let x=!1;if(m.ctx=n?n(i,e.props||{},(S,E,...C)=>{let _=C.length?C[0]:E;return m.ctx&&o(m.ctx[S],m.ctx[S]=_)&&(!m.skip_bound&&m.bound[S]&&m.bound[S](_),x&&to(i,S)),E}):[],m.update(),x=!0,Ke(m.before_update),m.fragment=s?s(m.ctx):!1,e.target){if(e.hydrate){Xa();let S=Qa(e.target);m.fragment&&m.fragment.l(S),S.forEach($)}else m.fragment&&m.fragment.c();e.intro&&Kn(i.$$.fragment),Ur(i,e.target,e.anchor,e.customElement),Va(),Qi()}zr(v)}h(Zt,"init");var no,Br;typeof HTMLElement=="function"&&(no=(Br=class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){let{on_mount:e}=this.$$;this.$$.on_disconnect=e.map(Cs).filter(gr);for(let n in this.$$.slotted)this.appendChild(this.$$.slotted[n])}attributeChangedCallback(e,n,s){this[e]=s}disconnectedCallback(){Ke(this.$$.on_disconnect)}$destroy(){br(this,1),this.$destroy=ke}$on(e,n){if(!gr(n))return ke;let s=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return s.push(n),()=>{let o=s.indexOf(n);o!==-1&&s.splice(o,1)}}$set(e){this.$$set&&!Ui(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}},h(Br,"SvelteElement"),Br));var Ds=class Ds{$destroy(){br(this,1),this.$destroy=ke}$on(e,n){if(!gr(n))return ke;let s=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return s.push(n),()=>{let o=s.indexOf(n);o!==-1&&s.splice(o,1)}}$set(e){this.$$set&&!Ui(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}};h(Ds,"SvelteComponent");var Et=Ds;function Dt(i,e,n,s){function o(a){return a instanceof n?a:new n(function(u){u(a)})}return h(o,"adopt"),new(n||(n=Promise))(function(a,u){function g(x){try{m(s.next(x))}catch(S){u(S)}}h(g,"fulfilled");function v(x){try{m(s.throw(x))}catch(S){u(S)}}h(v,"rejected");function m(x){x.done?a(x.value):o(x.value).then(g,v)}h(m,"step"),m((s=s.apply(i,e||[])).next())})}h(Dt,"__awaiter");function ro(i){Jt(i,"svelte-174z3rr",".heatmap-container.svelte-174z3rr.svelte-174z3rr{padding:16px;border-top:1px solid var(--background-modifier-border);background:var(--background-primary);display:flex;flex-direction:column;align-items:stretch}.heatmap-header.svelte-174z3rr.svelte-174z3rr{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;width:100%}.header-left.svelte-174z3rr.svelte-174z3rr{display:flex;flex-direction:column;align-items:flex-start}.year-navigation.svelte-174z3rr.svelte-174z3rr{display:flex;align-items:center;gap:8px}.nav-button.svelte-174z3rr.svelte-174z3rr{background:none;border:1px solid var(--background-modifier-border);border-radius:4px;padding:4px;cursor:pointer;color:var(--text-muted);transition:all 0.2s ease;display:flex;align-items:center;justify-content:center;width:24px;height:24px}.nav-button.svelte-174z3rr.svelte-174z3rr:hover{background:var(--background-modifier-hover);color:var(--text-normal);border-color:var(--text-muted)}.current-year.svelte-174z3rr.svelte-174z3rr{font-size:14px;font-weight:600;color:var(--text-normal);min-width:40px;text-align:center}.heatmap-header.svelte-174z3rr h4.svelte-174z3rr{margin:0;font-size:14px;font-weight:600;color:var(--text-normal)}.total-reviews.svelte-174z3rr.svelte-174z3rr{font-size:12px;color:var(--text-muted)}.loading.svelte-174z3rr.svelte-174z3rr{text-align:center;padding:20px;color:var(--text-muted);font-size:12px}.heatmap.svelte-174z3rr.svelte-174z3rr{position:relative;margin-top:12px;overflow-x:auto;overflow-y:hidden;max-width:100%;padding-bottom:8px;display:flex}.heatmap-content.svelte-174z3rr.svelte-174z3rr{position:relative;min-width:fit-content;width:max-content}.month-labels.svelte-174z3rr.svelte-174z3rr{position:relative;height:12px;margin-bottom:2px;margin-left:18px}.month-label.svelte-174z3rr.svelte-174z3rr{position:absolute;font-size:9px;color:var(--text-muted)}.day-labels.svelte-174z3rr.svelte-174z3rr{position:absolute;left:-18px;top:16px}.day-label.svelte-174z3rr.svelte-174z3rr{position:absolute;font-size:9px;color:var(--text-muted);width:16px;text-align:right}.heatmap-grid.svelte-174z3rr.svelte-174z3rr{display:flex;gap:2px;padding-right:16px}.week.svelte-174z3rr.svelte-174z3rr{display:flex;flex-direction:column;gap:2px}.day.svelte-174z3rr.svelte-174z3rr{width:10px;height:10px;border-radius:2px;cursor:pointer;transition:all 0.1s ease;flex-shrink:0}.day.svelte-174z3rr.svelte-174z3rr:hover{transform:scale(1.3);outline:1px solid var(--text-muted);z-index:10;position:relative}.day.today.svelte-174z3rr.svelte-174z3rr{outline:2px solid var(--interactive-accent);outline-offset:1px}.day.today.svelte-174z3rr.svelte-174z3rr:hover{outline:2px solid var(--interactive-accent);outline-offset:1px}.intensity-0.svelte-174z3rr.svelte-174z3rr{background-color:var(--background-modifier-border)}.intensity-1.svelte-174z3rr.svelte-174z3rr{background-color:#0e4429}.intensity-2.svelte-174z3rr.svelte-174z3rr{background-color:#006d32}.intensity-3.svelte-174z3rr.svelte-174z3rr{background-color:#26a641}.intensity-4.svelte-174z3rr.svelte-174z3rr{background-color:#39d353}.legend.svelte-174z3rr.svelte-174z3rr{display:flex;align-items:center;justify-content:center;gap:3px;margin-top:6px}.legend-label.svelte-174z3rr.svelte-174z3rr{font-size:8px;color:var(--text-muted)}.legend-colors.svelte-174z3rr.svelte-174z3rr{display:flex;gap:2px}.legend-square.svelte-174z3rr.svelte-174z3rr{width:10px;height:10px;border-radius:2px}.day.outside-year.svelte-174z3rr.svelte-174z3rr{opacity:0.3;pointer-events:none}.heatmap.svelte-174z3rr.svelte-174z3rr::-webkit-scrollbar{height:8px}.heatmap.svelte-174z3rr.svelte-174z3rr::-webkit-scrollbar-track{background:var(--background-primary);border-radius:4px}.heatmap.svelte-174z3rr.svelte-174z3rr::-webkit-scrollbar-thumb{background:var(--background-modifier-border);border-radius:4px}.heatmap.svelte-174z3rr.svelte-174z3rr::-webkit-scrollbar-thumb:hover{background:var(--text-muted)}")}h(ro,"add_css");function Zi(i,e,n){let s=i.slice();return s[20]=e[n],s}h(Zi,"get_each_context");function ea(i,e,n){let s=i.slice();s[23]=e[n];let o=new Date(s[23].date).getFullYear();return s[24]=o,s}h(ea,"get_each_context_1");function ta(i,e,n){let s=i.slice();return s[27]=e[n].month,s[28]=e[n].offset,s}h(ta,"get_each_context_2");function na(i){let e,n=Array.from(i[0].values()).reduce(la,0)+"",s,o;return{c(){e=p("span"),s=U(n),o=U(" reviews"),d(e,"class","total-reviews svelte-174z3rr")},m(a,u){X(a,e,u),l(e,s),l(e,o)},p(a,u){u&1&&n!==(n=Array.from(a[0].values()).reduce(la,0)+"")&&re(s,n)},d(a){a&&$(e)}}}h(na,"create_if_block_1");function so(i){let e,n,s,o,a,u,g,v,m,x=i[6](),S=[];for(let _=0;_<x.length;_+=1)S[_]=ra(ta(i,x,_));let E=i[1],C=[];for(let _=0;_<E.length;_+=1)C[_]=ia(Zi(i,E,_));return{c(){e=p("div"),n=p("div"),s=p("div");for(let _=0;_<S.length;_+=1)S[_].c();o=w(),a=p("div"),a.innerHTML=`<span class="day-label svelte-174z3rr" style="top: 0px">S</span> 
                    <span class="day-label svelte-174z3rr" style="top: 18px">T</span> 
                    <span class="day-label svelte-174z3rr" style="top: 36px">T</span> 
                    <span class="day-label svelte-174z3rr" style="top: 54px">S</span>`,u=w(),g=p("div");for(let _=0;_<C.length;_+=1)C[_].c();v=w(),m=p("div"),m.innerHTML=`<span class="legend-label svelte-174z3rr">Less</span> 
            <div class="legend-colors svelte-174z3rr"><div class="legend-square intensity-0 svelte-174z3rr"></div> 
                <div class="legend-square intensity-1 svelte-174z3rr"></div> 
                <div class="legend-square intensity-2 svelte-174z3rr"></div> 
                <div class="legend-square intensity-3 svelte-174z3rr"></div> 
                <div class="legend-square intensity-4 svelte-174z3rr"></div></div> 
            <span class="legend-label svelte-174z3rr">More</span>`,d(s,"class","month-labels svelte-174z3rr"),d(a,"class","day-labels svelte-174z3rr"),d(g,"class","heatmap-grid svelte-174z3rr"),d(n,"class","heatmap-content svelte-174z3rr"),d(e,"class","heatmap svelte-174z3rr"),d(m,"class","legend svelte-174z3rr")},m(_,O){X(_,e,O),l(e,n),l(n,s);for(let D=0;D<S.length;D+=1)S[D]&&S[D].m(s,null);l(n,o),l(n,a),l(n,u),l(n,g);for(let D=0;D<C.length;D+=1)C[D]&&C[D].m(g,null);X(_,v,O),X(_,m,O)},p(_,O){if(O&64){x=_[6]();let D;for(D=0;D<x.length;D+=1){let M=ta(_,x,D);S[D]?S[D].p(M,O):(S[D]=ra(M),S[D].c(),S[D].m(s,null))}for(;D<S.length;D+=1)S[D].d(1);S.length=x.length}if(O&50){E=_[1];let D;for(D=0;D<E.length;D+=1){let M=Zi(_,E,D);C[D]?C[D].p(M,O):(C[D]=ia(M),C[D].c(),C[D].m(g,null))}for(;D<C.length;D+=1)C[D].d(1);C.length=E.length}},d(_){_&&$(e),Ct(S,_),Ct(C,_),_&&$(v),_&&$(m)}}}h(so,"create_else_block");function io(i){let e;return{c(){e=p("div"),e.textContent="Loading...",d(e,"class","loading svelte-174z3rr")},m(n,s){X(n,e,s)},p:ke,d(n){n&&$(e)}}}h(io,"create_if_block");function ra(i){let e,n=i[27]+"",s;return{c(){e=p("span"),s=U(n),d(e,"class","month-label svelte-174z3rr"),Ie(e,"left",i[28]+"px")},m(o,a){X(o,e,a),l(e,s)},p:ke,d(o){o&&$(e)}}}h(ra,"create_each_block_2");function sa(i){let e,n,s;return{c(){e=p("div"),d(e,"class",n="day "+i[5](i[23].count)+" svelte-174z3rr"),d(e,"title",s=i[23].count+" reviews on "+aa(i[23].date)),Ee(e,"today",oa(i[23].date)),Ee(e,"outside-year",i[24]!==i[4])},m(o,a){X(o,e,a)},p(o,a){a&2&&n!==(n="day "+o[5](o[23].count)+" svelte-174z3rr")&&d(e,"class",n),a&2&&s!==(s=o[23].count+" reviews on "+aa(o[23].date))&&d(e,"title",s),a&2&&Ee(e,"today",oa(o[23].date)),a&18&&Ee(e,"outside-year",o[24]!==o[4])},d(o){o&&$(e)}}}h(sa,"create_each_block_1");function ia(i){let e,n,s=i[20],o=[];for(let a=0;a<s.length;a+=1)o[a]=sa(ea(i,s,a));return{c(){e=p("div");for(let a=0;a<o.length;a+=1)o[a].c();n=w(),d(e,"class","week svelte-174z3rr")},m(a,u){X(a,e,u);for(let g=0;g<o.length;g+=1)o[g]&&o[g].m(e,null);l(e,n)},p(a,u){if(u&50){s=a[20];let g;for(g=0;g<s.length;g+=1){let v=ea(a,s,g);o[g]?o[g].p(v,u):(o[g]=sa(v),o[g].c(),o[g].m(e,n))}for(;g<o.length;g+=1)o[g].d(1);o.length=s.length}},d(a){a&&$(e),Ct(o,a)}}}h(ia,"create_each_block");function ao(i){let e,n,s,o,a,u,g,v,m,x,S,E,C,_,O,D,M=!i[2]&&na(i);function N(W,L){return W[2]?io:so}h(N,"select_block_type");let I=N(i,-1),z=I(i);return{c(){e=p("div"),n=p("div"),s=p("div"),o=p("h4"),o.textContent="Review Activity",a=w(),M&&M.c(),u=w(),g=p("div"),v=p("button"),v.innerHTML='<svg width="12" height="12" viewBox="0 0 24 24" fill="currentColor"><path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"></path></svg>',m=w(),x=p("span"),S=U(i[4]),E=w(),C=p("button"),C.innerHTML='<svg width="12" height="12" viewBox="0 0 24 24" fill="currentColor"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg>',_=w(),z.c(),d(o,"class","svelte-174z3rr"),d(s,"class","header-left svelte-174z3rr"),d(v,"class","nav-button svelte-174z3rr"),d(x,"class","current-year svelte-174z3rr"),d(C,"class","nav-button svelte-174z3rr"),d(g,"class","year-navigation svelte-174z3rr"),d(n,"class","heatmap-header svelte-174z3rr"),d(e,"class","heatmap-container svelte-174z3rr")},m(W,L){X(W,e,L),l(e,n),l(n,s),l(s,o),l(s,a),M&&M.m(s,null),l(n,u),l(n,g),l(g,v),l(g,m),l(g,x),l(x,S),l(g,E),l(g,C),l(e,_),z.m(e,null),i[14](e),O||(D=[me(v,"click",i[12]),me(C,"click",i[13])],O=!0)},p(W,[L]){W[2]?M&&(M.d(1),M=null):M?M.p(W,L):(M=na(W),M.c(),M.m(s,null)),L&16&&re(S,W[4]),I===(I=N(W,L))&&z?z.p(W,L):(z.d(1),z=I(W),z&&(z.c(),z.m(e,null)))},i:ke,o:ke,d(W){W&&$(e),M&&M.d(),z.d(),i[14](null),O=!1,Ke(D)}}}h(ao,"create_fragment");function aa(i){return new Date(i).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}h(aa,"formatDate");function oa(i){let e=new Date().toISOString().split("T")[0];return i===e}h(oa,"isToday");function oo(i){if(i===0)return 20;let e=i-50,s=Math.floor(e/12);return Math.min(Math.max(s,8),52)}h(oo,"calculateMaxWeeks");var la=h((i,e)=>i+e,"func");function lo(i,e,n){let{getReviewCounts:s}=e,o=new Map,a=[],u=[],g=0,v=!0,m,x=52,S=0,E=new Date().getFullYear(),C=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function _(){let T=new Date(E,0,1),P=new Date(E,11,31),A=new Date(T),H=A.getDay();A.setDate(A.getDate()-H);let J=new Date(P),ee=J.getDay();J.setDate(J.getDate()+(6-ee));let Z=[],ie=new Date(A);for(;ie<=J;){let V=ie.toISOString().split("T")[0];if(ie.getFullYear()===E){let Q=o.get(V)||0;Z.push({date:V,count:Q,dayOfWeek:ie.getDay()}),Q>g&&(g=Q)}else Z.push({date:V,count:0,dayOfWeek:ie.getDay()});ie.setDate(ie.getDate()+1)}a=Z,n(1,u=[]);for(let V=0;V<a.length;V+=7)u.push(a.slice(V,V+7))}h(_,"generateDays");function O(T){return T===0?"intensity-0":`intensity-${Math.min(Math.ceil(T/g*4),4)}`}h(O,"getIntensityClass");function D(){if(u.length===0)return[];let T=[],P=-1;return u.forEach((A,H)=>{let J=A[0];if(J){let ee=new Date(J.date),Z=ee.getMonth();ee.getFullYear()===E&&Z!==P&&(P=Z,T.push({month:C[Z],offset:H*12}))}}),T}h(D,"getMonthLabels");function M(){m&&n(11,S=m.clientWidth)}h(M,"updateContainerWidth");function N(T){T==="prev"?n(4,E--,E):n(4,E++,E),I()}h(N,"navigateYear");function I(){return Dt(this,void 0,void 0,function*(){n(2,v=!0);try{n(0,o=yield s(366)),g=0,_()}catch(T){console.error("Failed to load review counts:",T)}finally{n(2,v=!1)}})}h(I,"refresh"),cn(()=>{setTimeout(()=>{M(),I()},100)});let z=h(()=>N("prev"),"click_handler"),W=h(()=>N("next"),"click_handler_1");function L(T){Pt[T?"unshift":"push"](()=>{m=T,n(3,m)})}return h(L,"div3_binding"),i.$$set=T=>{"getReviewCounts"in T&&n(8,s=T.getReviewCounts)},i.$$.update=()=>{if(i.$$.dirty&3072&&S>0){let T=oo(S);T!==x&&(n(10,x=T),I())}},[o,u,v,m,E,O,D,N,s,I,x,S,z,W,L]}h(lo,"instance");var Ts=class Ts extends Et{constructor(e){super(),Zt(this,e,lo,ao,Kt,{getReviewCounts:8,refresh:9},ro)}get refresh(){return this.$$.ctx[9]}};h(Ts,"ReviewHeatmap");var Fs=Ts,ds=Fs;var da=require("obsidian");function co(i){Jt(i,"svelte-8i91g7",'.deck-config-ui.svelte-8i91g7.svelte-8i91g7{padding:0}.deck-info-section.svelte-8i91g7.svelte-8i91g7{margin-bottom:24px;padding:16px;background:var(--background-secondary);border-radius:6px;border:1px solid var(--background-modifier-border)}.deck-info-section.svelte-8i91g7 h3.svelte-8i91g7{margin:0 0 12px 0;font-size:1.1em;color:var(--text-normal);font-weight:600}.deck-info-list.svelte-8i91g7.svelte-8i91g7{margin:0;padding:0;list-style:none}.deck-info-list.svelte-8i91g7 li.svelte-8i91g7{margin:0 0 8px 0;font-size:0.9em;color:var(--text-muted)}.deck-info-list.svelte-8i91g7 li.svelte-8i91g7:last-child{margin-bottom:0}.deck-info-list.svelte-8i91g7 strong.svelte-8i91g7{color:var(--text-normal)}.deck-settings-section.svelte-8i91g7.svelte-8i91g7{margin-bottom:24px}.deck-settings-section.svelte-8i91g7 h3.svelte-8i91g7{margin:0 0 16px 0;font-size:1.1em;color:var(--text-normal);font-weight:600}.setting-item-description-global.svelte-8i91g7.svelte-8i91g7{font-size:0.8em;color:var(--text-muted);line-height:1.4;margin-bottom:20px;padding:12px;background:var(--background-secondary);border-radius:4px;border-left:3px solid var(--interactive-accent)}.setting-item.svelte-8i91g7.svelte-8i91g7{display:flex;align-items:flex-start;justify-content:space-between;margin-bottom:20px;padding:12px 0}.setting-item.svelte-8i91g7.svelte-8i91g7:last-child{border-bottom:none;margin-bottom:0}.setting-item.disabled.svelte-8i91g7.svelte-8i91g7{opacity:0.5}.setting-item-info.svelte-8i91g7.svelte-8i91g7{flex:1;margin-right:16px}.setting-item-name.svelte-8i91g7.svelte-8i91g7{font-weight:500;color:var(--text-normal);margin-bottom:4px;font-size:0.9em}.setting-item-description.svelte-8i91g7.svelte-8i91g7{font-size:0.8em;color:var(--text-muted);line-height:1.4}.setting-item-control.svelte-8i91g7.svelte-8i91g7{flex-shrink:0}.checkbox-container.svelte-8i91g7.svelte-8i91g7{position:relative;display:inline-block;cursor:pointer}.checkbox-input.svelte-8i91g7.svelte-8i91g7{position:absolute;opacity:0;cursor:pointer}.checkbox-slider.svelte-8i91g7.svelte-8i91g7{width:42px;height:24px;background:var(--background-modifier-border);border-radius:12px;position:relative;transition:background-color 0.2s ease}.checkbox-slider.svelte-8i91g7.svelte-8i91g7::before{content:"";position:absolute;width:18px;height:18px;border-radius:50%;background:white;top:3px;left:3px;transition:transform 0.2s ease}.checkbox-container.svelte-8i91g7.svelte-8i91g7::after{display:none !important}.checkbox-input.svelte-8i91g7:checked+.checkbox-slider.svelte-8i91g7{background:var(--interactive-accent)}.checkbox-input.svelte-8i91g7:checked+.checkbox-slider.svelte-8i91g7::before{transform:translateX(18px)}.session-limit-input.svelte-8i91g7.svelte-8i91g7{width:80px;padding:6px 8px;border:1px solid var(--background-modifier-border);border-radius:4px;background:var(--background-primary);color:var(--text-normal);font-size:0.9em}.session-limit-input.svelte-8i91g7.svelte-8i91g7:focus{outline:none;border-color:var(--interactive-accent);box-shadow:0 0 0 2px var(--interactive-accent-hover)}.session-limit-input.svelte-8i91g7.svelte-8i91g7:disabled{opacity:0.5;cursor:not-allowed;background:var(--background-modifier-border-hover)}.review-order-select.svelte-8i91g7.svelte-8i91g7{padding:6px 8px;border:1px solid var(--background-modifier-border);border-radius:4px;background:var(--background-primary);color:var(--text-normal);font-size:0.9em;min-width:140px}.review-order-select.svelte-8i91g7.svelte-8i91g7:focus{outline:none;border-color:var(--interactive-accent);box-shadow:0 0 0 2px var(--interactive-accent-hover)}.modal-footer.svelte-8i91g7.svelte-8i91g7{display:flex;align-items:center;justify-content:flex-end;gap:12px;margin-top:24px;padding-top:16px;border-top:1px solid var(--background-modifier-border)}.modal-footer.svelte-8i91g7 button.svelte-8i91g7{padding:8px 16px;border-radius:4px;border:1px solid var(--background-modifier-border);background:var(--background-primary);color:var(--text-normal);cursor:pointer;font-size:0.9em;transition:all 0.2s ease}.modal-footer.svelte-8i91g7 button.svelte-8i91g7:hover:not(:disabled){background:var(--background-modifier-hover)}.modal-footer.svelte-8i91g7 button.svelte-8i91g7:disabled{opacity:0.5;cursor:not-allowed}.modal-footer.svelte-8i91g7 button.mod-cta.svelte-8i91g7{background:var(--interactive-accent);color:var(--text-on-accent);border-color:var(--interactive-accent)}.modal-footer.svelte-8i91g7 button.mod-cta.svelte-8i91g7:hover:not(:disabled){background:var(--interactive-accent-hover);border-color:var(--interactive-accent-hover)}.modal-footer.svelte-8i91g7 button.svelte-8i91g7:focus{outline:2px solid var(--interactive-accent);outline-offset:2px}')}h(co,"add_css");function uo(i){let e,n,s,o,a,u,g,v,m=i[0].name+"",x,S,E,C,_,O=i[0].tag+"",D,M,N,I,z,W=i[0].filepath+"",L,T,P,A,H,J,ee,Z,ie,V,G,Q,B,te,ce,Me,ve,Y,be,K,fe,at,qe,Ne,Fe,ot,ye,pe,De,Ft,Tt,Rt,ut,mt,Ln,nt,Le,ze,tn,bt,wt,dn,rt,Ze,ue,ft,Te,lt,Ve,Bt=i[6]?"Saving...":"Save",Ge,un,ct,jt,j,fn;return{c(){e=p("div"),n=p("div"),s=p("h3"),s.textContent="Deck Information",o=w(),a=p("ul"),u=p("li"),g=p("strong"),g.textContent="Name:",v=w(),x=U(m),S=w(),E=p("li"),C=p("strong"),C.textContent="Tag:",_=w(),D=U(O),M=w(),N=p("li"),I=p("strong"),I.textContent="File:",z=w(),L=U(W),T=w(),P=p("div"),A=p("h3"),A.textContent="Daily Card Limits",H=w(),J=p("div"),J.textContent=`Learning/relearning cards are always shown and not subject to these
            limits.`,ee=w(),Z=p("div"),ie=p("div"),ie.innerHTML=`<div class="setting-item-name svelte-8i91g7">Enable New Cards Limit</div> 
                <div class="setting-item-description svelte-8i91g7">Limit how many new cards (never seen before) can be shown
                    per day</div>`,V=w(),G=p("div"),Q=p("label"),B=p("input"),te=w(),ce=p("div"),Me=w(),ve=p("div"),Y=p("div"),Y.innerHTML=`<div class="setting-item-name svelte-8i91g7">New Cards per Day</div> 
                <div class="setting-item-description svelte-8i91g7">Maximum number of new cards to introduce per day</div>`,be=w(),K=p("div"),fe=p("input"),qe=w(),Ne=p("div"),Fe=p("div"),Fe.innerHTML=`<div class="setting-item-name svelte-8i91g7">Enable Review Cards Limit</div> 
                <div class="setting-item-description svelte-8i91g7">Limit how many review cards (due for repetition) can be
                    shown per day</div>`,ot=w(),ye=p("div"),pe=p("label"),De=p("input"),Ft=w(),Tt=p("div"),Rt=w(),ut=p("div"),mt=p("div"),mt.innerHTML=`<div class="setting-item-name svelte-8i91g7">Review Cards per Day</div> 
                <div class="setting-item-description svelte-8i91g7">Maximum number of review cards to show per day</div>`,Ln=w(),nt=p("div"),Le=p("input"),tn=w(),bt=p("div"),wt=p("div"),wt.innerHTML=`<div class="setting-item-name svelte-8i91g7">Review Order</div> 
                <div class="setting-item-description svelte-8i91g7">Order in which review cards are presented during study</div>`,dn=w(),rt=p("div"),Ze=p("select"),ue=p("option"),ue.textContent="Oldest due first",ft=p("option"),ft.textContent="Random order",Te=w(),lt=p("div"),Ve=p("button"),Ge=U(Bt),un=w(),ct=p("button"),jt=U("Cancel"),d(s,"class","svelte-8i91g7"),d(g,"class","svelte-8i91g7"),d(u,"class","svelte-8i91g7"),d(C,"class","svelte-8i91g7"),d(E,"class","svelte-8i91g7"),d(I,"class","svelte-8i91g7"),d(N,"class","svelte-8i91g7"),d(a,"class","deck-info-list svelte-8i91g7"),d(n,"class","deck-info-section svelte-8i91g7"),d(A,"class","svelte-8i91g7"),d(J,"class","setting-item-description-global svelte-8i91g7"),d(ie,"class","setting-item-info svelte-8i91g7"),d(B,"type","checkbox"),d(B,"class","checkbox-input svelte-8i91g7"),d(ce,"class","checkbox-slider svelte-8i91g7"),d(Q,"class","checkbox-container svelte-8i91g7"),d(G,"class","setting-item-control svelte-8i91g7"),d(Z,"class","setting-item svelte-8i91g7"),d(Y,"class","setting-item-info svelte-8i91g7"),d(fe,"type","number"),d(fe,"min","0"),d(fe,"max","999"),fe.disabled=at=!i[3],d(fe,"class","session-limit-input svelte-8i91g7"),d(fe,"placeholder","20"),d(K,"class","setting-item-control svelte-8i91g7"),d(ve,"class","setting-item svelte-8i91g7"),Ee(ve,"disabled",!i[3]),d(Fe,"class","setting-item-info svelte-8i91g7"),d(De,"type","checkbox"),d(De,"class","checkbox-input svelte-8i91g7"),d(Tt,"class","checkbox-slider svelte-8i91g7"),d(pe,"class","checkbox-container svelte-8i91g7"),d(ye,"class","setting-item-control svelte-8i91g7"),d(Ne,"class","setting-item svelte-8i91g7"),d(mt,"class","setting-item-info svelte-8i91g7"),d(Le,"type","number"),d(Le,"min","0"),d(Le,"max","9999"),Le.disabled=ze=!i[4],d(Le,"class","session-limit-input svelte-8i91g7"),d(Le,"placeholder","100"),d(nt,"class","setting-item-control svelte-8i91g7"),d(ut,"class","setting-item svelte-8i91g7"),Ee(ut,"disabled",!i[4]),d(wt,"class","setting-item-info svelte-8i91g7"),ue.__value="due-date",ue.value=ue.__value,ft.__value="random",ft.value=ft.__value,d(Ze,"class","review-order-select svelte-8i91g7"),i[5]===void 0&&Dn(()=>i[15].call(Ze)),d(rt,"class","setting-item-control svelte-8i91g7"),d(bt,"class","setting-item svelte-8i91g7"),d(P,"class","deck-settings-section svelte-8i91g7"),d(Ve,"class","mod-cta svelte-8i91g7"),Ve.disabled=i[6],ct.disabled=i[6],d(ct,"class","svelte-8i91g7"),d(lt,"class","modal-footer svelte-8i91g7"),d(e,"class","deck-config-ui svelte-8i91g7")},m(we,_e){X(we,e,_e),l(e,n),l(n,s),l(n,o),l(n,a),l(a,u),l(u,g),l(u,v),l(u,x),l(a,S),l(a,E),l(E,C),l(E,_),l(E,D),l(a,M),l(a,N),l(N,I),l(N,z),l(N,L),l(e,T),l(e,P),l(P,A),l(P,H),l(P,J),l(P,ee),l(P,Z),l(Z,ie),l(Z,V),l(Z,G),l(G,Q),l(Q,B),B.checked=i[3],l(Q,te),l(Q,ce),l(P,Me),l(P,ve),l(ve,Y),l(ve,be),l(ve,K),l(K,fe),Tn(fe,i[1]),l(P,qe),l(P,Ne),l(Ne,Fe),l(Ne,ot),l(Ne,ye),l(ye,pe),l(pe,De),De.checked=i[4],l(pe,Ft),l(pe,Tt),l(P,Rt),l(P,ut),l(ut,mt),l(ut,Ln),l(ut,nt),l(nt,Le),Tn(Le,i[2]),l(P,tn),l(P,bt),l(bt,wt),l(bt,dn),l(bt,rt),l(rt,Ze),l(Ze,ue),l(Ze,ft),Rn(Ze,i[5],!0),l(e,Te),l(e,lt),l(lt,Ve),l(Ve,Ge),l(lt,un),l(lt,ct),l(ct,jt),j||(fn=[me(window,"keydown",i[9]),me(B,"change",i[11]),me(fe,"input",i[12]),me(De,"change",i[13]),me(Le,"input",i[14]),me(Ze,"change",i[15]),me(Ve,"click",i[7]),me(ct,"click",i[8])],j=!0)},p(we,[_e]){_e&1&&m!==(m=we[0].name+"")&&re(x,m),_e&1&&O!==(O=we[0].tag+"")&&re(D,O),_e&1&&W!==(W=we[0].filepath+"")&&re(L,W),_e&8&&(B.checked=we[3]),_e&8&&at!==(at=!we[3])&&(fe.disabled=at),_e&2&&jr(fe.value)!==we[1]&&Tn(fe,we[1]),_e&8&&Ee(ve,"disabled",!we[3]),_e&16&&(De.checked=we[4]),_e&16&&ze!==(ze=!we[4])&&(Le.disabled=ze),_e&4&&jr(Le.value)!==we[2]&&Tn(Le,we[2]),_e&16&&Ee(ut,"disabled",!we[4]),_e&32&&Rn(Ze,we[5]),_e&64&&Bt!==(Bt=we[6]?"Saving...":"Save")&&re(Ge,Bt),_e&64&&(Ve.disabled=we[6]),_e&64&&(ct.disabled=we[6])},i:ke,o:ke,d(we){we&&$(e),j=!1,Ke(fn)}}}h(uo,"create_fragment");function fo(i,e,n){let{deck:s}=e,{config:o}=e,a=Qn(),u=o.newCardsLimit,g=o.reviewCardsLimit,v=o.enableNewCardsLimit,m=o.enableReviewCardsLimit,x=o.reviewOrder,S=!1;function E(){n(6,S=!0);let z={newCardsLimit:Number(u)||0,reviewCardsLimit:Number(g)||0,enableNewCardsLimit:v,enableReviewCardsLimit:m,reviewOrder:x};a("save",z)}h(E,"handleSave");function C(){a("cancel")}h(C,"handleCancel");function _(z){z.key==="Enter"&&(z.ctrlKey||z.metaKey)&&E()}h(_,"handleKeydown");function O(){v=this.checked,n(3,v)}h(O,"input0_change_handler");function D(){u=jr(this.value),n(1,u)}h(D,"input1_input_handler");function M(){m=this.checked,n(4,m)}h(M,"input2_change_handler");function N(){g=jr(this.value),n(2,g)}h(N,"input3_input_handler");function I(){x=Hr(this),n(5,x)}return h(I,"select_change_handler"),i.$$set=z=>{"deck"in z&&n(0,s=z.deck),"config"in z&&n(10,o=z.config)},i.$$.update=()=>{if(i.$$.dirty&62){let z={newCardsLimit:Number(u)||0,reviewCardsLimit:Number(g)||0,enableNewCardsLimit:v,enableReviewCardsLimit:m,reviewOrder:x};a("configChange",z)}},[s,u,g,v,m,x,S,E,C,_,o,O,D,M,N,I]}h(fo,"instance");var Ls=class Ls extends Et{constructor(e){super(),Zt(this,e,fo,uo,Kt,{deck:0,config:10},co)}};h(Ls,"DeckConfigUI");var Rs=Ls,ca=Rs;var qs=class qs extends da.Modal{constructor(n,s,o){super(n.app);this.component=null;this.plugin=n,this.deck=s,this.onSave=o,this.config={...s.config}}onOpen(){let{contentEl:n}=this;n.empty(),n.createEl("h2",{text:`Configure Deck: ${this.deck.name}`});let s=n.createDiv("deck-config-container");s.style.padding="0",s.style.margin="0",this.component=new ca({target:s,props:{deck:this.deck,config:this.config}}),this.component.$on("save",o=>{this.handleSave(o.detail)}),this.component.$on("cancel",()=>{this.close()}),this.component.$on("configChange",o=>{this.config=o.detail})}async handleSave(n){try{await this.onSave(n),this.close()}catch(s){console.error("Error saving deck configuration:",s)}}onClose(){let{contentEl:n}=this;this.component&&(this.component.$destroy(),this.component=null),n.empty()}};h(qs,"DeckConfigModal");var us=qs;function ho(i){Jt(i,"svelte-oasr8b",".deck-list-panel.svelte-oasr8b.svelte-oasr8b{min-width:479px;height:100%;display:flex;flex-direction:column;background:var(--background-primary);color:var(--text-normal)}.panel-header.svelte-oasr8b.svelte-oasr8b{display:flex;justify-content:space-between;align-items:center;padding:12px 16px;border-bottom:1px solid var(--background-modifier-border)}.header-buttons.svelte-oasr8b.svelte-oasr8b{display:flex;gap:8px;align-items:center}.filter-section.svelte-oasr8b.svelte-oasr8b{margin-bottom:16px}.filter-container.svelte-oasr8b.svelte-oasr8b{position:relative}.filter-input.svelte-oasr8b.svelte-oasr8b{width:100%;padding:8px 12px;border:1px solid var(--background-modifier-border);border-radius:4px;background:var(--background-primary);color:var(--text-normal);font-size:14px}.suggestions-dropdown.svelte-oasr8b.svelte-oasr8b{position:absolute;top:100%;left:0;right:0;background:var(--background-primary);border:1px solid var(--background-modifier-border);border-top:none;border-radius:0 0 4px 4px;box-shadow:0 2px 8px rgba(0, 0, 0, 0.1);z-index:1000;max-height:200px;overflow-y:auto}.suggestions-header.svelte-oasr8b.svelte-oasr8b{padding:8px 12px;font-size:12px;color:var(--text-muted);border-bottom:1px solid var(--background-modifier-border);background:var(--background-secondary)}.suggestion-item.svelte-oasr8b.svelte-oasr8b{display:block;width:100%;padding:8px 12px;border:none;background:transparent;color:var(--text-normal);text-align:left;font-size:14px;cursor:pointer;transition:background-color 0.1s ease}.suggestion-item.svelte-oasr8b.svelte-oasr8b:hover{background:var(--background-modifier-hover)}.filter-input.svelte-oasr8b.svelte-oasr8b:focus{outline:none;border-color:var(--interactive-accent)}.filter-input.svelte-oasr8b.svelte-oasr8b::placeholder{color:var(--text-muted)}.panel-title.svelte-oasr8b.svelte-oasr8b{margin:0;font-size:16px;font-weight:600}.stats-button.svelte-oasr8b.svelte-oasr8b{padding:6px;background:var(--interactive-normal);border:none;border-radius:4px;cursor:pointer;color:var(--text-muted);transition:all 0.2s ease}.stats-button.svelte-oasr8b.svelte-oasr8b:hover{background:var(--interactive-hover);color:var(--text-normal)}.refresh-button.svelte-oasr8b.svelte-oasr8b{background:none;border:none;cursor:pointer;padding:4px;border-radius:4px;color:var(--text-muted);transition:all 0.2s ease;position:relative;z-index:1}.refresh-button.svelte-oasr8b.svelte-oasr8b:hover{background:var(--background-modifier-hover);color:var(--text-normal)}.refresh-button.svelte-oasr8b.svelte-oasr8b:disabled{opacity:0.5;cursor:not-allowed}.refresh-button.refreshing.svelte-oasr8b svg.svelte-oasr8b{animation:svelte-oasr8b-spin 1s linear infinite}@keyframes svelte-oasr8b-spin{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}.empty-state.svelte-oasr8b.svelte-oasr8b{flex:1;display:flex;flex-direction:column;justify-content:center;align-items:center;padding:32px;text-align:center}.empty-state.svelte-oasr8b p.svelte-oasr8b{margin:8px 0}.help-text.svelte-oasr8b.svelte-oasr8b{font-size:14px;color:var(--text-muted)}.deck-table.svelte-oasr8b.svelte-oasr8b{flex:1;display:flex;flex-direction:column;overflow:hidden}.table-header.svelte-oasr8b.svelte-oasr8b{display:grid;grid-template-columns:1fr 60px 60px 60px 40px;gap:8px;padding:8px 16px;font-weight:600;font-size:14px;border-bottom:1px solid var(--background-modifier-border);background:var(--background-secondary);align-items:center}.table-body.svelte-oasr8b.svelte-oasr8b{flex:1;overflow-y:auto}.deck-row.svelte-oasr8b.svelte-oasr8b{display:grid;grid-template-columns:1fr 60px 60px 60px 40px;gap:8px;padding:12px 16px;border-bottom:1px solid var(--background-modifier-border);align-items:center}.deck-name-link.svelte-oasr8b.svelte-oasr8b{cursor:pointer;color:var(--text-normal);text-decoration:underline;text-decoration-color:transparent;transition:text-decoration-color 0.2s ease;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;display:inline-block;max-width:250px}.deck-name-link.svelte-oasr8b.svelte-oasr8b:hover{text-decoration-color:var(--text-accent);color:var(--text-accent)}.deck-name-link.svelte-oasr8b.svelte-oasr8b:focus{outline:2px solid var(--interactive-accent);outline-offset:2px;border-radius:3px}.col-config.svelte-oasr8b.svelte-oasr8b{display:flex;align-items:center;justify-content:center}.deck-config-button.svelte-oasr8b.svelte-oasr8b{background:transparent;border:none;color:var(--text-muted);cursor:pointer;padding:6px;border-radius:3px;display:flex;align-items:center;justify-content:center;transition:all 0.2s ease}.deck-config-button.svelte-oasr8b.svelte-oasr8b:hover{background:var(--background-modifier-hover);color:var(--text-normal)}.deck-config-button.svelte-oasr8b.svelte-oasr8b:focus{outline:2px solid var(--interactive-accent);outline-offset:2px}.col-deck.svelte-oasr8b.svelte-oasr8b{font-size:14px;color:var(--text-normal);justify-self:start;min-width:0}.col-stat.svelte-oasr8b.svelte-oasr8b{text-align:center;font-size:14px;color:var(--text-muted);justify-self:center}.table-header.svelte-oasr8b .col-deck.svelte-oasr8b{font-size:14px;color:var(--text-normal);justify-self:start}.table-header.svelte-oasr8b .col-stat.svelte-oasr8b{text-align:center;font-size:14px;color:var(--text-normal);justify-self:center}.col-stat.has-cards.svelte-oasr8b.svelte-oasr8b{color:#4aa3df;font-weight:500}.col-stat.updating.svelte-oasr8b.svelte-oasr8b{opacity:0.6;transition:opacity 0.3s ease}.col-stat.has-limit.svelte-oasr8b.svelte-oasr8b{position:relative;border-left:2px solid var(--interactive-accent);padding-left:6px}.limit-indicator.svelte-oasr8b.svelte-oasr8b{font-size:10px;margin-left:4px;opacity:0.7}.table-body.svelte-oasr8b.svelte-oasr8b::-webkit-scrollbar{width:8px}.table-body.svelte-oasr8b.svelte-oasr8b::-webkit-scrollbar-track{background:transparent}.table-body.svelte-oasr8b.svelte-oasr8b::-webkit-scrollbar-thumb{background:var(--background-modifier-border);border-radius:4px}.table-body.svelte-oasr8b.svelte-oasr8b::-webkit-scrollbar-thumb:hover{background:var(--background-modifier-border-hover)}")}h(ho,"add_css");function ua(i,e,n){let s=i.slice();s[38]=e[n];let o=s[13](s[38].id);return s[12]=o,s}h(ua,"get_each_context");function fa(i,e,n){let s=i.slice();return s[41]=e[n],s}h(fa,"get_each_context_2");function ha(i,e,n){let s=i.slice();return s[41]=e[n],s}h(ha,"get_each_context_1");function po(i){let e,n,s,o=i[7].slice(0,5),a=[];for(let u=0;u<o.length;u+=1)a[u]=pa(fa(i,o,u));return{c(){e=p("div"),n=p("div"),n.textContent="Available tags (click to filter):",s=w();for(let u=0;u<a.length;u+=1)a[u].c();d(n,"class","suggestions-header svelte-oasr8b"),d(e,"class","suggestions-dropdown svelte-oasr8b")},m(u,g){X(u,e,g),l(e,n),l(e,s);for(let v=0;v<a.length;v+=1)a[v]&&a[v].m(e,null)},p(u,g){if(g[0]&65664){o=u[7].slice(0,5);let v;for(v=0;v<o.length;v+=1){let m=fa(u,o,v);a[v]?a[v].p(m,g):(a[v]=pa(m),a[v].c(),a[v].m(e,null))}for(;v<a.length;v+=1)a[v].d(1);a.length=o.length}},d(u){u&&$(e),Ct(a,u)}}}h(po,"create_if_block_5");function vo(i){let e,n,s,o=i[8],a=[];for(let u=0;u<o.length;u+=1)a[u]=va(ha(i,o,u));return{c(){e=p("div"),n=p("div"),n.textContent="Available tags:",s=w();for(let u=0;u<a.length;u+=1)a[u].c();d(n,"class","suggestions-header svelte-oasr8b"),d(e,"class","suggestions-dropdown svelte-oasr8b")},m(u,g){X(u,e,g),l(e,n),l(e,s);for(let v=0;v<a.length;v+=1)a[v]&&a[v].m(e,null)},p(u,g){if(g[0]&65792){o=u[8];let v;for(v=0;v<o.length;v+=1){let m=ha(u,o,v);a[v]?a[v].p(m,g):(a[v]=va(m),a[v].c(),a[v].m(e,null))}for(;v<a.length;v+=1)a[v].d(1);a.length=o.length}},d(u){u&&$(e),Ct(a,u)}}}h(vo,"create_if_block_4");function pa(i){let e,n,s=i[41]+"",o,a,u,g;function v(){return i[31](i[41])}return h(v,"click_handler_1"),{c(){e=p("button"),n=U("#"),o=U(s),a=w(),d(e,"class","suggestion-item svelte-oasr8b")},m(m,x){X(m,e,x),l(e,n),l(e,o),l(e,a),u||(g=me(e,"click",v),u=!0)},p(m,x){i=m,x[0]&128&&s!==(s=i[41]+"")&&re(o,s)},d(m){m&&$(e),u=!1,g()}}}h(pa,"create_each_block_2");function va(i){let e,n,s=i[41]+"",o,a,u,g;function v(){return i[30](i[41])}return h(v,"click_handler"),{c(){e=p("button"),n=U("#"),o=U(s),a=w(),d(e,"class","suggestion-item svelte-oasr8b")},m(m,x){X(m,e,x),l(e,n),l(e,o),l(e,a),u||(g=me(e,"click",v),u=!0)},p(m,x){i=m,x[0]&256&&s!==(s=i[41]+"")&&re(o,s)},d(m){m&&$(e),u=!1,g()}}}h(va,"create_each_block_1");function go(i){let e,n,s,o,a=i[2],u=[];for(let g=0;g<a.length;g+=1)u[g]=ba(ua(i,a,g));return{c(){e=p("div"),n=p("div"),n.innerHTML=`<div class="col-deck svelte-oasr8b">Deck</div> 
                <div class="col-stat svelte-oasr8b">New</div> 
                <div class="col-stat svelte-oasr8b">Learn</div> 
                <div class="col-stat svelte-oasr8b">Due</div> 
                <div class="col-config svelte-oasr8b"></div>`,s=w(),o=p("div");for(let g=0;g<u.length;g+=1)u[g].c();d(n,"class","table-header svelte-oasr8b"),d(o,"class","table-body svelte-oasr8b"),d(e,"class","deck-table svelte-oasr8b")},m(g,v){X(g,e,v),l(e,n),l(e,s),l(e,o);for(let m=0;m<u.length;m+=1)u[m]&&u[m].m(o,null)},p(g,v){if(v[0]&1583108){a=g[2];let m;for(m=0;m<a.length;m+=1){let x=ua(g,a,m);u[m]?u[m].p(x,v):(u[m]=ba(x),u[m].c(),u[m].m(o,null))}for(;m<u.length;m+=1)u[m].d(1);u.length=a.length}},d(g){g&&$(e),Ct(u,g)}}}h(go,"create_else_block");function mo(i){let e;return{c(){e=p("div"),e.innerHTML=`<p class="svelte-oasr8b">No decks match your filter.</p> 
            <p class="help-text svelte-oasr8b">Try adjusting your search terms.</p>`,d(e,"class","empty-state svelte-oasr8b")},m(n,s){X(n,e,s)},p:ke,d(n){n&&$(e)}}}h(mo,"create_if_block_1");function bo(i){let e;return{c(){e=p("div"),e.innerHTML=`<p class="svelte-oasr8b">No flashcard decks found.</p> 
            <p class="help-text svelte-oasr8b">Tag your notes with #flashcards to create decks.</p>`,d(e,"class","empty-state svelte-oasr8b")},m(n,s){X(n,e,s)},p:ke,d(n){n&&$(e)}}}h(bo,"create_if_block");function ga(i){let e;return{c(){e=p("span"),e.textContent="\u{1F4C5}",d(e,"class","limit-indicator svelte-oasr8b")},m(n,s){X(n,e,s)},d(n){n&&$(e)}}}h(ga,"create_if_block_3");function ma(i){let e;return{c(){e=p("span"),e.textContent="\u{1F4C5}",d(e,"class","limit-indicator svelte-oasr8b")},m(n,s){X(n,e,s)},d(n){n&&$(e)}}}h(ma,"create_if_block_2");function ba(i){let e,n,s,o=wa(i[38])+"",a,u,g,v,m=i[12].newCount+"",x,S,E,C,_,O=i[12].learningCount+"",D,M,N,I=i[12].dueCount+"",z,W,L,T,P,A,H,J,ee,Z,ie,V,G;function Q(){return i[32](i[38])}h(Q,"click_handler_2");function B(...ve){return i[33](i[38],...ve)}h(B,"keydown_handler");let te=i[38].config.enableNewCardsLimit&&ga(i),ce=i[38].config.enableReviewCardsLimit&&ma(i);function Me(...ve){return i[34](i[38],...ve)}return h(Me,"click_handler_3"),{c(){e=p("div"),n=p("div"),s=p("span"),a=U(o),g=w(),v=p("div"),x=U(m),S=w(),te&&te.c(),C=w(),_=p("div"),D=U(O),M=w(),N=p("div"),z=U(I),W=w(),ce&&ce.c(),T=w(),P=p("div"),A=p("button"),H=Fn("svg"),J=Fn("circle"),ee=Fn("path"),ie=w(),d(s,"class","deck-name-link svelte-oasr8b"),d(s,"role","button"),d(s,"tabindex","0"),d(s,"title",u="Click to review "+i[38].name),d(n,"class","col-deck svelte-oasr8b"),d(v,"class","col-stat svelte-oasr8b"),d(v,"title",E=i[38].config.enableNewCardsLimit?`${i[12].newCount} new cards available today (limit: ${i[38].config.newCardsLimit})`:`${i[12].newCount} new cards due`),Ee(v,"has-cards",i[12].newCount>0),Ee(v,"updating",i[11]),Ee(v,"has-limit",i[38].config.enableNewCardsLimit),d(_,"class","col-stat svelte-oasr8b"),Ee(_,"has-cards",i[12].learningCount>0),Ee(_,"updating",i[11]),d(N,"class","col-stat svelte-oasr8b"),d(N,"title",L=i[38].config.enableReviewCardsLimit?`${i[12].dueCount} review cards available today (limit: ${i[38].config.reviewCardsLimit})`:`${i[12].dueCount} review cards due`),Ee(N,"has-cards",i[12].dueCount>0),Ee(N,"updating",i[11]),Ee(N,"has-limit",i[38].config.enableReviewCardsLimit),d(J,"cx","12"),d(J,"cy","12"),d(J,"r","3"),d(ee,"d","M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1 1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"),d(H,"xmlns","http://www.w3.org/2000/svg"),d(H,"width","16"),d(H,"height","16"),d(H,"viewBox","0 0 24 24"),d(H,"fill","none"),d(H,"stroke","currentColor"),d(H,"stroke-width","2"),d(H,"stroke-linecap","round"),d(H,"stroke-linejoin","round"),d(A,"class","deck-config-button svelte-oasr8b"),d(A,"title","Configure deck settings"),d(A,"aria-label",Z="Configure "+i[38].name),d(P,"class","col-config svelte-oasr8b"),d(e,"class","deck-row svelte-oasr8b")},m(ve,Y){X(ve,e,Y),l(e,n),l(n,s),l(s,a),l(e,g),l(e,v),l(v,x),l(v,S),te&&te.m(v,null),l(e,C),l(e,_),l(_,D),l(e,M),l(e,N),l(N,z),l(N,W),ce&&ce.m(N,null),l(e,T),l(e,P),l(P,A),l(A,H),l(H,J),l(H,ee),l(e,ie),V||(G=[me(s,"click",Q),me(s,"keydown",B),me(A,"click",Me)],V=!0)},p(ve,Y){i=ve,Y[0]&4&&o!==(o=wa(i[38])+"")&&re(a,o),Y[0]&4&&u!==(u="Click to review "+i[38].name)&&d(s,"title",u),Y[0]&4&&m!==(m=i[12].newCount+"")&&re(x,m),i[38].config.enableNewCardsLimit?te||(te=ga(i),te.c(),te.m(v,null)):te&&(te.d(1),te=null),Y[0]&4&&E!==(E=i[38].config.enableNewCardsLimit?`${i[12].newCount} new cards available today (limit: ${i[38].config.newCardsLimit})`:`${i[12].newCount} new cards due`)&&d(v,"title",E),Y[0]&8196&&Ee(v,"has-cards",i[12].newCount>0),Y[0]&2048&&Ee(v,"updating",i[11]),Y[0]&4&&Ee(v,"has-limit",i[38].config.enableNewCardsLimit),Y[0]&4&&O!==(O=i[12].learningCount+"")&&re(D,O),Y[0]&8196&&Ee(_,"has-cards",i[12].learningCount>0),Y[0]&2048&&Ee(_,"updating",i[11]),Y[0]&4&&I!==(I=i[12].dueCount+"")&&re(z,I),i[38].config.enableReviewCardsLimit?ce||(ce=ma(i),ce.c(),ce.m(N,null)):ce&&(ce.d(1),ce=null),Y[0]&4&&L!==(L=i[38].config.enableReviewCardsLimit?`${i[12].dueCount} review cards available today (limit: ${i[38].config.reviewCardsLimit})`:`${i[12].dueCount} review cards due`)&&d(N,"title",L),Y[0]&8196&&Ee(N,"has-cards",i[12].dueCount>0),Y[0]&2048&&Ee(N,"updating",i[11]),Y[0]&4&&Ee(N,"has-limit",i[38].config.enableReviewCardsLimit),Y[0]&4&&Z!==(Z="Configure "+i[38].name)&&d(A,"aria-label",Z)},d(ve){ve&&$(e),te&&te.d(),ce&&ce.d(),V=!1,Ke(G)}}}h(ba,"create_each_block");function wo(i){let e,n,s,o,a,u,g,v,m,x,S,E,C,_,O,D,M,N,I,z,W,L,T,P;function A(G,Q){if(Q[0]&656&&(N=null),G[6]&&G[8].length>0)return vo;if(N==null&&(N=!!(!G[4].trim()&&G[7].length>0&&G[9])),N)return po}h(A,"select_block_type");let H=A(i,[-1,-1]),J=H&&H(i);function ee(G,Q){return G[3].length===0?bo:G[2].length===0?mo:go}h(ee,"select_block_type_1");let Z=ee(i,[-1,-1]),ie=Z(i),V={getReviewCounts:i[0]};return W=new ds({props:V}),i[35](W),{c(){e=p("div"),n=p("div"),s=p("h3"),s.textContent="Flashcard Decks",o=w(),a=p("div"),u=p("button"),u.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 3v18h18"></path><path d="M18 17V9"></path><path d="M13 17V5"></path><path d="M8 17v-3"></path></svg>',g=w(),v=p("button"),m=Fn("svg"),x=Fn("path"),S=Fn("path"),E=Fn("path"),C=w(),_=p("div"),O=p("div"),D=p("input"),M=w(),J&&J.c(),I=w(),ie.c(),z=w(),cs(W.$$.fragment),d(s,"class","panel-title svelte-oasr8b"),d(u,"class","stats-button svelte-oasr8b"),d(u,"title","View Overall Statistics"),d(x,"d","M23 4v6h-6"),d(S,"d","M1 20v-6h6"),d(E,"d","M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"),d(m,"xmlns","http://www.w3.org/2000/svg"),d(m,"width","14"),d(m,"height","14"),d(m,"viewBox","0 0 24 24"),d(m,"fill","none"),d(m,"stroke","currentColor"),d(m,"stroke-width","2"),d(m,"stroke-linecap","round"),d(m,"stroke-linejoin","round"),d(m,"class","svelte-oasr8b"),d(v,"class","refresh-button svelte-oasr8b"),v.disabled=i[10],Ee(v,"refreshing",i[10]),d(a,"class","header-buttons svelte-oasr8b"),d(n,"class","panel-header svelte-oasr8b"),d(D,"type","text"),d(D,"class","filter-input svelte-oasr8b"),d(D,"placeholder","Filter by name or tag... (e.g., 'spanish', '#flashcards')"),d(O,"class","filter-container svelte-oasr8b"),d(_,"class","filter-section svelte-oasr8b"),d(e,"class","deck-list-panel svelte-oasr8b")},m(G,Q){X(G,e,Q),l(e,n),l(n,s),l(n,o),l(n,a),l(a,u),l(a,g),l(a,v),l(v,m),l(m,x),l(m,S),l(m,E),l(e,C),l(e,_),l(_,O),l(O,D),Tn(D,i[4]),l(O,M),J&&J.m(O,null),l(e,I),ie.m(e,null),l(e,z),Ur(W,e,null),L=!0,T||(P=[me(u,"click",function(){gr(i[1])&&i[1].apply(this,arguments)}),me(v,"click",i[14]),me(D,"input",i[29]),me(D,"input",i[15]),me(D,"focus",i[17]),me(D,"blur",i[18])],T=!0)},p(G,Q){i=G,(!L||Q[0]&1024)&&(v.disabled=i[10]),(!L||Q[0]&1024)&&Ee(v,"refreshing",i[10]),Q[0]&16&&D.value!==i[4]&&Tn(D,i[4]),H===(H=A(i,Q))&&J?J.p(i,Q):(J&&J.d(1),J=H&&H(i),J&&(J.c(),J.m(O,null))),Z===(Z=ee(i,Q))&&ie?ie.p(i,Q):(ie.d(1),ie=Z(i),ie&&(ie.c(),ie.m(e,z)));let B={};Q[0]&1&&(B.getReviewCounts=i[0]),W.$set(B)},i(G){L||(Kn(W.$$.fragment,G),L=!0)},o(G){mr(W.$$.fragment,G),L=!1},d(G){G&&$(e),J&&J.d(),ie.d(),i[35](null),br(W),T=!1,Ke(P)}}}h(wo,"create_fragment");function wa(i){return i.name}h(wa,"formatDeckName");function _o(i,e,n){let s=[],o=[],a=new Map,u="",g,v=!1,m=[],x=[],S=!1,{onDeckClick:E}=e,{onRefresh:C}=e,{getReviewCounts:_}=e,{onUpdateDeckConfig:O}=e,{onOpenStatistics:D}=e,{plugin:M}=e,N=!1,I=!1;function z(K){var fe;return(fe=a.get(K))!==null&&fe!==void 0?fe:{deckId:K,newCount:0,learningCount:0,dueCount:0,totalCount:0}}h(z,"getDeckStats");function W(){return Dt(this,void 0,void 0,function*(){n(10,N=!0);try{C(),G()}catch(K){console.error("Error during refresh:",K)}finally{n(10,N=!1)}})}h(W,"handleRefresh");function L(K,fe){n(11,I=!0),a.set(K,fe),n(2,s),n(11,I=!1)}h(L,"updateStatsById");function T(K){n(11,I=!0),n(12,a=K),n(2,s),n(11,I=!1)}h(T,"updateStats");function P(K){n(3,o=K),n(7,m=[...new Set(K.map(fe=>fe.tag))].filter(fe=>fe)),A()}h(P,"updateDecks");function A(){if(!u.trim())n(2,s=o);else{let K=u.toLowerCase();n(2,s=o.filter(fe=>fe.name.toLowerCase().includes(K)||fe.tag.toLowerCase().includes(K)))}}h(A,"applyFilter");function H(K){let fe=K.target;n(4,u=fe.value),J(),A()}h(H,"handleFilterInput");function J(){if(!u.trim()){n(6,v=!1);return}let K=u.toLowerCase();n(8,x=m.filter(fe=>fe.toLowerCase().includes(K)&&fe.toLowerCase()!==K)),n(6,v=x.length>0)}h(J,"updateSuggestions");function ee(K){n(4,u=K),n(6,v=!1),A()}h(ee,"selectSuggestion");function Z(){n(9,S=!0),u.trim()?J():m.length>0&&n(6,v=!0)}h(Z,"handleFilterFocus");function ie(){n(9,S=!1),setTimeout(()=>{n(6,v=!1)},150)}h(ie,"handleFilterBlur");function V(K){E(K)}h(V,"handleDeckClick");function G(){g&&g.refresh()}h(G,"refreshHeatmap");function Q(K,fe){fe.stopPropagation(),new us(M,K,qe=>Dt(this,void 0,void 0,function*(){if(O){yield O(K.id,qe);let Ne=o.findIndex(Fe=>Fe.id===K.id);Ne!==-1&&(n(3,o[Ne].config=qe,o),n(3,o=[...o]),A())}})).open()}h(Q,"handleConfigClick"),cn(()=>{W()});function B(){u=this.value,n(4,u)}h(B,"input_input_handler");let te=h(K=>ee(K),"click_handler"),ce=h(K=>ee(K),"click_handler_1"),Me=h(K=>V(K),"click_handler_2"),ve=h((K,fe)=>fe.key==="Enter"&&V(K),"keydown_handler"),Y=h((K,fe)=>Q(K,fe),"click_handler_3");function be(K){Pt[K?"unshift":"push"](()=>{g=K,n(5,g)})}return h(be,"reviewheatmap_binding"),i.$$set=K=>{"onDeckClick"in K&&n(21,E=K.onDeckClick),"onRefresh"in K&&n(22,C=K.onRefresh),"getReviewCounts"in K&&n(0,_=K.getReviewCounts),"onUpdateDeckConfig"in K&&n(23,O=K.onUpdateDeckConfig),"onOpenStatistics"in K&&n(1,D=K.onOpenStatistics),"plugin"in K&&n(24,M=K.plugin)},[_,D,s,o,u,g,v,m,x,S,N,I,a,z,W,H,ee,Z,ie,V,Q,E,C,O,M,L,T,P,G,B,te,ce,Me,ve,Y,be]}h(_o,"instance");var Os=class Os extends Et{constructor(e){super(),Zt(this,e,_o,wo,Kt,{onDeckClick:21,onRefresh:22,getReviewCounts:0,onUpdateDeckConfig:23,onOpenStatistics:1,plugin:24,updateStatsById:25,updateStats:26,updateDecks:27,refreshHeatmap:28},ho,[-1,-1])}get updateStatsById(){return this.$$.ctx[25]}get updateStats(){return this.$$.ctx[26]}get updateDecks(){return this.$$.ctx[27]}get refreshHeatmap(){return this.$$.ctx[28]}};h(Os,"DeckListPanel");var Ns=Os,_a=Ns;var La=require("obsidian");function yo(i){Jt(i,"svelte-sqk1dc",".statistics-container.svelte-sqk1dc.svelte-sqk1dc{padding:20px;font-family:var(--font-interface);width:100%;overflow-x:hidden}.loading.svelte-sqk1dc.svelte-sqk1dc,.error.svelte-sqk1dc.svelte-sqk1dc{text-align:center;padding:40px;color:var(--text-muted)}.filters.svelte-sqk1dc.svelte-sqk1dc{display:flex;gap:24px;margin-bottom:24px;padding:20px;background:var(--background-secondary);border-radius:10px;flex-wrap:wrap;justify-content:center}.filter-group.svelte-sqk1dc.svelte-sqk1dc{display:flex;flex-direction:column;gap:8px;min-width:200px}.filter-group.svelte-sqk1dc label.svelte-sqk1dc{font-size:14px;color:var(--text-muted);font-weight:600}.filter-group.svelte-sqk1dc select.svelte-sqk1dc{border:1px solid var(--background-modifier-border);border-radius:4px;background:var(--background-primary);color:var(--text-normal);font-size:14px;font-weight:normal;appearance:none;-webkit-appearance:none;-moz-appearance:none;cursor:pointer;min-width:180px;position:relative;opacity:1;z-index:10}.filter-group.svelte-sqk1dc select.svelte-sqk1dc:focus{outline:none;border-color:var(--interactive-accent)}.filter-group.svelte-sqk1dc select option.svelte-sqk1dc{background:var(--background-primary);color:var(--text-normal);padding:8px;font-size:14px;opacity:1;visibility:visible}.stats-section.svelte-sqk1dc.svelte-sqk1dc{margin-bottom:32px;padding-bottom:24px;border-bottom:1px solid var(--background-modifier-border)}.stats-section.svelte-sqk1dc.svelte-sqk1dc:last-of-type{border-bottom:none}.stats-section.svelte-sqk1dc h3.svelte-sqk1dc{margin:0 0 20px 0;color:var(--text-normal);font-size:18px;font-weight:600}.stats-section.svelte-sqk1dc h4.svelte-sqk1dc{margin:24px 0 12px 0;color:var(--text-normal);font-size:16px;font-weight:500}.stats-grid.svelte-sqk1dc.svelte-sqk1dc{display:grid;grid-template-columns:repeat(auto-fit, minmax(150px, 1fr));gap:16px;margin-bottom:20px}.stat-card.svelte-sqk1dc.svelte-sqk1dc{background:var(--background-secondary);padding:16px;border-radius:8px;text-align:center;border:1px solid var(--background-modifier-border);min-height:80px;display:flex;flex-direction:column;justify-content:center}.stat-value.svelte-sqk1dc.svelte-sqk1dc{font-size:24px;font-weight:600;color:var(--text-normal);margin-bottom:4px}.stat-label.svelte-sqk1dc.svelte-sqk1dc{font-size:12px;color:var(--text-muted);text-transform:uppercase;letter-spacing:0.5px}.metrics-grid.svelte-sqk1dc.svelte-sqk1dc{display:grid;grid-template-columns:repeat(auto-fit, minmax(200px, 1fr));gap:16px;margin-bottom:24px}.metric-card.svelte-sqk1dc.svelte-sqk1dc{background:var(--background-secondary);padding:20px;border-radius:8px;border:1px solid var(--background-modifier-border);min-height:100px}.metric-value.svelte-sqk1dc.svelte-sqk1dc{font-size:28px;font-weight:700;color:var(--text-accent);margin-bottom:8px}.metric-label.svelte-sqk1dc.svelte-sqk1dc{font-size:14px;font-weight:600;color:var(--text-normal);margin-bottom:4px}.metric-description.svelte-sqk1dc.svelte-sqk1dc{font-size:11px;color:var(--text-muted);line-height:1.3}.forecast-chart.svelte-sqk1dc.svelte-sqk1dc{display:flex;gap:4px;align-items:flex-end;padding:16px;background:var(--background-secondary);border-radius:8px;height:400px;overflow-x:auto;overflow-y:hidden;max-width:100%;box-sizing:border-box}.forecast-bar.svelte-sqk1dc.svelte-sqk1dc{display:flex;flex-direction:column;align-items:center;gap:6px;min-width:40px;flex-shrink:0}.bar.svelte-sqk1dc.svelte-sqk1dc{background:var(--text-accent);width:24px;border-radius:4px 4px 0 0;transition:background 0.2s}.bar-label.svelte-sqk1dc.svelte-sqk1dc{font-size:12px;color:var(--text-muted);font-weight:500}.bar-value.svelte-sqk1dc.svelte-sqk1dc{font-size:12px;color:var(--text-normal);font-weight:600}.forecast-note.svelte-sqk1dc.svelte-sqk1dc{margin-top:8px;font-size:12px;color:var(--text-muted);text-align:center}.button-stats.svelte-sqk1dc.svelte-sqk1dc{display:flex;flex-direction:column;gap:12px}.button-bar.svelte-sqk1dc.svelte-sqk1dc{display:flex;justify-content:space-between;align-items:center;padding:12px 16px;border-radius:6px;background:var(--background-secondary);border:1px solid var(--background-modifier-border)}.button-bar.again.svelte-sqk1dc.svelte-sqk1dc{border-left:4px solid #ef4444}.button-bar.hard.svelte-sqk1dc.svelte-sqk1dc{border-left:4px solid #f97316}.button-bar.good.svelte-sqk1dc.svelte-sqk1dc{border-left:4px solid #22c55e}.button-bar.easy.svelte-sqk1dc.svelte-sqk1dc{border-left:4px solid #3b82f6}.button-label.svelte-sqk1dc.svelte-sqk1dc{font-weight:500;color:var(--text-normal)}.button-count.svelte-sqk1dc.svelte-sqk1dc{font-weight:600;color:var(--text-normal);font-size:18px}.button-percentage.svelte-sqk1dc.svelte-sqk1dc{font-size:12px;color:var(--text-muted)}.modal-actions.svelte-sqk1dc.svelte-sqk1dc{display:flex;justify-content:flex-end;gap:8px;margin-top:24px;padding:16px 20px;border-top:1px solid var(--background-modifier-border);background:var(--background-primary);position:sticky;bottom:0;margin-left:-20px;margin-right:-20px}.close-button.svelte-sqk1dc.svelte-sqk1dc{padding:8px 16px;background:var(--interactive-accent);color:var(--text-on-accent);border:none;border-radius:4px;cursor:pointer;font-weight:500}.close-button.svelte-sqk1dc.svelte-sqk1dc:hover{background:var(--interactive-accent-hover)}.forecast-bar.svelte-sqk1dc.svelte-sqk1dc{cursor:pointer;position:relative}.forecast-bar.svelte-sqk1dc:hover .bar.svelte-sqk1dc{opacity:0.8;transition:opacity 0.2s ease}.no-data-message.svelte-sqk1dc.svelte-sqk1dc{text-align:center;padding:24px;background:var(--background-secondary);border-radius:8px;border:1px solid var(--background-modifier-border)}.no-data-message.svelte-sqk1dc p.svelte-sqk1dc{margin:0 0 8px 0;color:var(--text-muted)}.help-text.svelte-sqk1dc.svelte-sqk1dc{font-size:12px !important;color:var(--text-faint) !important;margin:0 !important}.retry-button.svelte-sqk1dc.svelte-sqk1dc{margin-top:12px;padding:8px 16px;background:var(--interactive-accent);color:var(--text-on-accent);border:none;border-radius:4px;cursor:pointer;font-size:14px}.retry-button.svelte-sqk1dc.svelte-sqk1dc:hover{background:var(--interactive-accent-hover)}")}h(yo,"add_css");function ya(i,e,n){let s=i.slice();s[30]=e[n],s[33]=n;let o=s[2].forecast.indexOf(s[30]);return s[31]=o,s}h(ya,"get_each_context");function ko(i){let e=i.slice(),n=e[2].forecast.filter(o=>o.dueCount>0).slice(0,20);e[28]=n;let s=Math.max(...e[28].map(o=>o.dueCount));return e[29]=s,e}h(ko,"get_if_ctx");function ka(i,e,n){let s=i.slice();return s[34]=e[n],s}h(ka,"get_each_context_1");function xa(i,e,n){let s=i.slice();return s[37]=e[n],s}h(xa,"get_each_context_2");function xo(i){var Ws,$s,Xs,Vs,Gs,Ys,Qs,Ks,Js,Zs,ei,ti,ni,ri,si,ii,ai,oi,li,ci,di,ui,fi;let e,n,s,o,a,u,g,v,m,x,S,E,C,_,O,D,M,N,I,z,W,L=((($s=(Ws=i[2])==null?void 0:Ws.cardStats)==null?void 0:$s.new)||0)+"",T,P,A,H,J,ee,Z=(((Vs=(Xs=i[2])==null?void 0:Xs.cardStats)==null?void 0:Vs.learning)||0)+"",ie,V,G,Q,B,te,ce=(((Ys=(Gs=i[2])==null?void 0:Gs.cardStats)==null?void 0:Ys.mature)||0)+"",Me,ve,Y,be,K,fe,at,qe,Ne,Fe,ot,ye,pe,De,Ft,Tt=((Qs=i[2])!=null&&Qs.averagePace?Fa(i[2].averagePace):"N/A")+"",Rt,ut,mt,Ln,nt,Le,ze=((Ks=i[2])!=null&&Ks.totalReviewTime?en(i[2].totalReviewTime):"N/A")+"",tn,bt,wt,dn,rt,Ze,ue,ft,Te,lt,Ve,Bt,Ge,un,ct,jt,j,fn,we,_e,Jn,Ae,_t,ht,qn=(((Js=i[2])==null?void 0:Js.retentionRate)||0).toFixed(1)+"",je,wr,nn,Nn,_r,rn,He,Lt,Zn,er,tr,nr,On,Mn,Ht,st,An,hn,yr,In,pn,qt,sn,kr,Nt,rr,zn,xr,Ot,sr,Mt,Ce,Ut,an,Pn,pt,vn,ir=(((ei=(Zs=i[2])==null?void 0:Zs.cardStats)==null?void 0:ei.learning)||0)+"",Sr,gn,Bn,$r,mn,Er,yt,bn,Xr,on,jn,kt,ar,Ue,vt,Wt=(((ni=(ti=i[2])==null?void 0:ti.cardStats)==null?void 0:ni.new)||0)+(((si=(ri=i[2])==null?void 0:ri.cardStats)==null?void 0:si.learning)||0)+(((ai=(ii=i[2])==null?void 0:ii.cardStats)==null?void 0:ai.mature)||0)+"",Cr,ae,wn,Hn,Un,Dr,$t,At,dt,Xt,_n,Vt=(((li=(oi=i[2])==null?void 0:oi.cardStats)==null?void 0:li.new)||0)+"",ln,yn,t,r,c,f,b=(((di=(ci=i[2])==null?void 0:ci.cardStats)==null?void 0:di.learning)||0)+"",k,F,oe,he,ge,xe,Pe=(((fi=(ui=i[2])==null?void 0:ui.cardStats)==null?void 0:fi.mature)||0)+"",Gt,Fr,Wn,Tr,It,or,Vr,Rr,Yt,lr,Gr,cr,Lr,xt,dr,Yr,qr,Qr,Qt,Nr,$n,kn,Ye,Or,Kr,xn=i[6],Qe=[];for(let R=0;R<xn.length;R+=1)Qe[R]=Sa(xa(i,xn,R));let Sn=i[5],We=[];for(let R=0;R<Sn.length;R+=1)We[R]=Ea(ka(i,Sn,R));function Jr(R,se){return R[8]?Do:Co}h(Jr,"select_block_type_1");let ur=Jr(i,[-1,-1]),St=ur(i);function Xn(R,se){return R[9]&&R[9].reviews>0?To:Fo}h(Xn,"select_block_type_2");let Vn=Xn(i,[-1,-1]),gt=Vn(i);function Mr(R,se){return R[10]&&R[10].reviews>0?Lo:Ro}h(Mr,"select_block_type_3");let y=Mr(i,[-1,-1]),q=y(i);function ne(R,se){return R[11]&&R[11].reviews>0?No:qo}h(ne,"select_block_type_4");let le=ne(i,[-1,-1]),de=le(i);function Se(R,se){var Xe;return(Xe=R[2])!=null&&Xe.answerButtons&&(R[2].answerButtons.again>0||R[2].answerButtons.hard>0||R[2].answerButtons.good>0||R[2].answerButtons.easy>0)?Mo:Oo}h(Se,"select_block_type_5");let et=Se(i,[-1,-1]),Oe=et(i);function tt(R,se){var Xe;return se[0]&4&&(cr=null),cr==null&&(cr=!!((Xe=R[2])!=null&&Xe.forecast&&R[2].forecast.length>0&&R[2].forecast.some(zo))),cr?Ca:Ao}h(tt,"select_block_type_6");function it(R,se){return se===Ca?ko(R):R}h(it,"select_block_ctx");let zt=tt(i,[-1,-1]),$e=zt(it(i,zt)),gs={getReviewCounts:i[22]};return Qt=new ds({props:gs}),i[23](Qt),{c(){e=p("div"),n=p("div"),s=p("label"),s.textContent="Show data for:",o=w(),a=p("select"),u=p("option"),u.textContent="All Decks";for(let R=0;R<Qe.length;R+=1)Qe[R].c();g=Xi();for(let R=0;R<We.length;R+=1)We[R].c();v=w(),m=p("div"),x=p("label"),x.textContent="Timeframe:",S=w(),E=p("select"),C=p("option"),C.textContent="Last 12 Months",_=p("option"),_.textContent="All History",O=w(),D=p("div"),M=p("h3"),M.textContent="Current Status",N=w(),I=p("div"),z=p("div"),W=p("div"),T=U(L),P=w(),A=p("div"),A.textContent="New Cards",H=w(),J=p("div"),ee=p("div"),ie=U(Z),V=w(),G=p("div"),G.textContent="Learning",Q=w(),B=p("div"),te=p("div"),Me=U(ce),ve=w(),Y=p("div"),Y.textContent="Mature",be=w(),K=p("div"),fe=p("div"),fe.textContent=`${i[17]()}`,at=w(),qe=p("div"),qe.textContent="Due Today",Ne=w(),Fe=p("div"),ot=p("h3"),ot.textContent="Review Pace",ye=w(),pe=p("div"),De=p("div"),Ft=p("div"),Rt=U(Tt),ut=w(),mt=p("div"),mt.textContent="Average per Card",Ln=w(),nt=p("div"),Le=p("div"),tn=U(ze),bt=w(),wt=p("div"),wt.textContent="Total Review Time",dn=w(),rt=p("div"),Ze=p("h3"),Ze.textContent="Today's Statistics",ue=w(),St.c(),ft=w(),Te=p("div"),lt=p("h3"),lt.textContent="This Week",Ve=w(),gt.c(),Bt=w(),Ge=p("h3"),Ge.textContent="This Month",un=w(),q.c(),ct=w(),jt=p("h3"),jt.textContent="This Year",j=w(),de.c(),fn=w(),we=p("div"),_e=p("h3"),_e.textContent="Deck Statistics & Metrics",Jn=w(),Ae=p("div"),_t=p("div"),ht=p("div"),je=U(qn),wr=U("%"),nn=w(),Nn=p("div"),Nn.textContent="Retention Rate",_r=w(),rn=p("div"),rn.textContent='% of reviews answered correctly (excluding "Again")',He=w(),Lt=p("div"),Zn=p("div"),Zn.textContent=`${i[15]()}`,er=w(),tr=p("div"),tr.textContent="Average Ease",nr=w(),On=p("div"),On.textContent="Mean of ease button values",Mn=w(),Ht=p("div"),st=p("div"),st.textContent=`${i[16]()}d`,An=w(),hn=p("div"),hn.textContent="Avg Interval",yr=w(),In=p("div"),In.textContent="Mean interval of all review cards",pn=w(),qt=p("div"),sn=p("div"),sn.textContent=`${i[17]()}`,kr=w(),Nt=p("div"),Nt.textContent="Due Today",rr=w(),zn=p("div"),zn.textContent="Number of cards due today",xr=w(),Ot=p("div"),sr=p("div"),sr.textContent=`${i[18]()}`,Mt=w(),Ce=p("div"),Ce.textContent="Due Tomorrow",Ut=w(),an=p("div"),an.textContent="Number of cards due tomorrow",Pn=w(),pt=p("div"),vn=p("div"),Sr=U(ir),gn=w(),Bn=p("div"),Bn.textContent="Learning Cards",$r=w(),mn=p("div"),mn.textContent="Number of cards in the learning queue",Er=w(),yt=p("div"),bn=p("div"),bn.textContent=`${i[19]()}%`,Xr=w(),on=p("div"),on.textContent="Maturity Ratio",jn=w(),kt=p("div"),kt.textContent="Mature cards \xF7 total cards",ar=w(),Ue=p("div"),vt=p("div"),Cr=U(Wt),ae=w(),wn=p("div"),wn.textContent="Total Cards",Hn=w(),Un=p("div"),Un.textContent="All cards in collection",Dr=w(),$t=p("h4"),$t.textContent="Card Status Breakdown",At=w(),dt=p("div"),Xt=p("div"),_n=p("div"),ln=U(Vt),yn=w(),t=p("div"),t.textContent="New Cards",r=w(),c=p("div"),f=p("div"),k=U(b),F=w(),oe=p("div"),oe.textContent="Learning",he=w(),ge=p("div"),xe=p("div"),Gt=U(Pe),Fr=w(),Wn=p("div"),Wn.textContent="Mature",Tr=w(),It=p("div"),or=p("h3"),or.textContent="Answer Button Usage",Vr=w(),Oe.c(),Rr=w(),Yt=p("div"),lr=p("h3"),lr.textContent="Review Load Forecast",Gr=w(),$e.c(),Lr=w(),xt=p("div"),dr=p("h3"),dr.textContent="Review Heatmap",Yr=w(),qr=p("p"),qr.textContent="Daily review activity over time",Qr=w(),cs(Qt.$$.fragment),Nr=w(),$n=p("div"),kn=p("button"),kn.textContent="Close",d(s,"for","deck-filter"),d(s,"class","svelte-sqk1dc"),u.__value="all",u.value=u.__value,Ie(u,"background","var(--background-primary)",1),Ie(u,"color","var(--text-normal)",1),d(u,"class","svelte-sqk1dc"),d(a,"id","deck-filter"),Ie(a,"background","var(--background-primary)",1),Ie(a,"color","var(--text-normal)",1),d(a,"class","svelte-sqk1dc"),i[3]===void 0&&Dn(()=>i[20].call(a)),d(n,"class","filter-group svelte-sqk1dc"),d(x,"for","timeframe-filter"),d(x,"class","svelte-sqk1dc"),C.__value="12months",C.value=C.__value,Ie(C,"background","var(--background-primary)",1),Ie(C,"color","var(--text-normal)",1),d(C,"class","svelte-sqk1dc"),_.__value="all",_.value=_.__value,Ie(_,"background","var(--background-primary)",1),Ie(_,"color","var(--text-normal)",1),d(_,"class","svelte-sqk1dc"),d(E,"id","timeframe-filter"),Ie(E,"background","var(--background-primary)",1),Ie(E,"color","var(--text-normal)",1),d(E,"class","svelte-sqk1dc"),i[4]===void 0&&Dn(()=>i[21].call(E)),d(m,"class","filter-group svelte-sqk1dc"),d(e,"class","filters svelte-sqk1dc"),d(M,"class","svelte-sqk1dc"),d(W,"class","stat-value svelte-sqk1dc"),d(A,"class","stat-label svelte-sqk1dc"),d(z,"class","stat-card svelte-sqk1dc"),d(ee,"class","stat-value svelte-sqk1dc"),d(G,"class","stat-label svelte-sqk1dc"),d(J,"class","stat-card svelte-sqk1dc"),d(te,"class","stat-value svelte-sqk1dc"),d(Y,"class","stat-label svelte-sqk1dc"),d(B,"class","stat-card svelte-sqk1dc"),d(fe,"class","stat-value svelte-sqk1dc"),d(qe,"class","stat-label svelte-sqk1dc"),d(K,"class","stat-card svelte-sqk1dc"),d(I,"class","stats-grid svelte-sqk1dc"),d(D,"class","stats-section svelte-sqk1dc"),d(ot,"class","svelte-sqk1dc"),d(Ft,"class","stat-value svelte-sqk1dc"),d(mt,"class","stat-label svelte-sqk1dc"),d(De,"class","stat-card svelte-sqk1dc"),d(Le,"class","stat-value svelte-sqk1dc"),d(wt,"class","stat-label svelte-sqk1dc"),d(nt,"class","stat-card svelte-sqk1dc"),d(pe,"class","stats-grid svelte-sqk1dc"),d(Fe,"class","stats-section svelte-sqk1dc"),d(Ze,"class","svelte-sqk1dc"),d(rt,"class","stats-section svelte-sqk1dc"),d(lt,"class","svelte-sqk1dc"),d(Ge,"class","svelte-sqk1dc"),d(jt,"class","svelte-sqk1dc"),d(Te,"class","stats-section svelte-sqk1dc"),d(_e,"class","svelte-sqk1dc"),d(ht,"class","metric-value svelte-sqk1dc"),d(Nn,"class","metric-label svelte-sqk1dc"),d(rn,"class","metric-description svelte-sqk1dc"),d(_t,"class","metric-card svelte-sqk1dc"),d(Zn,"class","metric-value svelte-sqk1dc"),d(tr,"class","metric-label svelte-sqk1dc"),d(On,"class","metric-description svelte-sqk1dc"),d(Lt,"class","metric-card svelte-sqk1dc"),d(st,"class","metric-value svelte-sqk1dc"),d(hn,"class","metric-label svelte-sqk1dc"),d(In,"class","metric-description svelte-sqk1dc"),d(Ht,"class","metric-card svelte-sqk1dc"),d(sn,"class","metric-value svelte-sqk1dc"),d(Nt,"class","metric-label svelte-sqk1dc"),d(zn,"class","metric-description svelte-sqk1dc"),d(qt,"class","metric-card svelte-sqk1dc"),d(sr,"class","metric-value svelte-sqk1dc"),d(Ce,"class","metric-label svelte-sqk1dc"),d(an,"class","metric-description svelte-sqk1dc"),d(Ot,"class","metric-card svelte-sqk1dc"),d(vn,"class","metric-value svelte-sqk1dc"),d(Bn,"class","metric-label svelte-sqk1dc"),d(mn,"class","metric-description svelte-sqk1dc"),d(pt,"class","metric-card svelte-sqk1dc"),d(bn,"class","metric-value svelte-sqk1dc"),d(on,"class","metric-label svelte-sqk1dc"),d(kt,"class","metric-description svelte-sqk1dc"),d(yt,"class","metric-card svelte-sqk1dc"),d(vt,"class","metric-value svelte-sqk1dc"),d(wn,"class","metric-label svelte-sqk1dc"),d(Un,"class","metric-description svelte-sqk1dc"),d(Ue,"class","metric-card svelte-sqk1dc"),d(Ae,"class","metrics-grid svelte-sqk1dc"),d($t,"class","svelte-sqk1dc"),d(_n,"class","stat-value svelte-sqk1dc"),d(t,"class","stat-label svelte-sqk1dc"),d(Xt,"class","stat-card svelte-sqk1dc"),d(f,"class","stat-value svelte-sqk1dc"),d(oe,"class","stat-label svelte-sqk1dc"),d(c,"class","stat-card svelte-sqk1dc"),d(xe,"class","stat-value svelte-sqk1dc"),d(Wn,"class","stat-label svelte-sqk1dc"),d(ge,"class","stat-card svelte-sqk1dc"),d(dt,"class","stats-grid svelte-sqk1dc"),d(we,"class","stats-section svelte-sqk1dc"),d(or,"class","svelte-sqk1dc"),d(It,"class","stats-section svelte-sqk1dc"),d(lr,"class","svelte-sqk1dc"),d(Yt,"class","stats-section svelte-sqk1dc"),d(dr,"class","svelte-sqk1dc"),d(xt,"class","stats-section svelte-sqk1dc"),d(kn,"class","close-button svelte-sqk1dc"),d($n,"class","modal-actions svelte-sqk1dc")},m(R,se){X(R,e,se),l(e,n),l(n,s),l(n,o),l(n,a),l(a,u);for(let Xe=0;Xe<Qe.length;Xe+=1)Qe[Xe]&&Qe[Xe].m(a,null);l(a,g);for(let Xe=0;Xe<We.length;Xe+=1)We[Xe]&&We[Xe].m(a,null);Rn(a,i[3],!0),l(e,v),l(e,m),l(m,x),l(m,S),l(m,E),l(E,C),l(E,_),Rn(E,i[4],!0),X(R,O,se),X(R,D,se),l(D,M),l(D,N),l(D,I),l(I,z),l(z,W),l(W,T),l(z,P),l(z,A),l(I,H),l(I,J),l(J,ee),l(ee,ie),l(J,V),l(J,G),l(I,Q),l(I,B),l(B,te),l(te,Me),l(B,ve),l(B,Y),l(I,be),l(I,K),l(K,fe),l(K,at),l(K,qe),X(R,Ne,se),X(R,Fe,se),l(Fe,ot),l(Fe,ye),l(Fe,pe),l(pe,De),l(De,Ft),l(Ft,Rt),l(De,ut),l(De,mt),l(pe,Ln),l(pe,nt),l(nt,Le),l(Le,tn),l(nt,bt),l(nt,wt),X(R,dn,se),X(R,rt,se),l(rt,Ze),l(rt,ue),St.m(rt,null),X(R,ft,se),X(R,Te,se),l(Te,lt),l(Te,Ve),gt.m(Te,null),l(Te,Bt),l(Te,Ge),l(Te,un),q.m(Te,null),l(Te,ct),l(Te,jt),l(Te,j),de.m(Te,null),X(R,fn,se),X(R,we,se),l(we,_e),l(we,Jn),l(we,Ae),l(Ae,_t),l(_t,ht),l(ht,je),l(ht,wr),l(_t,nn),l(_t,Nn),l(_t,_r),l(_t,rn),l(Ae,He),l(Ae,Lt),l(Lt,Zn),l(Lt,er),l(Lt,tr),l(Lt,nr),l(Lt,On),l(Ae,Mn),l(Ae,Ht),l(Ht,st),l(Ht,An),l(Ht,hn),l(Ht,yr),l(Ht,In),l(Ae,pn),l(Ae,qt),l(qt,sn),l(qt,kr),l(qt,Nt),l(qt,rr),l(qt,zn),l(Ae,xr),l(Ae,Ot),l(Ot,sr),l(Ot,Mt),l(Ot,Ce),l(Ot,Ut),l(Ot,an),l(Ae,Pn),l(Ae,pt),l(pt,vn),l(vn,Sr),l(pt,gn),l(pt,Bn),l(pt,$r),l(pt,mn),l(Ae,Er),l(Ae,yt),l(yt,bn),l(yt,Xr),l(yt,on),l(yt,jn),l(yt,kt),l(Ae,ar),l(Ae,Ue),l(Ue,vt),l(vt,Cr),l(Ue,ae),l(Ue,wn),l(Ue,Hn),l(Ue,Un),l(we,Dr),l(we,$t),l(we,At),l(we,dt),l(dt,Xt),l(Xt,_n),l(_n,ln),l(Xt,yn),l(Xt,t),l(dt,r),l(dt,c),l(c,f),l(f,k),l(c,F),l(c,oe),l(dt,he),l(dt,ge),l(ge,xe),l(xe,Gt),l(ge,Fr),l(ge,Wn),X(R,Tr,se),X(R,It,se),l(It,or),l(It,Vr),Oe.m(It,null),X(R,Rr,se),X(R,Yt,se),l(Yt,lr),l(Yt,Gr),$e.m(Yt,null),X(R,Lr,se),X(R,xt,se),l(xt,dr),l(xt,Yr),l(xt,qr),l(xt,Qr),Ur(Qt,xt,null),X(R,Nr,se),X(R,$n,se),l($n,kn),Ye=!0,Or||(Kr=[me(a,"change",i[20]),me(a,"change",i[14]),me(E,"change",i[21]),me(E,"change",i[14]),me(kn,"click",i[24])],Or=!0)},p(R,se){var hi,pi,vi,gi,mi,bi,wi,_i,yi,ki,xi,Si,Ei,Ci,Di,Fi,Ti,Ri,Li,qi,Ni,Oi,Mi;if(se[0]&64){xn=R[6];let Re;for(Re=0;Re<xn.length;Re+=1){let Ar=xa(R,xn,Re);Qe[Re]?Qe[Re].p(Ar,se):(Qe[Re]=Sa(Ar),Qe[Re].c(),Qe[Re].m(a,g))}for(;Re<Qe.length;Re+=1)Qe[Re].d(1);Qe.length=xn.length}if(se[0]&32){Sn=R[5];let Re;for(Re=0;Re<Sn.length;Re+=1){let Ar=ka(R,Sn,Re);We[Re]?We[Re].p(Ar,se):(We[Re]=Ea(Ar),We[Re].c(),We[Re].m(a,null))}for(;Re<We.length;Re+=1)We[Re].d(1);We.length=Sn.length}se[0]&104&&Rn(a,R[3]),se[0]&16&&Rn(E,R[4]),(!Ye||se[0]&4)&&L!==(L=(((pi=(hi=R[2])==null?void 0:hi.cardStats)==null?void 0:pi.new)||0)+"")&&re(T,L),(!Ye||se[0]&4)&&Z!==(Z=(((gi=(vi=R[2])==null?void 0:vi.cardStats)==null?void 0:gi.learning)||0)+"")&&re(ie,Z),(!Ye||se[0]&4)&&ce!==(ce=(((bi=(mi=R[2])==null?void 0:mi.cardStats)==null?void 0:bi.mature)||0)+"")&&re(Me,ce),(!Ye||se[0]&4)&&Tt!==(Tt=((wi=R[2])!=null&&wi.averagePace?Fa(R[2].averagePace):"N/A")+"")&&re(Rt,Tt),(!Ye||se[0]&4)&&ze!==(ze=((_i=R[2])!=null&&_i.totalReviewTime?en(R[2].totalReviewTime):"N/A")+"")&&re(tn,ze),ur===(ur=Jr(R,se))&&St?St.p(R,se):(St.d(1),St=ur(R),St&&(St.c(),St.m(rt,null))),Vn===(Vn=Xn(R,se))&&gt?gt.p(R,se):(gt.d(1),gt=Vn(R),gt&&(gt.c(),gt.m(Te,Bt))),y===(y=Mr(R,se))&&q?q.p(R,se):(q.d(1),q=y(R),q&&(q.c(),q.m(Te,ct))),le===(le=ne(R,se))&&de?de.p(R,se):(de.d(1),de=le(R),de&&(de.c(),de.m(Te,null))),(!Ye||se[0]&4)&&qn!==(qn=(((yi=R[2])==null?void 0:yi.retentionRate)||0).toFixed(1)+"")&&re(je,qn),(!Ye||se[0]&4)&&ir!==(ir=(((xi=(ki=R[2])==null?void 0:ki.cardStats)==null?void 0:xi.learning)||0)+"")&&re(Sr,ir),(!Ye||se[0]&4)&&Wt!==(Wt=(((Ei=(Si=R[2])==null?void 0:Si.cardStats)==null?void 0:Ei.new)||0)+(((Di=(Ci=R[2])==null?void 0:Ci.cardStats)==null?void 0:Di.learning)||0)+(((Ti=(Fi=R[2])==null?void 0:Fi.cardStats)==null?void 0:Ti.mature)||0)+"")&&re(Cr,Wt),(!Ye||se[0]&4)&&Vt!==(Vt=(((Li=(Ri=R[2])==null?void 0:Ri.cardStats)==null?void 0:Li.new)||0)+"")&&re(ln,Vt),(!Ye||se[0]&4)&&b!==(b=(((Ni=(qi=R[2])==null?void 0:qi.cardStats)==null?void 0:Ni.learning)||0)+"")&&re(k,b),(!Ye||se[0]&4)&&Pe!==(Pe=(((Mi=(Oi=R[2])==null?void 0:Oi.cardStats)==null?void 0:Mi.mature)||0)+"")&&re(Gt,Pe),et===(et=Se(R,se))&&Oe?Oe.p(R,se):(Oe.d(1),Oe=et(R),Oe&&(Oe.c(),Oe.m(It,null))),zt===(zt=tt(R,se))&&$e?$e.p(it(R,zt),se):($e.d(1),$e=zt(it(R,zt)),$e&&($e.c(),$e.m(Yt,null)));let Xe={};se[0]&1&&(Xe.getReviewCounts=R[22]),Qt.$set(Xe)},i(R){Ye||(Kn(Qt.$$.fragment,R),Ye=!0)},o(R){mr(Qt.$$.fragment,R),Ye=!1},d(R){R&&$(e),Ct(Qe,R),Ct(We,R),R&&$(O),R&&$(D),R&&$(Ne),R&&$(Fe),R&&$(dn),R&&$(rt),St.d(),R&&$(ft),R&&$(Te),gt.d(),q.d(),de.d(),R&&$(fn),R&&$(we),R&&$(Tr),R&&$(It),Oe.d(),R&&$(Rr),R&&$(Yt),$e.d(),R&&$(Lr),R&&$(xt),i[23](null),br(Qt),R&&$(Nr),R&&$($n),Or=!1,Ke(Kr)}}}h(xo,"create_else_block");function So(i){let e,n,s,o,a,u;return{c(){e=p("div"),n=p("p"),n.textContent="Failed to load statistics",s=w(),o=p("button"),o.textContent="Retry",d(o,"class","retry-button svelte-sqk1dc"),d(e,"class","error svelte-sqk1dc")},m(g,v){X(g,e,v),l(e,n),l(e,s),l(e,o),a||(u=me(o,"click",i[13]),a=!0)},p:ke,i:ke,o:ke,d(g){g&&$(e),a=!1,u()}}}h(So,"create_if_block_1");function Eo(i){let e;return{c(){e=p("div"),e.textContent="Loading statistics...",d(e,"class","loading svelte-sqk1dc")},m(n,s){X(n,e,s)},p:ke,i:ke,o:ke,d(n){n&&$(e)}}}h(Eo,"create_if_block");function Sa(i){let e,n,s=i[37]+"",o,a;return{c(){e=p("option"),n=U("Tag: "),o=U(s),e.__value=a="tag:"+i[37],e.value=e.__value,Ie(e,"background","var(--background-primary)",1),Ie(e,"color","var(--text-normal)",1),d(e,"class","svelte-sqk1dc")},m(u,g){X(u,e,g),l(e,n),l(e,o)},p(u,g){g[0]&64&&s!==(s=u[37]+"")&&re(o,s),g[0]&64&&a!==(a="tag:"+u[37])&&(e.__value=a,e.value=e.__value)},d(u){u&&$(e)}}}h(Sa,"create_each_block_2");function Ea(i){let e,n=i[34].name+"",s,o;return{c(){e=p("option"),s=U(n),e.__value=o="deck:"+i[34].id,e.value=e.__value,Ie(e,"background","var(--background-primary)",1),Ie(e,"color","var(--text-normal)",1),d(e,"class","svelte-sqk1dc")},m(a,u){X(a,e,u),l(e,s)},p(a,u){u[0]&32&&n!==(n=a[34].name+"")&&re(s,n),u[0]&32&&o!==(o="deck:"+a[34].id)&&(e.__value=o,e.value=e.__value)},d(a){a&&$(e)}}}h(Ea,"create_each_block_1");function Co(i){let e;return{c(){e=p("div"),e.innerHTML=`<p class="svelte-sqk1dc">No reviews today yet.</p> 
                    <p class="help-text svelte-sqk1dc">Start reviewing flashcards to see your daily statistics
                        here!</p>`,d(e,"class","no-data-message svelte-sqk1dc")},m(n,s){X(n,e,s)},p:ke,d(n){n&&$(e)}}}h(Co,"create_else_block_6");function Do(i){let e,n,s,o=i[8].reviews+"",a,u,g,v,m,x,S=en(i[8].timeSpent)+"",E,C,_,O,D,M,N,I,z,W=i[8].newCards+"",L,T,P,A,H,J,ee=i[8].learningCards+"",Z,ie,V,G,Q,B,te=i[8].reviewCards+"",ce,Me,ve;return{c(){e=p("div"),n=p("div"),s=p("div"),a=U(o),u=w(),g=p("div"),g.textContent="Cards Studied",v=w(),m=p("div"),x=p("div"),E=U(S),C=w(),_=p("div"),_.textContent="Time Spent",O=w(),D=p("h4"),D.textContent="Breakdown by Card Type",M=w(),N=p("div"),I=p("div"),z=p("div"),L=U(W),T=w(),P=p("div"),P.textContent="New Cards",A=w(),H=p("div"),J=p("div"),Z=U(ee),ie=w(),V=p("div"),V.textContent="Learning",G=w(),Q=p("div"),B=p("div"),ce=U(te),Me=w(),ve=p("div"),ve.textContent="Review",d(s,"class","stat-value svelte-sqk1dc"),d(g,"class","stat-label svelte-sqk1dc"),d(n,"class","stat-card svelte-sqk1dc"),d(x,"class","stat-value svelte-sqk1dc"),d(_,"class","stat-label svelte-sqk1dc"),d(m,"class","stat-card svelte-sqk1dc"),d(e,"class","stats-grid svelte-sqk1dc"),d(D,"class","svelte-sqk1dc"),d(z,"class","stat-value svelte-sqk1dc"),d(P,"class","stat-label svelte-sqk1dc"),d(I,"class","stat-card svelte-sqk1dc"),d(J,"class","stat-value svelte-sqk1dc"),d(V,"class","stat-label svelte-sqk1dc"),d(H,"class","stat-card svelte-sqk1dc"),d(B,"class","stat-value svelte-sqk1dc"),d(ve,"class","stat-label svelte-sqk1dc"),d(Q,"class","stat-card svelte-sqk1dc"),d(N,"class","stats-grid svelte-sqk1dc")},m(Y,be){X(Y,e,be),l(e,n),l(n,s),l(s,a),l(n,u),l(n,g),l(e,v),l(e,m),l(m,x),l(x,E),l(m,C),l(m,_),X(Y,O,be),X(Y,D,be),X(Y,M,be),X(Y,N,be),l(N,I),l(I,z),l(z,L),l(I,T),l(I,P),l(N,A),l(N,H),l(H,J),l(J,Z),l(H,ie),l(H,V),l(N,G),l(N,Q),l(Q,B),l(B,ce),l(Q,Me),l(Q,ve)},p(Y,be){be[0]&256&&o!==(o=Y[8].reviews+"")&&re(a,o),be[0]&256&&S!==(S=en(Y[8].timeSpent)+"")&&re(E,S),be[0]&256&&W!==(W=Y[8].newCards+"")&&re(L,W),be[0]&256&&ee!==(ee=Y[8].learningCards+"")&&re(Z,ee),be[0]&256&&te!==(te=Y[8].reviewCards+"")&&re(ce,te)},d(Y){Y&&$(e),Y&&$(O),Y&&$(D),Y&&$(M),Y&&$(N)}}}h(Do,"create_if_block_7");function Fo(i){let e;return{c(){e=p("div"),e.innerHTML='<p class="svelte-sqk1dc">No reviews this week yet.</p>',d(e,"class","no-data-message svelte-sqk1dc")},m(n,s){X(n,e,s)},p:ke,d(n){n&&$(e)}}}h(Fo,"create_else_block_5");function To(i){let e,n,s,o=i[9].reviews+"",a,u,g,v,m,x,S=en(i[9].timeSpent)+"",E,C,_,O,D,M,N=i[9].correctRate.toFixed(1)+"",I,z,W,L;return{c(){e=p("div"),n=p("div"),s=p("div"),a=U(o),u=w(),g=p("div"),g.textContent="Cards Studied",v=w(),m=p("div"),x=p("div"),E=U(S),C=w(),_=p("div"),_.textContent="Time Spent",O=w(),D=p("div"),M=p("div"),I=U(N),z=U("%"),W=w(),L=p("div"),L.textContent="Success Rate",d(s,"class","stat-value svelte-sqk1dc"),d(g,"class","stat-label svelte-sqk1dc"),d(n,"class","stat-card svelte-sqk1dc"),d(x,"class","stat-value svelte-sqk1dc"),d(_,"class","stat-label svelte-sqk1dc"),d(m,"class","stat-card svelte-sqk1dc"),d(M,"class","stat-value svelte-sqk1dc"),d(L,"class","stat-label svelte-sqk1dc"),d(D,"class","stat-card svelte-sqk1dc"),d(e,"class","stats-grid svelte-sqk1dc")},m(T,P){X(T,e,P),l(e,n),l(n,s),l(s,a),l(n,u),l(n,g),l(e,v),l(e,m),l(m,x),l(x,E),l(m,C),l(m,_),l(e,O),l(e,D),l(D,M),l(M,I),l(M,z),l(D,W),l(D,L)},p(T,P){P[0]&512&&o!==(o=T[9].reviews+"")&&re(a,o),P[0]&512&&S!==(S=en(T[9].timeSpent)+"")&&re(E,S),P[0]&512&&N!==(N=T[9].correctRate.toFixed(1)+"")&&re(I,N)},d(T){T&&$(e)}}}h(To,"create_if_block_6");function Ro(i){let e;return{c(){e=p("div"),e.innerHTML='<p class="svelte-sqk1dc">No reviews this month yet.</p>',d(e,"class","no-data-message svelte-sqk1dc")},m(n,s){X(n,e,s)},p:ke,d(n){n&&$(e)}}}h(Ro,"create_else_block_4");function Lo(i){let e,n,s,o=i[10].reviews+"",a,u,g,v,m,x,S=en(i[10].timeSpent)+"",E,C,_,O,D,M,N=i[10].correctRate.toFixed(1)+"",I,z,W,L;return{c(){e=p("div"),n=p("div"),s=p("div"),a=U(o),u=w(),g=p("div"),g.textContent="Cards Studied",v=w(),m=p("div"),x=p("div"),E=U(S),C=w(),_=p("div"),_.textContent="Time Spent",O=w(),D=p("div"),M=p("div"),I=U(N),z=U("%"),W=w(),L=p("div"),L.textContent="Success Rate",d(s,"class","stat-value svelte-sqk1dc"),d(g,"class","stat-label svelte-sqk1dc"),d(n,"class","stat-card svelte-sqk1dc"),d(x,"class","stat-value svelte-sqk1dc"),d(_,"class","stat-label svelte-sqk1dc"),d(m,"class","stat-card svelte-sqk1dc"),d(M,"class","stat-value svelte-sqk1dc"),d(L,"class","stat-label svelte-sqk1dc"),d(D,"class","stat-card svelte-sqk1dc"),d(e,"class","stats-grid svelte-sqk1dc")},m(T,P){X(T,e,P),l(e,n),l(n,s),l(s,a),l(n,u),l(n,g),l(e,v),l(e,m),l(m,x),l(x,E),l(m,C),l(m,_),l(e,O),l(e,D),l(D,M),l(M,I),l(M,z),l(D,W),l(D,L)},p(T,P){P[0]&1024&&o!==(o=T[10].reviews+"")&&re(a,o),P[0]&1024&&S!==(S=en(T[10].timeSpent)+"")&&re(E,S),P[0]&1024&&N!==(N=T[10].correctRate.toFixed(1)+"")&&re(I,N)},d(T){T&&$(e)}}}h(Lo,"create_if_block_5");function qo(i){let e;return{c(){e=p("div"),e.innerHTML='<p class="svelte-sqk1dc">No reviews this year yet.</p>',d(e,"class","no-data-message svelte-sqk1dc")},m(n,s){X(n,e,s)},p:ke,d(n){n&&$(e)}}}h(qo,"create_else_block_3");function No(i){let e,n,s,o=i[11].reviews+"",a,u,g,v,m,x,S=en(i[11].timeSpent)+"",E,C,_,O,D,M,N=i[11].correctRate.toFixed(1)+"",I,z,W,L;return{c(){e=p("div"),n=p("div"),s=p("div"),a=U(o),u=w(),g=p("div"),g.textContent="Cards Studied",v=w(),m=p("div"),x=p("div"),E=U(S),C=w(),_=p("div"),_.textContent="Time Spent",O=w(),D=p("div"),M=p("div"),I=U(N),z=U("%"),W=w(),L=p("div"),L.textContent="Success Rate",d(s,"class","stat-value svelte-sqk1dc"),d(g,"class","stat-label svelte-sqk1dc"),d(n,"class","stat-card svelte-sqk1dc"),d(x,"class","stat-value svelte-sqk1dc"),d(_,"class","stat-label svelte-sqk1dc"),d(m,"class","stat-card svelte-sqk1dc"),d(M,"class","stat-value svelte-sqk1dc"),d(L,"class","stat-label svelte-sqk1dc"),d(D,"class","stat-card svelte-sqk1dc"),d(e,"class","stats-grid svelte-sqk1dc")},m(T,P){X(T,e,P),l(e,n),l(n,s),l(s,a),l(n,u),l(n,g),l(e,v),l(e,m),l(m,x),l(x,E),l(m,C),l(m,_),l(e,O),l(e,D),l(D,M),l(M,I),l(M,z),l(D,W),l(D,L)},p(T,P){P[0]&2048&&o!==(o=T[11].reviews+"")&&re(a,o),P[0]&2048&&S!==(S=en(T[11].timeSpent)+"")&&re(E,S),P[0]&2048&&N!==(N=T[11].correctRate.toFixed(1)+"")&&re(I,N)},d(T){T&&$(e)}}}h(No,"create_if_block_4");function Oo(i){let e;return{c(){e=p("div"),e.innerHTML=`<p class="svelte-sqk1dc">No answer button data available yet.</p> 
                    <p class="help-text svelte-sqk1dc">Complete some reviews to see answer button statistics.</p>`,d(e,"class","no-data-message svelte-sqk1dc")},m(n,s){X(n,e,s)},p:ke,d(n){n&&$(e)}}}h(Oo,"create_else_block_2");function Mo(i){let e,n,s,o,a,u=i[2].answerButtons.again+"",g,v,m,x=(i[2].answerButtons.again/(i[2].answerButtons.again+i[2].answerButtons.hard+i[2].answerButtons.good+i[2].answerButtons.easy)*100).toFixed(1)+"",S,E,C,_,O,D,M,N=i[2].answerButtons.hard+"",I,z,W,L=(i[2].answerButtons.hard/(i[2].answerButtons.again+i[2].answerButtons.hard+i[2].answerButtons.good+i[2].answerButtons.easy)*100).toFixed(1)+"",T,P,A,H,J,ee,Z,ie=i[2].answerButtons.good+"",V,G,Q,B=(i[2].answerButtons.good/(i[2].answerButtons.again+i[2].answerButtons.hard+i[2].answerButtons.good+i[2].answerButtons.easy)*100).toFixed(1)+"",te,ce,Me,ve,Y,be,K,fe=i[2].answerButtons.easy+"",at,qe,Ne,Fe=(i[2].answerButtons.easy/(i[2].answerButtons.again+i[2].answerButtons.hard+i[2].answerButtons.good+i[2].answerButtons.easy)*100).toFixed(1)+"",ot,ye;return{c(){e=p("div"),n=p("div"),s=p("div"),s.textContent="Again",o=w(),a=p("div"),g=U(u),v=w(),m=p("div"),S=U(x),E=U("%"),C=w(),_=p("div"),O=p("div"),O.textContent="Hard",D=w(),M=p("div"),I=U(N),z=w(),W=p("div"),T=U(L),P=U("%"),A=w(),H=p("div"),J=p("div"),J.textContent="Good",ee=w(),Z=p("div"),V=U(ie),G=w(),Q=p("div"),te=U(B),ce=U("%"),Me=w(),ve=p("div"),Y=p("div"),Y.textContent="Easy",be=w(),K=p("div"),at=U(fe),qe=w(),Ne=p("div"),ot=U(Fe),ye=U("%"),d(s,"class","button-label svelte-sqk1dc"),d(a,"class","button-count svelte-sqk1dc"),d(m,"class","button-percentage svelte-sqk1dc"),d(n,"class","button-bar again svelte-sqk1dc"),d(O,"class","button-label svelte-sqk1dc"),d(M,"class","button-count svelte-sqk1dc"),d(W,"class","button-percentage svelte-sqk1dc"),d(_,"class","button-bar hard svelte-sqk1dc"),d(J,"class","button-label svelte-sqk1dc"),d(Z,"class","button-count svelte-sqk1dc"),d(Q,"class","button-percentage svelte-sqk1dc"),d(H,"class","button-bar good svelte-sqk1dc"),d(Y,"class","button-label svelte-sqk1dc"),d(K,"class","button-count svelte-sqk1dc"),d(Ne,"class","button-percentage svelte-sqk1dc"),d(ve,"class","button-bar easy svelte-sqk1dc"),d(e,"class","button-stats svelte-sqk1dc")},m(pe,De){X(pe,e,De),l(e,n),l(n,s),l(n,o),l(n,a),l(a,g),l(n,v),l(n,m),l(m,S),l(m,E),l(e,C),l(e,_),l(_,O),l(_,D),l(_,M),l(M,I),l(_,z),l(_,W),l(W,T),l(W,P),l(e,A),l(e,H),l(H,J),l(H,ee),l(H,Z),l(Z,V),l(H,G),l(H,Q),l(Q,te),l(Q,ce),l(e,Me),l(e,ve),l(ve,Y),l(ve,be),l(ve,K),l(K,at),l(ve,qe),l(ve,Ne),l(Ne,ot),l(Ne,ye)},p(pe,De){De[0]&4&&u!==(u=pe[2].answerButtons.again+"")&&re(g,u),De[0]&4&&x!==(x=(pe[2].answerButtons.again/(pe[2].answerButtons.again+pe[2].answerButtons.hard+pe[2].answerButtons.good+pe[2].answerButtons.easy)*100).toFixed(1)+"")&&re(S,x),De[0]&4&&N!==(N=pe[2].answerButtons.hard+"")&&re(I,N),De[0]&4&&L!==(L=(pe[2].answerButtons.hard/(pe[2].answerButtons.again+pe[2].answerButtons.hard+pe[2].answerButtons.good+pe[2].answerButtons.easy)*100).toFixed(1)+"")&&re(T,L),De[0]&4&&ie!==(ie=pe[2].answerButtons.good+"")&&re(V,ie),De[0]&4&&B!==(B=(pe[2].answerButtons.good/(pe[2].answerButtons.again+pe[2].answerButtons.hard+pe[2].answerButtons.good+pe[2].answerButtons.easy)*100).toFixed(1)+"")&&re(te,B),De[0]&4&&fe!==(fe=pe[2].answerButtons.easy+"")&&re(at,fe),De[0]&4&&Fe!==(Fe=(pe[2].answerButtons.easy/(pe[2].answerButtons.again+pe[2].answerButtons.hard+pe[2].answerButtons.good+pe[2].answerButtons.easy)*100).toFixed(1)+"")&&re(ot,Fe)},d(pe){pe&&$(e)}}}h(Mo,"create_if_block_3");function Ao(i){let e;return{c(){e=p("div"),e.innerHTML=`<p class="svelte-sqk1dc">No upcoming reviews scheduled.</p> 
                    <p class="help-text svelte-sqk1dc">Add flashcards to your decks to see future review
                        forecasts.</p>`,d(e,"class","no-data-message svelte-sqk1dc")},m(n,s){X(n,e,s)},p:ke,d(n){n&&$(e)}}}h(Ao,"create_else_block_1");function Ca(i){let e,n,s,o=i[28],a=[];for(let u=0;u<o.length;u+=1)a[u]=Da(ya(i,o,u));return{c(){e=p("div");for(let u=0;u<a.length;u+=1)a[u].c();n=w(),s=p("p"),s.textContent="Showing days with scheduled reviews based on FSRS intervals.",d(e,"class","forecast-chart svelte-sqk1dc"),d(s,"class","forecast-note svelte-sqk1dc")},m(u,g){X(u,e,g);for(let v=0;v<a.length;v+=1)a[v]&&a[v].m(e,null);X(u,n,g),X(u,s,g)},p(u,g){if(g[0]&4){o=u[28];let v;for(v=0;v<o.length;v+=1){let m=ya(u,o,v);a[v]?a[v].p(m,g):(a[v]=Da(m),a[v].c(),a[v].m(e,null))}for(;v<a.length;v+=1)a[v].d(1);a.length=o.length}},d(u){u&&$(e),Ct(a,u),u&&$(n),u&&$(s)}}}h(Ca,"create_if_block_2");function Da(i){let e,n,s,o,a=i[31]+"",u,g,v,m=i[30].dueCount+"",x,S,E;return{c(){e=p("div"),n=p("div"),s=w(),o=p("div"),u=U(a),g=w(),v=p("div"),x=U(m),S=w(),d(n,"class","bar svelte-sqk1dc"),Ie(n,"height",Ta(i[30].dueCount,i[29])+"px"),d(o,"class","bar-label svelte-sqk1dc"),d(v,"class","bar-value svelte-sqk1dc"),d(e,"class","forecast-bar svelte-sqk1dc"),d(e,"title",E=(i[31]===0?"Today":i[31]===1?"Tomorrow":`Day ${i[31]} (in ${i[31]} days)`)+": "+i[30].dueCount+" card"+(i[30].dueCount!==1?"s":"")+" due")},m(C,_){X(C,e,_),l(e,n),l(e,s),l(e,o),l(o,u),l(e,g),l(e,v),l(v,x),l(e,S)},p(C,_){_[0]&4&&Ie(n,"height",Ta(C[30].dueCount,C[29])+"px"),_[0]&4&&a!==(a=C[31]+"")&&re(u,a),_[0]&4&&m!==(m=C[30].dueCount+"")&&re(x,m),_[0]&4&&E!==(E=(C[31]===0?"Today":C[31]===1?"Tomorrow":`Day ${C[31]} (in ${C[31]} days)`)+": "+C[30].dueCount+" card"+(C[30].dueCount!==1?"s":"")+" due")&&d(e,"title",E)},d(C){C&&$(e)}}}h(Da,"create_each_block");function Io(i){let e,n,s,o,a=[Eo,So,xo],u=[];function g(v,m){return v[1]?0:v[2]?2:1}return h(g,"select_block_type"),n=g(i,[-1,-1]),s=u[n]=a[n](i),{c(){e=p("div"),s.c(),d(e,"class","statistics-container svelte-sqk1dc")},m(v,m){X(v,e,m),u[n].m(e,null),o=!0},p(v,m){let x=n;n=g(v,m),n===x?u[n].p(v,m):(Ki(),mr(u[x],1,1,()=>{u[x]=null}),Ji(),s=u[n],s?s.p(v,m):(s=u[n]=a[n](v),s.c()),Kn(s,1),s.m(e,null))},i(v){o||(Kn(s),o=!0)},o(v){mr(s),o=!1},d(v){v&&$(e),u[n].d()}}}h(Io,"create_fragment");function en(i){let e=Math.floor(i/60),n=Math.floor(e/60);return n>0?`${n}h ${e%60}m`:`${e}m`}h(en,"formatTime");function Fa(i){if(i<60)return`${i.toFixed(1)}s`;let e=Math.floor(i/60),n=Math.round(i%60);return`${e}m ${n}s`}h(Fa,"formatPace");function Ta(i,e){if(e===0)return 0;let s=i/e;return Math.max(s*400-80,10)}h(Ta,"calculateBarHeight");var zo=h(i=>i.dueCount>0,"func");function Po(i,e,n){let{plugin:s}=e,o=Qn(),a=!0,u=null,g="all",v="12months",m=[],x=[],S,E=null,C=null,_=null,O=null;cn(()=>Dt(void 0,void 0,void 0,function*(){n(1,a=!0),yield D(),yield M()}));function D(){return Dt(this,void 0,void 0,function*(){try{n(5,m=yield s.getDecks()),n(6,x=[...new Set(m.map(V=>V.tag))])}catch(V){console.error("Error loading decks and tags:",V)}})}h(D,"loadDecksAndTags");function M(){return Dt(this,void 0,void 0,function*(){try{n(2,u=yield s.getOverallStatistics(g,v)),console.log("Loaded statistics:",u),n(8,E=I()),n(9,C=z(7)),n(10,_=z(30)),n(11,O=z(365))}catch(V){console.error("Error loading statistics:",V),n(2,u={dailyStats:[],cardStats:{new:0,learning:0,mature:0},answerButtons:{again:0,hard:0,good:0,easy:0},retentionRate:0,intervals:[],forecast:[],averagePace:0,totalReviewTime:0}),n(8,E=null),n(9,C=null),n(10,_=null),n(11,O=null)}finally{n(1,a=!1)}})}h(M,"loadStatistics");function N(){return Dt(this,void 0,void 0,function*(){yield M()})}h(N,"handleFilterChange");function I(){if(!(u!=null&&u.dailyStats)||u.dailyStats.length===0)return null;let V=new Date().toISOString().split("T")[0];return u.dailyStats.find(G=>G.date===V)||u.dailyStats[0]||null}h(I,"getTodayStats");function z(V){if(!(u!=null&&u.dailyStats))return{reviews:0,timeSpent:0,newCards:0,learningCards:0,reviewCards:0,correctRate:0};let G=new Date;G.setDate(G.getDate()-V);let Q=G.toISOString().split("T")[0],B=u.dailyStats.filter(te=>te.date>=Q);return B.length===0?{reviews:0,timeSpent:0,newCards:0,learningCards:0,reviewCards:0,correctRate:0}:B.reduce((te,ce)=>({reviews:te.reviews+ce.reviews,timeSpent:te.timeSpent+ce.timeSpent,newCards:te.newCards+ce.newCards,learningCards:te.learningCards+ce.learningCards,reviewCards:te.reviewCards+ce.reviewCards,correctRate:te.reviews+ce.reviews>0?(te.correctRate*te.reviews+ce.correctRate*ce.reviews)/(te.reviews+ce.reviews):0}),{reviews:0,timeSpent:0,newCards:0,learningCards:0,reviewCards:0,correctRate:0})}h(z,"getTimeframeStats");function W(){if(!(u!=null&&u.answerButtons))return"0.00";let{again:V,hard:G,good:Q,easy:B}=u.answerButtons,te=V+G+Q+B;return te===0?"0.00":((V*1+G*2+Q*3+B*4)/te).toFixed(2)}h(W,"calculateAverageEase");function L(){if(!(u!=null&&u.intervals)||u.intervals.length===0)return 0;let V=0,G=0;if(u.intervals.forEach(B=>{let te=B.interval,ce=0;te.endsWith("h")?ce=parseInt(te)*60:te.endsWith("d")?ce=parseInt(te)*1440:te.endsWith("m")&&(ce=parseInt(te)*43200),V+=ce*B.count,G+=B.count}),G===0)return 0;let Q=V/G;return Math.round(Q/1440)}h(L,"calculateAverageInterval");function T(){if(!(u!=null&&u.forecast)||u.forecast.length===0)return 0;let V=new Date().toISOString().split("T")[0],G=u.forecast.find(Q=>Q.date===V);return G?G.dueCount:0}h(T,"getDueToday");function P(){if(!(u!=null&&u.forecast)||u.forecast.length===0)return 0;let V=new Date;V.setDate(V.getDate()+1);let G=V.toISOString().split("T")[0],Q=u.forecast.find(B=>B.date===G);return Q?Q.dueCount:0}h(P,"getDueTomorrow");function A(){if(!(u!=null&&u.cardStats))return"0.0";let{new:V,learning:G,mature:Q}=u.cardStats,B=V+G+Q;return B===0?"0.0":(Q/B*100).toFixed(1)}h(A,"getMaturityRatio");function H(){g=Hr(this),n(3,g),n(5,m),n(6,x)}h(H,"select0_change_handler");function J(){v=Hr(this),n(4,v)}h(J,"select1_change_handler");let ee=h(async V=>await s.getReviewCounts(V),"func_3");function Z(V){Pt[V?"unshift":"push"](()=>{S=V,n(7,S)})}h(Z,"reviewheatmap_binding");let ie=h(()=>o("close"),"click_handler");return i.$$set=V=>{"plugin"in V&&n(0,s=V.plugin)},[s,a,u,g,v,m,x,S,E,C,_,O,o,M,N,W,L,T,P,A,H,J,ee,Z,ie]}h(Po,"instance");var As=class As extends Et{constructor(e){super(),Zt(this,e,Po,Io,Kt,{plugin:0},yo,[-1,-1])}};h(As,"StatisticsUI");var Ms=As,Ra=Ms;var Is=class Is extends La.Modal{constructor(n){super(n.app);this.component=null;this.plugin=n}onOpen(){let{contentEl:n}=this;n.empty();let s=this.containerEl.querySelector(".modal");s&&(s.style.width="600px",s.style.maxWidth="90vw",s.style.height="80vh",s.style.maxHeight="80vh",s.style.margin="auto",s.style.position="fixed",s.style.top="50%",s.style.left="50%",s.style.transform="translate(-50%, -50%)"),this.containerEl.style.display="flex",this.containerEl.style.alignItems="center",this.containerEl.style.justifyContent="center",this.containerEl.style.position="fixed",this.containerEl.style.top="0",this.containerEl.style.left="0",this.containerEl.style.width="100vw",this.containerEl.style.height="100vh",this.containerEl.style.zIndex="1000",n.style.overflow="hidden",n.style.height="100%";let o=n.createEl("h2",{text:"Overall Statistics"});o.style.margin="0 0 16px 0",o.style.padding="0 20px";let a=n.createDiv("statistics-container");a.style.padding="0",a.style.margin="0",a.style.height="calc(80vh - 60px)",a.style.width="100%",a.style.overflowY="auto",a.style.overflowX="hidden",this.component=new Ra({target:a,props:{plugin:this.plugin}}),this.component.$on("close",()=>{this.close()})}onClose(){let{contentEl:n}=this;this.component&&(this.component.$destroy(),this.component=null),n.empty()}};h(Is,"StatisticsModal");var fs=Is;var ps=require("obsidian");function Bo(i){Jt(i,"svelte-1opyfa1",".review-modal.svelte-1opyfa1.svelte-1opyfa1{display:flex;flex-direction:column;height:100%;background:var(--background-primary);color:var(--text-normal);overflow:hidden;width:100%}.modal-header.svelte-1opyfa1.svelte-1opyfa1{display:flex;align-items:center;justify-content:space-between;padding:16px 20px;border-bottom:1px solid var(--background-modifier-border)}.modal-header.svelte-1opyfa1 h3.svelte-1opyfa1{margin:0;font-size:18px;font-weight:600}.progress-info.svelte-1opyfa1.svelte-1opyfa1{display:flex;gap:8px;font-size:14px}.remaining.svelte-1opyfa1.svelte-1opyfa1{color:var(--text-muted)}.review-progress-bar.svelte-1opyfa1.svelte-1opyfa1{height:4px;background:var(--background-modifier-border);position:relative}.progress-fill.svelte-1opyfa1.svelte-1opyfa1{height:100%;background:var(--interactive-accent);transition:width 0.3s ease}.card-content.svelte-1opyfa1.svelte-1opyfa1{flex:1;overflow-y:auto;overflow-x:hidden;padding:32px 16px;display:flex;flex-direction:column;align-items:center;justify-content:flex-start;gap:24px;width:100%;box-sizing:border-box;min-height:0}.question-section.svelte-1opyfa1.svelte-1opyfa1,.answer-section.svelte-1opyfa1.svelte-1opyfa1{width:100%;display:flex;justify-content:center}.card-side.svelte-1opyfa1.svelte-1opyfa1{background:var(--background-secondary);border:1px solid var(--background-modifier-border);border-radius:8px;padding:24px;min-height:100px;width:100%;max-width:600px;box-sizing:border-box;word-wrap:break-word;overflow-wrap:break-word}.card-side.front.svelte-1opyfa1.svelte-1opyfa1{text-align:center;font-size:20px;font-weight:500}.card-side.back.svelte-1opyfa1.svelte-1opyfa1{font-size:16px;line-height:1.6}.answer-section.svelte-1opyfa1.svelte-1opyfa1{width:100%;display:flex;flex-direction:column;justify-content:center;align-items:center}.answer-section.hidden.svelte-1opyfa1.svelte-1opyfa1{display:none}.separator.svelte-1opyfa1.svelte-1opyfa1{height:1px;background:var(--background-modifier-border);margin:16px auto;width:100%;max-width:600px}.action-buttons.svelte-1opyfa1.svelte-1opyfa1{padding:20px;border-top:1px solid var(--background-modifier-border);flex-shrink:0;width:100%;box-sizing:border-box}.show-answer-button.svelte-1opyfa1.svelte-1opyfa1{width:100%;max-width:400px;margin:0 auto;padding:12px 24px;font-size:16px;font-weight:500;background:var(--interactive-accent);color:var(--text-on-accent);border:none;border-radius:6px;cursor:pointer;display:flex;align-items:center;justify-content:center;gap:8px;box-sizing:border-box}.show-answer-button.svelte-1opyfa1.svelte-1opyfa1:hover{background:var(--interactive-accent-hover)}.shortcut.svelte-1opyfa1.svelte-1opyfa1{font-size:12px;opacity:0.8;padding:2px 6px;background:rgba(0, 0, 0, 0.2);border-radius:3px;margin-left:8px;display:inline-block}.difficulty-buttons.svelte-1opyfa1.svelte-1opyfa1{display:flex;gap:8px;justify-content:center;flex-wrap:nowrap;padding:0 10px;box-sizing:border-box;width:100%;max-width:600px;margin:0 auto}.difficulty-button.svelte-1opyfa1.svelte-1opyfa1{flex:1;min-width:0;padding:10px 6px;border:1px solid var(--background-modifier-border);background:var(--background-secondary);border-radius:6px;cursor:pointer;display:flex;flex-direction:column;align-items:center;gap:2px;transition:all 0.2s ease;position:relative;box-sizing:border-box;white-space:nowrap}.difficulty-button.svelte-1opyfa1.svelte-1opyfa1:hover{transform:translateY(-2px);box-shadow:0 4px 12px rgba(0, 0, 0, 0.1)}.difficulty-button.svelte-1opyfa1.svelte-1opyfa1:disabled{opacity:0.5;cursor:not-allowed;transform:none}.difficulty-button.again.svelte-1opyfa1.svelte-1opyfa1{border-color:#e74c3c}.difficulty-button.again.svelte-1opyfa1.svelte-1opyfa1:hover:not(:disabled){background:#e74c3c;color:white}.difficulty-button.hard.svelte-1opyfa1.svelte-1opyfa1{border-color:#f39c12}.difficulty-button.hard.svelte-1opyfa1.svelte-1opyfa1:hover:not(:disabled){background:#f39c12;color:white}.difficulty-button.good.svelte-1opyfa1.svelte-1opyfa1{border-color:#27ae60}.difficulty-button.good.svelte-1opyfa1.svelte-1opyfa1:hover:not(:disabled){background:#27ae60;color:white}.difficulty-button.easy.svelte-1opyfa1.svelte-1opyfa1{border-color:#3498db}.difficulty-button.easy.svelte-1opyfa1.svelte-1opyfa1:hover:not(:disabled){background:#3498db;color:white}.button-label.svelte-1opyfa1.svelte-1opyfa1{font-weight:600;font-size:13px}.interval.svelte-1opyfa1.svelte-1opyfa1{font-size:11px;color:var(--text-muted)}.difficulty-button.svelte-1opyfa1:hover .interval.svelte-1opyfa1{color:inherit}.difficulty-button.svelte-1opyfa1 .shortcut.svelte-1opyfa1{position:absolute;top:2px;right:2px;font-size:9px;padding:1px 3px;background:var(--background-modifier-border);border-radius:2px;opacity:0.7}.empty-state.svelte-1opyfa1.svelte-1opyfa1{flex:1;display:flex;align-items:center;justify-content:center;padding:32px;color:var(--text-muted)}.card-side h1,.card-side h2,.card-side h3,.card-side h4,.card-side h5,.card-side h6{margin-top:0;margin-bottom:16px}.card-side p{margin-bottom:16px}.card-side p:last-child{margin-bottom:0}.card-side > *:first-child{margin-top:0}.card-side ul,.card-side ol{margin-bottom:16px;padding-left:24px}.card-side code{background:var(--code-background);padding:2px 4px;border-radius:3px;font-size:0.9em}.card-side pre{background:var(--code-background);padding:16px;border-radius:6px;overflow-x:auto;margin-bottom:16px;max-width:100%}.card-side blockquote{border-left:3px solid var(--blockquote-border);padding-left:16px;margin-left:0;margin-right:0;color:var(--text-muted)}@media(max-width: 500px){.difficulty-buttons.svelte-1opyfa1.svelte-1opyfa1{gap:4px;padding:0 5px}.difficulty-button.svelte-1opyfa1.svelte-1opyfa1{padding:8px 4px}.button-label.svelte-1opyfa1.svelte-1opyfa1{font-size:12px}.interval.svelte-1opyfa1.svelte-1opyfa1{font-size:10px}.difficulty-button.svelte-1opyfa1 .shortcut.svelte-1opyfa1{font-size:8px;padding:1px 2px}.card-content.svelte-1opyfa1.svelte-1opyfa1{padding:16px 8px}}")}h(Bo,"add_css");function qa(i){let e,n;return{c(){e=p("div"),n=p("div"),d(n,"class","progress-fill svelte-1opyfa1"),Ie(n,"width",i[11]+"%"),d(e,"class","review-progress-bar svelte-1opyfa1")},m(s,o){X(s,e,o),l(e,n)},p(s,o){o&2048&&Ie(n,"width",s[11]+"%")},d(s){s&&$(e)}}}h(qa,"create_if_block_3");function jo(i){let e;return{c(){e=p("div"),e.innerHTML="<p>No cards to review</p>",d(e,"class","empty-state svelte-1opyfa1")},m(n,s){X(n,e,s)},p:ke,d(n){n&&$(e)}}}h(jo,"create_else_block");function Ho(i){let e,n,s,o,a,u,g,v,m,x,S,E=!i[5]&&Na(i),C=i[5]&&i[9]&&Oa(i);return{c(){e=p("div"),n=p("div"),s=p("div"),o=w(),a=p("div"),u=p("div"),g=w(),v=p("div"),m=w(),x=p("div"),E&&E.c(),S=w(),C&&C.c(),d(s,"class","card-side front svelte-1opyfa1"),d(n,"class","question-section svelte-1opyfa1"),d(u,"class","separator svelte-1opyfa1"),d(v,"class","card-side back svelte-1opyfa1"),d(a,"class","answer-section svelte-1opyfa1"),Ee(a,"hidden",!i[5]),d(e,"class","card-content svelte-1opyfa1"),d(x,"class","action-buttons svelte-1opyfa1")},m(_,O){X(_,e,O),l(e,n),l(n,s),i[19](s),l(e,o),l(e,a),l(a,u),l(a,g),l(a,v),i[20](v),X(_,m,O),X(_,x,O),E&&E.m(x,null),l(x,S),C&&C.m(x,null)},p(_,O){O&32&&Ee(a,"hidden",!_[5]),_[5]?E&&(E.d(1),E=null):E?E.p(_,O):(E=Na(_),E.c(),E.m(x,S)),_[5]&&_[9]?C?C.p(_,O):(C=Oa(_),C.c(),C.m(x,null)):C&&(C.d(1),C=null)},d(_){_&&$(e),i[19](null),i[20](null),_&&$(m),_&&$(x),E&&E.d(),C&&C.d()}}}h(Ho,"create_if_block");function Na(i){let e,n,s;return{c(){e=p("button"),e.innerHTML=`<span>Show Answer</span> 
                    <span class="shortcut svelte-1opyfa1">Space</span>`,d(e,"class","show-answer-button svelte-1opyfa1")},m(o,a){X(o,e,a),n||(s=me(e,"click",i[12]),n=!0)},p:ke,d(o){o&&$(e),n=!1,s()}}}h(Na,"create_if_block_2");function Oa(i){let e,n,s,o,a,u=i[14](i[9].again.interval)+"",g,v,m,x,S,E,C,_,O=i[14](i[9].hard.interval)+"",D,M,N,I,z,W,L,T,P=i[14](i[9].good.interval)+"",A,H,J,ee,Z,ie,V,G,Q=i[14](i[9].easy.interval)+"",B,te,ce,Me,ve;return{c(){e=p("div"),n=p("button"),s=p("div"),s.textContent="Again",o=w(),a=p("div"),g=U(u),v=w(),m=p("div"),m.textContent="1",x=w(),S=p("button"),E=p("div"),E.textContent="Hard",C=w(),_=p("div"),D=U(O),M=w(),N=p("div"),N.textContent="2",I=w(),z=p("button"),W=p("div"),W.textContent="Good",L=w(),T=p("div"),A=U(P),H=w(),J=p("div"),J.textContent="3",ee=w(),Z=p("button"),ie=p("div"),ie.textContent="Easy",V=w(),G=p("div"),B=U(Q),te=w(),ce=p("div"),ce.textContent="4",d(s,"class","button-label svelte-1opyfa1"),d(a,"class","interval svelte-1opyfa1"),d(m,"class","shortcut svelte-1opyfa1"),d(n,"class","difficulty-button again svelte-1opyfa1"),n.disabled=i[6],d(E,"class","button-label svelte-1opyfa1"),d(_,"class","interval svelte-1opyfa1"),d(N,"class","shortcut svelte-1opyfa1"),d(S,"class","difficulty-button hard svelte-1opyfa1"),S.disabled=i[6],d(W,"class","button-label svelte-1opyfa1"),d(T,"class","interval svelte-1opyfa1"),d(J,"class","shortcut svelte-1opyfa1"),d(z,"class","difficulty-button good svelte-1opyfa1"),z.disabled=i[6],d(ie,"class","button-label svelte-1opyfa1"),d(G,"class","interval svelte-1opyfa1"),d(ce,"class","shortcut svelte-1opyfa1"),d(Z,"class","difficulty-button easy svelte-1opyfa1"),Z.disabled=i[6],d(e,"class","difficulty-buttons svelte-1opyfa1")},m(Y,be){X(Y,e,be),l(e,n),l(n,s),l(n,o),l(n,a),l(a,g),l(n,v),l(n,m),l(e,x),l(e,S),l(S,E),l(S,C),l(S,_),l(_,D),l(S,M),l(S,N),l(e,I),l(e,z),l(z,W),l(z,L),l(z,T),l(T,A),l(z,H),l(z,J),l(e,ee),l(e,Z),l(Z,ie),l(Z,V),l(Z,G),l(G,B),l(Z,te),l(Z,ce),Me||(ve=[me(n,"click",i[21]),me(S,"click",i[22]),me(z,"click",i[23]),me(Z,"click",i[24])],Me=!0)},p(Y,be){be&512&&u!==(u=Y[14](Y[9].again.interval)+"")&&re(g,u),be&64&&(n.disabled=Y[6]),be&512&&O!==(O=Y[14](Y[9].hard.interval)+"")&&re(D,O),be&64&&(S.disabled=Y[6]),be&512&&P!==(P=Y[14](Y[9].good.interval)+"")&&re(A,P),be&64&&(z.disabled=Y[6]),be&512&&Q!==(Q=Y[14](Y[9].easy.interval)+"")&&re(B,Q),be&64&&(Z.disabled=Y[6])},d(Y){Y&&$(e),Me=!1,Ke(ve)}}}h(Oa,"create_if_block_1");function Uo(i){var H,J;let e,n,s,o,a=i[2].name+"",u,g,v,m,x=i[0]+1+"",S,E,C=i[1].length+"",_,O,D,M,N,I,z,W,L=((J=(H=i[3])==null?void 0:H.review)==null?void 0:J.showProgress)!==!1&&qa(i);function T(ee,Z){return ee[4]?Ho:jo}h(T,"select_block_type");let P=T(i,-1),A=P(i);return{c(){e=p("div"),n=p("div"),s=p("h3"),o=U("Review Session - "),u=U(a),g=w(),v=p("div"),m=p("span"),S=U(x),E=U(" / "),_=U(C),O=w(),D=p("span"),M=U("("),N=U(i[10]),I=U(" remaining)"),z=w(),L&&L.c(),W=w(),A.c(),d(s,"class","svelte-1opyfa1"),d(D,"class","remaining svelte-1opyfa1"),d(v,"class","progress-info svelte-1opyfa1"),d(n,"class","modal-header svelte-1opyfa1"),d(e,"class","review-modal svelte-1opyfa1")},m(ee,Z){X(ee,e,Z),l(e,n),l(n,s),l(s,o),l(s,u),l(n,g),l(n,v),l(v,m),l(m,S),l(m,E),l(m,_),l(v,O),l(v,D),l(D,M),l(D,N),l(D,I),l(e,z),L&&L.m(e,null),l(e,W),A.m(e,null)},p(ee,[Z]){var ie,V;Z&4&&a!==(a=ee[2].name+"")&&re(u,a),Z&1&&x!==(x=ee[0]+1+"")&&re(S,x),Z&2&&C!==(C=ee[1].length+"")&&re(_,C),Z&1024&&re(N,ee[10]),((V=(ie=ee[3])==null?void 0:ie.review)==null?void 0:V.showProgress)!==!1?L?L.p(ee,Z):(L=qa(ee),L.c(),L.m(e,W)):L&&(L.d(1),L=null),P===(P=T(ee,Z))&&A?A.p(ee,Z):(A.d(1),A=P(ee),A&&(A.c(),A.m(e,null)))},i:ke,o:ke,d(ee){ee&&$(e),L&&L.d(),A.d()}}}h(Uo,"create_fragment");function Wo(i,e,n){let s,o,a,{flashcards:u=[]}=e,{deck:g}=e,{currentIndex:v=0}=e,{onClose:m}=e,{onReview:x}=e,{renderMarkdown:S}=e,{settings:E}=e,{onCardReviewed:C=void 0}=e,_=Qn(),O=new Cn,D=!1,M=!1,N,I,z=null,W=0,L=0;function T(){s&&(n(5,D=!1),n(9,z=O.getSchedulingInfo(s)),L=Date.now(),N&&(n(7,N.innerHTML="",N),S(s.front,N)),ls().then(()=>{I&&(n(8,I.innerHTML="",I),S(s.back,I))}))}h(T,"loadCard");function P(){n(5,D=!0),ls().then(()=>{I&&s&&(n(8,I.innerHTML="",I),S(s.back,I))})}h(P,"revealAnswer");function A(B){return Dt(this,void 0,void 0,function*(){if(!(!s||M)){n(6,M=!0);try{let te=Date.now()-L;yield x(s,B,te),W++,C&&(yield C(s)),v<u.length-1?(n(0,v++,v),T()):(_("complete",{reason:"no-more-cards",reviewed:W}),m())}catch(te){console.error("Error reviewing card:",te)}finally{n(6,M=!1)}}})}h(A,"handleDifficulty");function H(B){return Cn.getIntervalDisplay(B)}h(H,"getIntervalDisplay");function J(B){if(!M){if(!D&&B.key===" ")B.preventDefault(),P();else if(D)switch(B.key){case"1":A("again");break;case"2":A("hard");break;case"3":case" ":A("good");break;case"4":A("easy");break}}}h(J,"handleKeydown"),cn(()=>(T(),window.addEventListener("keydown",J),()=>{window.removeEventListener("keydown",J)}));function ee(B){Pt[B?"unshift":"push"](()=>{N=B,n(7,N)})}h(ee,"div0_binding");function Z(B){Pt[B?"unshift":"push"](()=>{I=B,n(8,I)})}h(Z,"div3_binding");let ie=h(()=>A("again"),"click_handler"),V=h(()=>A("hard"),"click_handler_1"),G=h(()=>A("good"),"click_handler_2"),Q=h(()=>A("easy"),"click_handler_3");return i.$$set=B=>{"flashcards"in B&&n(1,u=B.flashcards),"deck"in B&&n(2,g=B.deck),"currentIndex"in B&&n(0,v=B.currentIndex),"onClose"in B&&n(15,m=B.onClose),"onReview"in B&&n(16,x=B.onReview),"renderMarkdown"in B&&n(17,S=B.renderMarkdown),"settings"in B&&n(3,E=B.settings),"onCardReviewed"in B&&n(18,C=B.onCardReviewed)},i.$$.update=()=>{i.$$.dirty&3&&n(4,s=u[v]||null),i.$$.dirty&3&&n(11,o=u.length>0?v/u.length*100:0),i.$$.dirty&3&&n(10,a=u.length-v),i.$$.dirty&16&&s&&T()},[v,u,g,E,s,D,M,N,I,z,a,o,P,A,H,m,x,S,C,ee,Z,ie,V,G,Q]}h(Wo,"instance");var Ps=class Ps extends Et{constructor(e){super(),Zt(this,e,Wo,Uo,Kt,{flashcards:1,deck:2,currentIndex:0,onClose:15,onReview:16,renderMarkdown:17,settings:3,onCardReviewed:18},Bo)}};h(Ps,"FlashcardReviewModal");var zs=Ps,Ma=zs;var Bs=class Bs extends ps.Modal{constructor(n,s,o,a){super(n);this.component=null;this.markdownComponents=[];this.plugin=s,this.deck=o,this.flashcards=a}async onOpen(){let{contentEl:n}=this;n.empty(),n.addClass("deck-review-modal");let s=n.createDiv();this.component=new Ma({target:s,props:{flashcards:this.flashcards,deck:this.deck,currentIndex:0,onClose:()=>this.close(),onReview:async(o,a,u)=>{await this.plugin.reviewFlashcard(o,a,u)},renderMarkdown:(o,a)=>{let u=this.plugin.renderMarkdown(o,a);u&&this.markdownComponents.push(u)},settings:this.plugin.settings,onCardReviewed:async o=>{this.plugin.view&&o&&await this.plugin.view.refreshStatsById(o.deckId)}}}),this.component.$on("complete",o=>{let{reason:a,reviewed:u}=o.detail,g=`Review session complete for ${this.deck.name}!`;a==="no-more-cards"&&(g=`All available cards reviewed! Completed ${u} cards from ${this.deck.name}.`),new ps.Notice(g),this.plugin.view&&this.plugin.view.refresh()})}onClose(){this.component&&(this.component.$destroy(),this.component=null),this.markdownComponents.forEach(n=>n.unload()),this.markdownComponents=[],this.plugin.view&&this.plugin.view.refresh()}};h(Bs,"FlashcardReviewModalWrapper");var hs=Bs;var Wr="decks-view",$o=".obsidian/plugins/decks/flashcards.db",Hs=class Hs extends Je.Plugin{constructor(){super(...arguments);this.view=null}debugLog(n,...s){var o,a;(a=(o=this.settings)==null?void 0:o.debug)!=null&&a.enableLogging&&console.log(`[Decks Debug] ${n}`,...s)}async onload(){console.log("Loading Decks plugin"),await this.loadSettings();try{let n=this.app.vault.adapter,s=".obsidian/plugins/decks";await n.exists(s)||await n.mkdir(s);let o=this.settings.database.customPath||$o;this.db=new ns(o),await this.db.initialize(),this.deckManager=new rs(this.app.vault,this.app.metadataCache,this.db,this),this.fsrs=new Cn({requestRetention:this.settings.fsrs.requestRetention,maximumInterval:this.settings.fsrs.maximumInterval,easyBonus:this.settings.fsrs.easyBonus,hardInterval:this.settings.fsrs.hardInterval,w:this.settings.fsrs.weights}),this.registerView(Wr,a=>new js(a,this)),this.app.workspace.onLayoutReady(()=>{setTimeout(()=>{this.performSync()},2e3)}),this.addRibbonIcon("brain","Flashcards",()=>{this.activateView()}),this.addCommand({id:"show-flashcards-panel",name:"Show Flashcards Panel",callback:()=>{this.activateView()}}),this.registerEvent(this.app.vault.on("modify",async a=>{a instanceof Je.TFile&&a.extension==="md"&&await this.handleFileChange(a)})),this.registerEvent(this.app.vault.on("delete",async a=>{a instanceof Je.TFile&&a.extension==="md"&&await this.handleFileDelete(a)})),this.loadStyles(),this.addSettingTab(new is(this.app,this)),console.log("Decks plugin loaded successfully")}catch(n){console.error("Error loading Decks plugin:",n),new Je.Notice("Failed to load Decks plugin. Check console for details.")}}async onunload(){console.log("Unloading Decks plugin"),this.db&&await this.db.close(),this.app.workspace.detachLeavesOfType(Wr)}async loadSettings(){let n=await this.loadData();this.settings=Object.assign({},ss,n),this.settings.debug||(this.settings.debug=ss.debug,await this.saveSettings())}async saveSettings(){await this.saveData(this.settings),this.fsrs=new Cn({requestRetention:this.settings.fsrs.requestRetention,maximumInterval:this.settings.fsrs.maximumInterval,easyBonus:this.settings.fsrs.easyBonus,hardInterval:this.settings.fsrs.hardInterval,w:this.settings.fsrs.weights})}loadStyles(){let n=document.createElement("style");n.id="decks-plugin-styles",n.textContent=`
      /* Custom styles for decks plugin */
      .decks-view {
        padding: 0;
        overflow: hidden;
      }

      /* Reset checkbox/toggle styles that interfere with plugin UI */
      .decks-view .checkbox-container::after,
      .deck-review-modal .checkbox-container::after {
        display: none !important;
        content: none !important;
        pointer-events: none !important;
        position: static !important;
        background-color: transparent !important;
        width: auto !important;
        height: auto !important;
        margin: 0 !important;
        border-radius: 0 !important;
        transition: none !important;
        left: auto !important;
        transform: none !important;
        box-shadow: none !important;
      }

      /* Modal styles */
      .deck-review-modal {
        height: 90vh;
        max-height: 700px;
      }

      .deck-review-modal .modal-content {
        display: flex;
        flex-direction: column;
        height: 100%;
        overflow: hidden;
        padding: 0;
      }

      .deck-review-modal .modal {
        height: 90vh;
        max-height: 700px;
        width: 90vw;
        max-width: 900px;
        display: flex;
        flex-direction: column;
        overflow: hidden;
      }

      .deck-review-modal .modal-container {
        overflow: hidden;
        width: 100%;
        height: 100%;
        max-height: 700px;
      }
    `,document.head.appendChild(n)}async activateView(){let{workspace:n}=this.app,s=null,o=n.getLeavesOfType(Wr);o.length>0?s=o[0]:(s=n.getRightLeaf(!1),s&&await s.setViewState({type:Wr,active:!0})),s&&(n.revealLeaf(s),(await this.db.getAllDecks()).length===0&&(this.debugLog("No decks found, triggering fallback sync..."),await this.performSync()))}async handleFileChange(n){let s=this.app.metadataCache.getFileCache(n);if(this.debugLog(`File changed: ${n.path}, metadata:`,s),!s)return;let o=[];if(s.tags&&o.push(...s.tags.map(u=>u.tag)),s.frontmatter&&s.frontmatter.tags){let u=Array.isArray(s.frontmatter.tags)?s.frontmatter.tags:[s.frontmatter.tags];o.push(...u.map(g=>g.startsWith("#")?g:`#${g}`))}let a=o.some(u=>u.startsWith("#flashcards"));if(this.debugLog(`File ${n.path} has flashcards tag:`,a),a){let u=await this.db.getDeckByFilepath(n.path);if(u){let g=o.find(v=>v.startsWith("#flashcards"))||"#flashcards";u.tag!==g&&(this.debugLog(`Updating deck tag from ${u.tag} to ${g}`),await this.db.updateDeck(u.id,{tag:g})),await this.deckManager.syncFlashcardsForDeck(n.path),this.view&&await this.view.refreshStatsById(u.id)}else{let g=o.find(v=>v.startsWith("#flashcards"))||"#flashcards";await this.deckManager.createDeckForFile(n.path,g),await this.deckManager.syncFlashcardsForDeck(n.path),this.view&&await this.view.refreshStats()}}}async performSync(){try{this.debugLog("Performing sync of decks and flashcards..."),await this.deckManager.syncDecks();let n=await this.db.getAllDecks();this.debugLog(`Found ${n.length} decks after sync:`,n.map(s=>s.name));for(let s of n){this.debugLog(`Syncing flashcards for deck: ${s.name} (${s.filepath})`),await this.deckManager.syncFlashcardsForDeck(s.filepath);let o=await this.db.getFlashcardsByDeck(s.id);this.debugLog(`Deck ${s.name} now has ${o.length} flashcards`)}if(this.debugLog(`Sync completed for ${n.length} decks`),this.view){let s=await this.getDecks(),o=await this.getDeckStats();this.view.update(s,o)}}catch(n){console.error("Error during initial sync:",n)}}async handleFileDelete(n){await this.db.deleteDeckByFilepath(n.path),this.view&&await this.view.refreshStats()}async syncDecks(){await this.deckManager.syncDecks()}async syncFlashcardsForDeck(n){await this.deckManager.syncFlashcardsForDeckByName(n)}async getReviewCounts(n=365){return await this.db.getReviewCountsByDate(n)}async getDecks(){return await this.db.getAllDecks()}async getDeckStats(){let n=await this.db.getAllDeckStats(),s=new Map;for(let o of n)s.set(o.deckId,o);return s}async getDueFlashcards(n){return await this.db.getDueFlashcards(n)}async getFlashcardsByDeck(n){return await this.db.getFlashcardsByDeck(n)}async getReviewableFlashcards(n){return await this.db.getReviewableFlashcards(n)}async getDailyReviewCounts(n){return await this.db.getDailyReviewCounts(n)}async getDeckStatsById(n){return await this.db.getDeckStats(n)}async updateDeckConfig(n,s){await this.db.updateDeck(n,{config:s}),this.view&&await this.view.refreshStatsById(n)}async reviewFlashcard(n,s,o){let a=this.fsrs.updateCard(n,s);await this.db.updateFlashcard(a.id,{state:a.state,dueDate:a.dueDate,interval:a.interval,repetitions:a.repetitions,easeFactor:a.easeFactor,stability:a.stability,lapses:a.lapses,lastReviewed:a.lastReviewed}),await this.db.createReviewLog({flashcardId:n.id,reviewedAt:new Date().toISOString(),difficulty:s,oldInterval:n.interval,newInterval:a.interval,oldEaseFactor:n.easeFactor,newEaseFactor:a.easeFactor,timeElapsed:o!=null?o:0}),await this.db.updateDeckLastReviewed(n.deckId),this.view&&(await this.view.refreshStatsById(n.deckId),await this.view.refreshHeatmap())}async getOverallStatistics(n="all",s="12months"){return await this.db.getOverallStatistics(n,s)}openStatisticsModal(){new fs(this).open()}renderMarkdown(n,s){let o=new Je.Component;return o.load(),Je.MarkdownRenderer.renderMarkdown(n,s,"",o),o}};h(Hs,"DecksPlugin");var vs=Hs,Us=class Us extends Je.ItemView{constructor(n,s){super(n);this.component=null;this.markdownComponents=[];this.statsRefreshTimeout=null;this.backgroundRefreshInterval=null;this.plugin=s,this.plugin.view=this}getViewType(){return Wr}getDisplayText(){return"Decks"}getIcon(){return"brain"}async onOpen(){let n=this.containerEl.children[1];n.empty(),n.addClass("decks-view"),this.component=new _a({target:n,props:{onDeckClick:s=>this.startReview(s),onRefresh:async()=>{this.plugin.debugLog("onRefresh callback invoked"),await this.refresh()},getReviewCounts:async s=>await this.plugin.getReviewCounts(s),onUpdateDeckConfig:async(s,o)=>{await this.plugin.updateDeckConfig(s,o)},onOpenStatistics:()=>{this.plugin.openStatisticsModal()},plugin:this.plugin}}),await this.refresh(),this.plugin.settings.ui.enableBackgroundRefresh&&this.startBackgroundRefresh()}async onClose(){this.component&&(this.component.$destroy(),this.component=null),this.statsRefreshTimeout&&(clearTimeout(this.statsRefreshTimeout),this.statsRefreshTimeout=null),this.stopBackgroundRefresh(),this.markdownComponents.forEach(n=>n.unload()),this.markdownComponents=[],this.plugin.view===this&&(this.plugin.view=null)}async update(n,s){var o,a;(o=this.component)==null||o.updateDecks(n),(a=this.component)==null||a.updateStats(s)}async refresh(){this.plugin.debugLog("DecksView.refresh() called");try{await this.plugin.performSync(),this.plugin.debugLog("Refresh complete")}catch(n){console.error("Error refreshing decks:",n),new Je.Notice("Error refreshing decks. Check console for details.")}}async refreshStats(){this.plugin.debugLog("DecksView.refreshStats() executing");try{let n=await this.plugin.getDeckStats();this.plugin.debugLog("Updated deck stats:",n),this.component&&this.component.updateStats(n)}catch(n){console.error("Error refreshing deck stats:",n)}}async refreshStatsById(n){this.plugin.debugLog(`DecksView.refreshStatsById() executing for deck: ${n}`);try{let s=await this.plugin.getDeckStatsById(n);this.plugin.debugLog("Updated all deck stats"),this.component&&s&&this.component.updateStatsById(n,s)}catch(s){console.error(`Error refreshing stats for deck ${n}:`,s)}}startBackgroundRefresh(){this.plugin.settings.ui.enableBackgroundRefresh&&(this.stopBackgroundRefresh(),this.plugin.debugLog(`Starting background refresh job (every ${this.plugin.settings.ui.backgroundRefreshInterval} seconds)`),this.backgroundRefreshInterval=setInterval(async()=>{this.plugin.debugLog("Background refresh tick"),this.refresh()},this.plugin.settings.ui.backgroundRefreshInterval*1e3))}stopBackgroundRefresh(){this.backgroundRefreshInterval&&(this.plugin.debugLog("Stopping background refresh job"),clearInterval(this.backgroundRefreshInterval),this.backgroundRefreshInterval=null)}restartBackgroundRefresh(){this.stopBackgroundRefresh(),this.plugin.settings.ui.enableBackgroundRefresh&&this.startBackgroundRefresh()}async refreshHeatmap(){this.component&&await this.component.refreshHeatmap()}checkBackgroundJobStatus(){return this.plugin.debugLog("Background job status:",{isRunning:!!this.backgroundRefreshInterval,intervalId:this.backgroundRefreshInterval,componentExists:!!this.component,refreshInterval:this.plugin.settings.ui.backgroundRefreshInterval}),!!this.backgroundRefreshInterval}async startReview(n){try{console.log(`Syncing cards for deck before review: ${n.name}`),await this.plugin.syncFlashcardsForDeck(n.name);let s=await this.plugin.getDailyReviewCounts(n.id),o=n.config,a=o.enableNewCardsLimit?Math.max(0,o.newCardsLimit-s.newCount):"unlimited",u=o.enableReviewCardsLimit?Math.max(0,o.reviewCardsLimit-s.reviewCount):"unlimited",g=await this.plugin.getReviewableFlashcards(n.id);if(g.length===0){let v=`No cards due for review in ${n.name}`,m=o.enableNewCardsLimit&&a===0,x=o.enableReviewCardsLimit&&u===0;m&&x?(v+=`

Daily limits reached:`,v+=`
New cards: ${o.newCardsLimit}/${o.newCardsLimit}`,v+=`
Review cards: ${o.reviewCardsLimit}/${o.reviewCardsLimit}`):m?v+=`

Daily new cards limit reached: ${o.newCardsLimit}/${o.newCardsLimit}`:x&&(v+=`

Daily review cards limit reached: ${o.reviewCardsLimit}/${o.reviewCardsLimit}`),new Je.Notice(v);return}if(o.enableNewCardsLimit||o.enableReviewCardsLimit){let v=`Daily progress for ${n.name}:
`;o.enableNewCardsLimit&&(s.newCount>=o.newCardsLimit?v+=`New cards: ${s.newCount}/${o.newCardsLimit} (LIMIT EXCEEDED)
`:v+=`New cards: ${s.newCount}/${o.newCardsLimit} (${a} remaining)
`),o.enableReviewCardsLimit&&(s.reviewCount>=o.reviewCardsLimit?v+=`Review cards: ${s.reviewCount}/${o.reviewCardsLimit} (LIMIT EXCEEDED)`:v+=`Review cards: ${s.reviewCount}/${o.reviewCardsLimit} (${u} remaining)`);let m=o.enableNewCardsLimit&&s.newCount>=o.newCardsLimit,x=o.enableReviewCardsLimit&&s.reviewCount>=o.reviewCardsLimit;(m||x)&&(v+=`

Note: Only learning cards will be shown (limits exceeded)`),new Je.Notice(v,5e3)}new hs(this.app,this.plugin,n,g).open()}catch(s){console.error("Error starting review:",s),new Je.Notice("Error starting review. Check console for details.")}}};h(Us,"DecksView");var js=Us;
